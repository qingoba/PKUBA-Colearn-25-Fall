---
timezone: UTC+8
---

> è¯·åœ¨ä¸Šè¾¹çš„ timezone æ·»åŠ ä½ çš„å½“åœ°æ—¶åŒº(UTC)ï¼Œè¿™ä¼šæœ‰åŠ©äºä½ çš„æ‰“å¡çŠ¶æ€çš„è‡ªåŠ¨åŒ–æ›´æ–°ï¼Œå¦‚æœæ²¡æœ‰æ·»åŠ ï¼Œé»˜è®¤ä¸ºåŒ—äº¬æ—¶é—´ UTC+8 æ—¶åŒº

[toc]

# LuBryant

1. è‡ªæˆ‘ä»‹ç»ï¼šHello~æˆ‘å«å¢åšæ–‡ï¼Œæ˜¯åŒ—å¤§ç‰©é™¢25çº§çš„åšå£«ï¼Œç°åœ¨åˆšåˆšå¼€å§‹æ¥è§¦åŒºå—é“¾ï¼Œå¸Œæœ›å¯ä»¥å¤šå¤šå­¦ä¹ åˆ°ç›¸å…³çš„çŸ¥è¯†ã€‚
2. ä½ è®¤ä¸ºä½ ä¼šå®Œæˆè¿™æ¬¡å…±å­¦å°ç»„å—ï¼Ÿå½“ç„¶ä¼šçš„ï¼
3. ä½ æ„Ÿå…´è¶£çš„å°ç»„ï¼šOnchain-data
4. ä½ çš„å¾®ä¿¡å·ï¼š18970447065
5. è´¨æŠ¼çš„äº¤æ˜“å“ˆå¸Œï¼š0xd9945efa0e52226f47de8b8937f34521fae5319271fdf004ab78a385f43847d9

## Notes

<!-- Content_START -->

### 2025.12.07
#### å­¦ä¹ è®¡åˆ’å’Œèµ„æ–™
åˆšåˆšå­¦å¯ä»¥çœ‹ä¸€äº›å…¥é—¨è§†é¢‘ï¼š
- [WEB3æ–°äººå…¬å¼€è¯¾â€”â€”PKU BLOCKCHAIN DAO - PKUå­¦ç”ŸåŒºå—é“¾ä¸­å¿ƒ](https://space.bilibili.com/586660955/lists/894352?type=season)
- [WEB3è¿›é˜¶å…¬å¼€è¯¾â€”â€”PKU BLOCKCHAIN DAO - PKUå­¦ç”ŸåŒºå—é“¾ä¸­å¿ƒ](https://space.bilibili.com/586660955/lists/4309697?type=season)
- [ä»0åˆ°1åˆ°âˆï¼š14è®²å­¦æ‡‚åŒºå—é“¾ - BTCUé«˜æ ¡åŒºå—é“¾ç¤¾åŒº](https://space.bilibili.com/477534964/lists/864223?type=series)
- [åŒºå—é“¾/web3/åŠ å¯†è´§å¸](https://space.bilibili.com/1122798707/lists/5206919?type=season)
- [CS 251: Blockchain Technologies - Stanford University 2025](https://cs251.stanford.edu/) Only videos in 2019 are avilable.
- https://www.youtube.com/watch?v=Ud3r6GV8_Jw
- https://online.stanford.edu/courses/cs251-cryptocurrencies-and-blockchain-technologies
- https://gocanvas.stanford.edu/news/making-it-easier-students-shop-course-if-they-cant-come-class
- [Bitcoin and Cryptocurrency Technologies - Princeton 2015](https://www.coursera.org/learn/cryptocurrency/course-inbox)
- [Berkeley RDI - The Berkeley Center for Responsible, Decentralized Intelligence](https://rdi.berkeley.edu/)
- [Decentralized Finance - Berkeley RDI](https://rdi.berkeley.edu/berkeley-defi/f25)

#### Github ä¸Šå¤åˆ¶æ–‡ä»¶
æ–¹æ³•ä¸€ï¼šä½¿ç”¨ GitHub Web Editorï¼ˆæœ€æ¨èï¼Œå¿«æ·é”® .ï¼‰
è¿™æ˜¯æœ€æ¥è¿‘æœ¬åœ°æ“ä½œä½“éªŒçš„æ–¹æ³•ã€‚GitHub å†…ç½®äº†ä¸€ä¸ªåŸºäº VS Code çš„ç½‘é¡µç¼–è¾‘å™¨ã€‚

1. æ‰“å¼€ä½ çš„ GitHub ä»“åº“ä¸»é¡µã€‚
2. åœ¨é”®ç›˜ä¸Šç›´æ¥æŒ‰ä¸‹ è‹±æ–‡å¥å·é”® .ï¼ˆæˆ–è€…å°†æµè§ˆå™¨åœ°å€æ ä¸­çš„ github.com æ”¹ä¸º github.devï¼‰ã€‚
3. è¿™ä¼šæ‰“å¼€ä¸€ä¸ªç½‘é¡µç‰ˆçš„ VS Code ç¼–è¾‘å™¨ã€‚
4. åœ¨å·¦ä¾§æ–‡ä»¶æ ‘ä¸­ï¼Œå³é”®ç‚¹å‡»ä½ è¦å¤åˆ¶çš„æ–‡ä»¶ -> Copyã€‚
5. å³é”®ç‚¹å‡»ç›®æ ‡æ–‡ä»¶å¤¹ -> Pasteã€‚
6. ç‚¹å‡»å·¦ä¾§çš„â€œæºä»£ç ç®¡ç†â€å›¾æ ‡ï¼ˆGit å›¾æ ‡ï¼‰ï¼Œè¾“å…¥ Commit ä¿¡æ¯å¹¶æäº¤æ›´æ”¹ã€‚

æ–¹æ³•äºŒï¼šæ‰‹åŠ¨â€œå¤åˆ¶å†…å®¹ + æ–°å»ºæ–‡ä»¶â€ï¼ˆé€‚åˆå•ä¸ªå°æ–‡ä»¶ï¼‰
å¦‚æœä½ ä¸æƒ³è¿›å…¥ç¼–è¾‘å™¨æ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„ç¬¨åŠæ³•ï¼š

1. æ‰“å¼€ä½ æƒ³å¤åˆ¶çš„æ–‡ä»¶ã€‚
2. ç‚¹å‡»å³ä¸Šè§’çš„ Copy raw contents å›¾æ ‡ï¼ˆä¸¤ä¸ªé‡å çš„å°æ–¹å—ï¼‰æˆ–è€…ç‚¹å‡» Raw æŒ‰é’®ç„¶åå…¨é€‰å¤åˆ¶ã€‚
3. å›åˆ°ä»“åº“é¦–é¡µæˆ–ç›®æ ‡æ–‡ä»¶å¤¹ã€‚
4. ç‚¹å‡» Add file -> Create new fileã€‚
5. åœ¨æ–‡ä»¶åå¤„è¾“å…¥è·¯å¾„ï¼ˆä¾‹å¦‚ new_folder/filename.pyï¼‰å¹¶ç²˜è´´å†…å®¹ã€‚
6. æäº¤æ›´æ”¹ï¼ˆCommit changesï¼‰ã€‚

#### Github ä½¿ç”¨å°çŸ¥è¯†
å¦‚ä½•çŸ¥é“è‡ªå·±æœ‰ä½¿ç”¨æƒé™ï¼Ÿ
æ–¹æ³•ä¸€ï¼šæœ€ç›´è§‚çš„ UI éªŒè¯ï¼ˆçœ‹â€œSettingsâ€æ ‡ç­¾ï¼‰
è¿™æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼Œä¸éœ€è¦å†™ä»£ç ã€‚

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ ä½ æœ‹å‹çš„é‚£ä¸ªä»“åº“é¡µé¢ï¼ˆæ³¨æ„ï¼šä¸æ˜¯ä½  Fork å‡ºæ¥çš„é‚£ä¸ªï¼Œæ˜¯åŸæœ¬çš„é‚£ä¸ª URLï¼‰ã€‚
2. çœ‹é¡µé¢é¡¶éƒ¨çš„å¯¼èˆªæ ï¼ˆCode, Issues, Pull requests é‚£ä¸€è¡Œï¼‰ã€‚
3. å…³é”®ç‚¹ï¼š å¦‚æœä½ èƒ½çœ‹åˆ° Settingsï¼ˆè®¾ç½®ï¼‰ è¿™ä¸€é¡¹ï¼Œè¯´æ˜ä½ å·²ç»æ˜¯åä½œè€…äº†ï¼Œæ‹¥æœ‰å†™æƒé™ã€‚æ™®é€šè·¯äººæ˜¯çœ‹ä¸åˆ°åˆ«äººä»“åº“çš„ Settings é€‰é¡¹çš„ã€‚

æ–¹æ³•ä¸‰ï¼šç¡¬æ ¸å‘½ä»¤è¡ŒéªŒè¯ï¼ˆDry Runï¼‰
å¦‚æœä½ å·²ç»æŠŠä»£ç  clone åˆ°æœ¬åœ°äº†ï¼Œå¯ä»¥ç”¨ Git å‘½ä»¤æ¥æµ‹è¯•ã€‚

æ³¨æ„ï¼š å› ä¸ºä½ ä¹‹å‰æ˜¯ Fork çš„ï¼Œæ‰€ä»¥ä½ æœ¬åœ°é»˜è®¤çš„ origin åº”è¯¥æ˜¯æŒ‡å‘ ä½ è‡ªå·±çš„ä»“åº“ã€‚ä½ éœ€è¦å…ˆç¡®è®¤ä½ æœ‰æ²¡æœ‰æŠŠä½ æœ‹å‹çš„ä»“åº“æ·»åŠ ä¸ºè¿œç¨‹ä»“åº“ï¼ˆé€šå¸¸å‘½åä¸º upstreamï¼Œä¹Ÿå¯ä»¥å–åˆ«çš„åå­—ï¼‰ã€‚

è¯·åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

æ·»åŠ æœ‹å‹çš„ä»“åº“ä½œä¸ºè¿œç¨‹åœ°å€ï¼ˆå¦‚æœä½ è¿˜æ²¡åŠ çš„è¯ï¼‰ï¼š

```Bash
# å‡è®¾ä½ æœ‹å‹çš„ä»“åº“åœ°å€æ˜¯ https://github.com/friend/project.git
git remote add upstream https://github.com/friend/project.git
```
æµ‹è¯•æ¨é€æƒé™ï¼ˆä¼ªæ¨é€ï¼‰ï¼š ä½¿ç”¨ --dry-run å‚æ•°ï¼Œè¿™ä¼šæ¨¡æ‹Ÿæ¨é€è¿‡ç¨‹ä½†ä¸ä¼šçœŸçš„æŠŠä»£ç ä¼ ä¸Šå»ï¼Œä¸“é—¨ç”¨æ¥æµ‹è¯•è¿æ¥å’Œæƒé™ã€‚
```Bash
git push upstream main --dry-run
```
å¦‚æœæˆåŠŸï¼š ä¼šæ˜¾ç¤º Everything up-to-date æˆ–è€…æ¨¡æ‹Ÿå†™å…¥çš„ä¿¡æ¯ã€‚è¯´æ˜ä½ æœ‰æƒé™ï¼

å¦‚æœå¤±è´¥ï¼š ä¼šæ˜¾ç¤º 403 Forbidden æˆ–è€… Permission deniedã€‚

---
Fork äº†é¡¹ç›®åªæ˜¯è‡ªå·±æœ‰äº†ä¸€ä»½ï¼Œå¹¶ä¸ä¼šä¿®æ”¹åŸæœ‰ä»“åº“ã€‚

æ—¢ç„¶ä½ å·²ç»åœ¨è‡ªå·±çš„ Fork é‡Œæäº¤äº†ä»£ç ï¼Œç°åœ¨è¦æŠŠè¿™ä¸ªæ”¹åŠ¨â€œå‘é€â€ç»™ä½ çš„æœ‹å‹ã€‚å› ä¸ºä½ æ˜¯åœ¨ç½‘é¡µç«¯æ“ä½œï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ æ Pull Request (PR)ã€‚

è™½ç„¶ä½ æœ‰å†™æƒé™ï¼Œä½† **è·¨ä»“åº“ï¼ˆä»ä½ çš„ Fork åˆ°ä»–çš„ Upstreamï¼‰** ä¼ è¾“ä»£ç ï¼Œåœ¨ç½‘é¡µä¸Šåªèƒ½é€šè¿‡ PRã€‚

æ“ä½œæ­¥éª¤ï¼š

1. æ‰“å¼€ ä½ è‡ªå·± çš„é‚£ä¸ªä»“åº“é¡µé¢ï¼ˆä½ èƒ½çœ‹åˆ° Commit çš„é‚£ä¸ªé¡µé¢ï¼‰ã€‚
2. ç‚¹å‡»é¡µé¢ä¸Šæ–¹çš„ Pull requests æ ‡ç­¾ã€‚
3. ç‚¹å‡»ç»¿è‰²çš„ New pull request æŒ‰é’®ã€‚
4. å…³é”®æ£€æŸ¥ï¼š
    - å·¦è¾¹ï¼ˆBase repositoryï¼‰ï¼šåº”è¯¥æ˜¯ ä½ æœ‹å‹çš„ä»“åº“ (main åˆ†æ”¯)ã€‚
    - å³è¾¹ï¼ˆHead repositoryï¼‰ï¼šåº”è¯¥æ˜¯ ä½ çš„ä»“åº“ (main åˆ†æ”¯)ã€‚
5. ä½ ä¼šçœ‹åˆ°ä¸¤ä¸ªä»“åº“çš„å·®å¼‚ï¼ˆä¹Ÿå°±æ˜¯ä½ åˆšæ‰ä¿®æ”¹çš„å†…å®¹ï¼‰ã€‚
6. ç‚¹å‡» Create pull requestã€‚

é‡ç‚¹æ¥äº†ï¼š å› ä¸ºä½ æœ‰ å†™æƒé™ï¼Œå½“ä½ åˆ›å»ºå®Œ PR åï¼Œä½ ä¼šå‘ç° Merge æŒ‰é’®æ˜¯ç»¿è‰²çš„ï¼ˆæˆ–è€…ä½ å¯ä»¥ç›´æ¥å»ä»–çš„ä»“åº“é‡Œç‚¹ Mergeï¼‰ã€‚ä½ è‡ªå·±å°±å¯ä»¥æ‰¹å‡†å¹¶åˆå¹¶è¿™ä¸ª PRï¼Œä¸éœ€è¦ç­‰ä»–æ“ä½œã€‚åˆå¹¶åï¼Œä»–çš„ä»“åº“å°±æœ‰äº†ä½ çš„æ›´æ–°ã€‚

**ä¸‹æ¬¡å¦‚ä½•ç›´æ¥åˆ©ç”¨â€œæƒé™â€ä¿®æ”¹ï¼Ÿï¼ˆä¸èµ°å¼¯è·¯ï¼‰**
å¦‚æœä½ æƒ³åˆ©ç”¨ä»–å¯¹ä½ å¼€æ”¾çš„æƒé™ï¼Œè·³è¿‡ Fork å’Œ PR çš„æ­¥éª¤ï¼Œç›´æ¥ä¿®æ”¹ä»–çš„é¡¹ç›®ï¼Œä½ éœ€è¦æ”¹å˜æ“ä½œä¹ æƒ¯ï¼š

åœºæ™¯ Aï¼šå¦‚æœä½ åšæŒåœ¨ç½‘é¡µä¸Šæ”¹
ä¸è¦å»ä½ è‡ªå·±çš„ä»“åº“ï¼

1. ç›´æ¥åœ¨æµè§ˆå™¨æ‰“å¼€ ä½ æœ‹å‹çš„ä»“åº“ URLã€‚
2. æ‰¾åˆ°é‚£ä¸ªæ–‡ä»¶ã€‚
3. ç‚¹å‡»å³ä¸Šè§’çš„ç¬”å½¢å›¾æ ‡ï¼ˆEditï¼‰ã€‚
4. ä¿®æ”¹å®Œç›´æ¥ Commitã€‚
    - æ³¨æ„ï¼šå¦‚æœä½ çš„æƒé™æ²¡é—®é¢˜ï¼Œå®ƒä¼šå…è®¸ä½ ç›´æ¥ Commit to main branchã€‚å¦‚æœåªèƒ½ Create a new branchï¼Œè¯´æ˜ä¸»åˆ†æ”¯è¢«ä¿æŠ¤äº†ï¼Œè¿˜æ˜¯å¾—èµ° PRã€‚

åœºæ™¯ Bï¼šå¦‚æœä½ åœ¨æœ¬åœ°ç”µè„‘ï¼ˆæ¨èï¼Œæ›´æœ‰é«˜æ‰‹é£èŒƒï¼‰
ä½ éœ€è¦å‘Šè¯‰ä½ çš„æœ¬åœ° Gitï¼Œè¦æŠŠä»£ç æ¨é€åˆ°å“ªé‡Œã€‚

1. åœ¨æœ¬åœ°ç»ˆç«¯ï¼ŒæŠŠ ä½ æœ‹å‹çš„ä»“åº“ æ·»åŠ ä¸ºä¸€ä¸ªæ–°çš„è¿œç¨‹åœ°å€ï¼ˆé€šå¸¸å« upstreamï¼‰
```Bash
git remote add upstream https://github.com/æœ‹å‹ID/é¡¹ç›®å.git
```
ä¸‹æ¬¡ä¿®æ”¹å®Œä»£ç ï¼Œç›´æ¥æ¨é€åˆ°ä»–çš„ä»“åº“ï¼š

```Bash
git push upstream main
```

#### Week1 Part I - åŠ¨æ‰‹éƒ¨ç½²ä¸€ä¸ªæ™ºèƒ½åˆçº¦
PKUBlockchain 25 Fall Get Ready Quest: https://github.com/aliceyzhsu/crypto-techguy/blob/main/quests/get-ready.md

ğŸŒŸ æ‰‹æŠŠæ‰‹å¸¦ä½ éƒ¨ç½²ç¬¬ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼ğŸš€

æ— è®ºä½ æ˜¯åˆšåˆšå…¥é—¨ï¼Œè¿˜æ˜¯å·²ç»å¯¹é“¾ä¸Šäº¤æ˜“æœ‰æ‰€äº†è§£ï¼Œè¿™æ¬¡æ•™ç¨‹éƒ½å°†å¸¦ä½ å®Œæ•´èµ°ä¸€éåœ¨ Ethereum Sepolia æµ‹è¯•ç½‘éƒ¨ç½²æ™ºèƒ½åˆçº¦çš„å…¨è¿‡ç¨‹ã€‚åˆ«æ‹…å¿ƒï¼Œå‚è€ƒæˆ‘ä»¬ 5 åˆ†é’Ÿçš„è§†é¢‘æ•™ç¨‹, å…¨è¿‡ç¨‹è®°å½• https://drive.google.com/file/d/1KR5z9tDojekU1tELceUtHj3HwMlQxFRb/view?usp=drive_link

ğŸ¯ ç›®æ ‡ï¼šåœ¨ Ethereum Sepolia æµ‹è¯•ç½‘ä¸Šéƒ¨ç½²ä¸€ä¸ªå±äºä½ è‡ªå·±çš„æ™ºèƒ½åˆçº¦ï¼Œå¹¶ä¸è¯¥åˆçº¦äº¤äº’ã€‚


ğŸ“Œ å‡†å¤‡å·¥ä½œï¼š
1ï¸âƒ£ å®‰è£…å¹¶é…ç½®å¥½ MetaMask é’±åŒ…

2ï¸âƒ£ é¢†å– Sepolia æµ‹è¯•ç½‘ ETH æµ‹è¯•å¸ï¼šhttps://cloud.google.com/application/web3/faucet/ethereum/sepolia å¯ä»¥è¾“å…¥ ETH çš„ address

3ï¸âƒ£ å‡†å¤‡å¥½ä½ è¦éƒ¨ç½²çš„åˆçº¦ä»£ç , å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„ä¾‹å­:

```solidity
// SPDX-License-Identifier: MIT
// æŒ‡å®šç¼–è¯‘å™¨ç‰ˆæœ¬è¦æ±‚ï¼Œ0.8.0 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œä½†ä½äº 0.9.0
pragma solidity ^0.8.0;

// å®šä¹‰ä¸€ä¸ªåä¸º HelloWeb3 çš„åˆçº¦
contract HelloWeb3 {

    /* å®šä¹‰ä¸€ä¸ªäº‹ä»¶ Greetingï¼Œå½“è°ƒç”¨ hello å‡½æ•°æ—¶è§¦å‘ï¼Œç”¨æ¥åœ¨é“¾ä¸Šæ—¥å¿—ä¸­è®°å½•â€œGreetingâ€å‘ç”Ÿæ—¶çš„å‘é€è€…åœ°å€å’Œæ—¶é—´æˆ³ã€‚
    indexed è®© sender å˜æˆå¯æ£€ç´¢å­—æ®µï¼Œå‰ç«¯/åç«¯å¯ä»¥æŒ‰åœ°å€è¿‡æ»¤æ—¥å¿—ã€‚è¿™ä¸ª event å¯ä»¥åœ¨åŒºå—é“¾æµè§ˆå™¨ä¸­çœ‹åˆ°ã€‚
    unit256æ˜¯ Solidity é‡Œçš„æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼ˆunsigned integerï¼‰ã€‚
    uint = unsigned integerï¼ˆåªèƒ½æ˜¯ 0 æˆ–æ­£æ•°ï¼Œä¸èƒ½æ˜¯è´Ÿæ•°ï¼‰
    256 = ä½æ•°ï¼Œè¡¨ç¤ºå®ƒå  256 bits = 32 bytes
    å–å€¼èŒƒå›´æ˜¯ï¼š0 åˆ° 2^256 - 1
    */
    event Greeting(address indexed sender, uint256 timestamp);
    
    // åˆçº¦çš„æ„é€ å‡½æ•°ï¼Œåœ¨åˆçº¦éƒ¨ç½²æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™é‡Œä¸åšä»»ä½•æ“ä½œ
    constructor() {}

    // å®šä¹‰ä¸€ä¸ªå¤–éƒ¨å¯è°ƒç”¨çš„å‡½æ•° hello
    function hello() external {
        /* 
        å½“æœ‰äººè°ƒç”¨ hello() æ—¶ï¼Œå‘å‡º Greeting äº‹ä»¶ï¼Œå†…å®¹åŒ…æ‹¬ï¼š
        msg.senderï¼šè°ƒç”¨è€…åœ°å€ã€‚
        block.timestampï¼šå½“å‰åŒºå—æ—¶é—´æˆ³ï¼ˆç”±å‡ºå—è€…æä¾›ï¼Œé€šå¸¸æ¥è¿‘å½“å‰æ—¶é—´ï¼Œä½†å¯èƒ½æœ‰å°åå·®ï¼‰ã€‚
        */
        emit Greeting(msg.sender, block.timestamp);
    }
}
```


ğŸ”„ æ“ä½œæµç¨‹è¯¦è§£ï¼š

1. æ‰“å¼€ Remix IDEï¼š[https://remix.ethereum.org](https://remix.ethereum.org/)
2. æ–°å»º HelloWeb3.sol æ–‡ä»¶ï¼Œç²˜è´´ä¸Šè¿°ä»£ç 
3. è¿›å…¥ Solidity Compiler æ ‡ç­¾é¡µï¼Œç‚¹å‡»â€œCompileâ€
4. è¿›å…¥ Deploy & Run Transactions æ ‡ç­¾é¡µ
5. ç¡®è®¤ MetaMask å·²åˆ‡æ¢è‡³ Sepolia ç½‘ç»œï¼ˆåœ¨ä»£å¸ä¸‹æ–¹å¯ä»¥åˆ‡æ¢ç½‘ç»œ
6. ç¯å¢ƒé€‰æ‹© â€œInjected Provider - MetaMaskâ€ ï¼ˆInjected Provider è¡¨ç¤º Metamask æ˜¯å“ªæ¡é“¾ï¼Œå°±æ˜¯å“ªä¸ªï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€‰ç”¨ Sepolia Testnet - MetaMaskï¼‰
7. å³ä¸Šè§’çš„ç½‘ç»œï¼Œç¡®ä¿è¿æ¥åˆ°äº† remix
8. Estimated Gas å¯ä»¥è‡ªå·±é€‰ï¼ˆä¼°ç®—çš„æ˜¯è¿™ç¬”â€œéƒ¨ç½²äº¤æ˜“â€å¤§æ¦‚ä¼šç”¨æ‰å¤šå°‘ gasï¼Œç„¶åæŠŠè¿™ä¸ªæ•°ï¼ˆé€šå¸¸ä¼šå†åŠ ä¸€ç‚¹ä½™é‡ï¼‰ä½œä¸º gasLimit å¡«è¿›äº¤æ˜“é‡Œã€‚å®ƒä¸æ˜¯ä»·æ ¼ï¼Œåé¢åœ¨ Metamask ä¸Šä¼šæ˜¾ç¤º é¢„ä¼°æ‰‹ç»­è´¹
9. Verify Contract on Explorers å¯ä»¥å‹¾ä¸Š
10. ç‚¹å‡» Deployï¼Œåœ¨ MetaMask ä¸­ç¡®è®¤äº¤æ˜“
11. ç­‰å¾…éƒ¨ç½²æˆåŠŸï¼Œåœ¨ Remix æ§åˆ¶å°å¤åˆ¶åˆçº¦åœ°å€å’Œäº¤æ˜“å“ˆå¸Œ
12. Remix ä¸­ï¼Œéƒ¨ç½²çš„åˆçº¦ä¼šå‡ºç°åœ¨å·¦ä¸‹è§’ Deployed Contracts åŒºåŸŸï¼Œè®°å½•çš„äº¤æ˜“ä¼šåœ¨ Transactions recorded åŒºåŸŸæ˜¾ç¤º
13. å±•å¼€ Deployed Contractsï¼Œä¼šçœ‹åˆ°éƒ¨ç½²çš„åˆçº¦ï¼Œåé¢è·Ÿç€ contract address åˆçº¦åœ°å€ã€‚
14. åœ¨å·²ç»éƒ¨ç½²çš„åˆçº¦ä¸­è°ƒç”¨ hello å‡½æ•°ï¼Œç‚¹å‡» hello æŒ‰é’®å³å¯ï¼Œå› ä¸º hello å‡½æ•°æ˜¯æ²¡æœ‰å‚æ•°çš„ã€‚
15. ç­¾ååï¼Œäº¤æ˜“æˆåŠŸï¼Œå¤åˆ¶äº¤æ˜“çš„ contract address
16. æ‰“å¼€[sepolia çš„åŒºå—é“¾æµè§ˆå™¨](https://sepolia.etherscan.io/)ï¼Œæœç´¢éƒ¨ç½²çš„åˆçº¦åœ°å€ï¼ŒæŸ¥çœ‹ Transactions å’Œ Events ç»“æœã€‚ï¼ˆEtherscan å°±æ˜¯ä»¥å¤ªåŠçš„"å…¬å¼€è´¦æœ¬æŸ¥è¯¢ç½‘ç«™"ï¼Œæ‰€æœ‰é“¾ä¸Šäº¤æ˜“ã€åˆçº¦ã€åœ°å€ä¿¡æ¯éƒ½èƒ½åœ¨ä¸Šé¢æŸ¥åˆ°ã€‚ä¸ºä»€ä¹ˆå«"æµè§ˆå™¨"ï¼Ÿå› ä¸ºåŒºå—é“¾ä¸Šæ‰€æœ‰æ•°æ®éƒ½æ˜¯å…¬å¼€çš„ï¼ŒEtherscan å°±åƒä¸€ä¸ª"æœç´¢å¼•æ“ + å±•ç¤ºç•Œé¢"ï¼Œè®©ä½ èƒ½æ–¹ä¾¿åœ°æµè§ˆè¿™äº›é“¾ä¸Šæ•°æ®ï¼Œè€Œä¸ç”¨è‡ªå·±è·‘èŠ‚ç‚¹ã€å†™ä»£ç å»æŸ¥ã€‚ï¼‰

ä¸‹é¢è¿›è¡Œå®é™…æ“ä½œï¼š
ç¼–è¯‘å®Œæˆï¼š

<p align="center">
    <img alt="image" src="https://github.com/user-attachments/assets/39b984f7-8165-41cb-9da9-beec42c12f2a" />
</p>

ç¼–è¯‘å®Œæˆåéƒ¨ç½²ã€‚åˆçº¦éœ€è¦ä¸€ä¸ª Ownerï¼Œè¦è¿›è¡Œç­¾å

<img width="389" height="615" alt="image" src="https://github.com/user-attachments/assets/f0876244-e0b9-4b93-bc8f-a5d062b58664" />

éƒ¨ç½²æˆåŠŸ
<img width="971" height="647" alt="image" src="https://github.com/user-attachments/assets/d788eacb-de73-494b-9e57-af5cfe6c22f0" />
```Bash
[block:9857972 txIndex:12]from: 0x5b9...dbA5Ato: HelloWeb3.(constructor)value: 0 weidata: 0x608...f0033logs: 0hash: 0x49d...51645
status	1 Transaction mined and execution succeed
transaction hash	0xb8cf5bb873c9e245c87c14b170084e6f3ec4879fbb99ab79481f6dd7230083de
block hash	0x49d764af04b14e744c024d8bec7a47adf4af5198733652bf65b0fe9a9ca51645
block number	9857972
contract address	0xF431B5677C341B7CE90C1ae9AD41E90de491125E
from	0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
to	HelloWeb3.(constructor)
transaction cost	102529 gas 
decoded input	{}
decoded output	 - 
logs	[]
raw logs	[]
```

æˆåŠŸéƒ¨ç½²ä¹‹åï¼Œå°±å¯ä»¥è°ƒç”¨ hello å‡½æ•°ï¼Œè°ƒç”¨åéœ€è¦ç­¾å

<p align="center">
    <img alt="image" src="md_assets/LuBryant/image.png" />
</p>

äº¤æ˜“æˆåŠŸ
```Bash
[block:9858274 txIndex:16]from: 0x5b9...dbA5Ato: HelloWeb3.hello() 0xF43...1125Evalue: 0 weidata: 0x19f...f1d21logs: 1hash: 0x696...b4c86
status	1 Transaction mined and execution succeed
transaction hash	0xe068c7ffd29a6d0dc2f104c53c6f581229bb0863f19463024af41efd2bb90575
block hash	0x696ef3145e54589f1b927a875fc7f0b083de06ec4e965784bc7d536f3f6b4c86
block number	9858274
from	0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
to	HelloWeb3.hello() 0xF431B5677C341B7CE90C1ae9AD41E90de491125E
transaction cost	22755 gas 
decoded input	{}
decoded output	 - 
logs	[
	{
		"from": "0xF431B5677C341B7CE90C1ae9AD41E90de491125E",
		"topic": "0xd3c5e74ab50b58334f02e7b17dde164cce30984a5d60289c73a1c72e44898518",
		"event": "Greeting",
		"args": {
			"0": "0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A",
			"1": "1765955232"
		}
	}
]
raw logs	[
  {
    "_type": "log",
    "address": "0xF431B5677C341B7CE90C1ae9AD41E90de491125E",
    "blockHash": "0x696ef3145e54589f1b927a875fc7f0b083de06ec4e965784bc7d536f3f6b4c86",
    "blockNumber": 9858274,
    "data": "0x00000000000000000000000000000000000000000000000000000000694256a0",
    "index": 35,
    "topics": [
      "0xd3c5e74ab50b58334f02e7b17dde164cce30984a5d60289c73a1c72e44898518",
      "0x0000000000000000000000005b9e8d003c1d96d258e22b47cd00b8ac673dba5a"
    ],
    "transactionHash": "0xe068c7ffd29a6d0dc2f104c53c6f581229bb0863f19463024af41efd2bb90575",
    "transactionIndex": 16
  }
]
```

æ‰¾åˆ°åˆçº¦åœ°å€ï¼ˆContract addressï¼‰ï¼Œæ‰“å¼€åŒºå—é“¾æµè§ˆå™¨ï¼šhttps://sepolia.etherscan.io/ï¼Œè¾“å…¥ Contract address

éƒ¨ç½²æˆåŠŸï¼ŒEvents ä¸­æ˜¾ç¤º Greeting
<p align="center">
    <img alt="image" src="https://github.com/user-attachments/assets/d9d361ec-11f1-46e7-b5e6-f8937a5cc975" />
</p>

ç°åœ¨ä»»ä½•äººéƒ½å¯ä»¥å’Œè¿™ä¸ª Contract address äº¤äº’ã€‚

---

### 2025.12.12

#### Week 1 Part II - æ™ºèƒ½åˆçº¦ç¼–å†™
##### ç›®æ ‡

é€šè¿‡ç¼–å†™æ™ºèƒ½åˆçº¦ä¸é¶å­åˆçº¦äº¤äº’ï¼Œè·å– Flag å¹¶è§¦å‘ `ChallengeCompleted` äº‹ä»¶ã€‚

##### é¶å­åˆçº¦ä¿¡æ¯

åˆçº¦åœ°å€ï¼š`0x4a6C0c0dc8bD8276b65956c9978ef941C3550A1B`

æ‰€åœ¨ç½‘ç»œ: Ethereum Sepolia, https://chainlist.org/chain/11155111, æµè§ˆå™¨ https://sepolia.etherscan.io/

å¯ç”¨æ–¹æ³•

- `hint()` - è·å–è§£é¢˜æç¤º
- `query(bytes32 _hash)` - æäº¤ç­”æ¡ˆè·å– Flag, è¯¥æ–¹æ³•åªèƒ½é€šè¿‡åˆçº¦è°ƒç”¨
- `getSolvers()` - æŸ¥çœ‹æ‰€æœ‰å®Œæˆè€…åœ°å€

##### å‚è€ƒæ­¥éª¤

1. ç¼–å†™å¹¶éƒ¨ç½²ä¸€ä¸ªæ™ºèƒ½åˆçº¦æ¥è°ƒç”¨é¶å­åˆçº¦çš„ `hint()` æ–¹æ³•è·å–è§£é¢˜æç¤º
2. æ ¹æ®è§£é¢˜æç¤ºè®¡ç®—ç­”æ¡ˆ
3. è°ƒç”¨é¶å­åˆçº¦çš„ `query()` æ–¹æ³•æäº¤ç­”æ¡ˆ, è‹¥ç­”æ¡ˆæ­£ç¡®, åˆ™èƒ½å¤Ÿçœ‹åˆ°è¿”å›çš„ Flag æˆ–è€… ChallengeCompleted äº‹ä»¶

##### æ³¨æ„äº‹é¡¹

- é¶å­åˆçº¦è¦æ±‚è°ƒç”¨è€…å¿…é¡»æ˜¯åˆçº¦åœ°å€ï¼Œä¸èƒ½ç›´æ¥ç”¨é’±åŒ…è°ƒç”¨
- å¯ä»¥å¤šæ¬¡å°è¯•ï¼Œæ¯æ¬¡æˆåŠŸéƒ½ä¼šè§¦å‘äº‹ä»¶
- ä¸åˆçº¦äº¤äº’éœ€è¦æ¶ˆè€— Gas Fee, å¯ä»¥å‚è€ƒç¬”è¯•æ–‡æ¡£æ¥è·å–æµ‹è¯•ç½‘ä»£å¸ https://github.com/aliceyzhsu/crypto-techguy/blob/main/quests/get-ready.md

##### å‚è€ƒèµ„æ–™

- [Solidity å®˜æ–¹æ–‡æ¡£](https://docs.soliditylang.org/), [WTF ä¸­æ–‡ Solidity æ•™ç¨‹](https://www.wtf.academy/zh/course/solidity101)
- [Foundry æ•™ç¨‹](https://book.getfoundry.sh/), Foundry æ˜¯ä¸€ä¸ªå·¥å…·é›†, åŒ…å«æ™ºèƒ½åˆçº¦çš„æ„å»º/éƒ¨ç½²/è°ƒè¯•ç­‰åŠŸèƒ½
- [Remix IDE](https://remix.ethereum.org/), Remix æ˜¯ä¸€ä¸ªåœ¨çº¿ IDE, èƒ½å¤Ÿç›´æ¥åœ¨ç½‘é¡µä¸Šç¼–å†™/éƒ¨ç½²/æµ‹è¯•æ™ºèƒ½åˆçº¦, å¹¶ä¸”å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ’ä»¶çš„é’±åŒ…æ¥ç­¾å
- (æ¬¢è¿ä»»ä½•åŒå­¦è¡¥å……è‡ªå·±å­¦ä¹ æ—¶ç”¨åˆ°çš„èµ„æ–™)

**ä½¿ç”¨ä»£ç **
```solidity
// SPDX-License-Identifier: MIT
// â†‘ è¿™æ˜¯è®¸å¯è¯å£°æ˜ï¼ˆLicense Identifierï¼‰
// Solidity 0.6+ æ¨èåœ¨æ–‡ä»¶å¼€å¤´å†™è¿™ä¸ªï¼Œå‘Šè¯‰åˆ«äººè¿™ä»½ä»£ç ç”¨ä»€ä¹ˆå¼€æºåè®®ã€‚
// MIT è¡¨ç¤ºå¾ˆå®½æ¾ï¼šåˆ«äººå¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹ã€åˆ†å‘ã€‚

pragma solidity ^0.8.0;
// â†‘ pragma æ˜¯â€œç¼–è¯‘å™¨ç‰ˆæœ¬è¦æ±‚â€ã€‚
// è¿™è¡Œæ„æ€æ˜¯ï¼š
// - å¿…é¡»ä½¿ç”¨ Solidity 0.8.0 æˆ–æ›´é«˜ç‰ˆæœ¬ç¼–è¯‘
// - ä½†ä¸èƒ½è·¨åˆ° 0.9.xï¼ˆå› ä¸º ^0.8.0 çš„å«ä¹‰æ˜¯ >=0.8.0 ä¸” <0.9.0ï¼‰
// è¿™æ ·å¯ä»¥é¿å…ä½ ç”¨æ—§ç‰ˆæœ¬/ä¸å…¼å®¹ç‰ˆæœ¬å¯¼è‡´è¡Œä¸ºä¸åŒæˆ–ç¼–è¯‘å¤±è´¥ã€‚


// ==========================================================
// 1) å®šä¹‰é¶å­åˆçº¦çš„æ¥å£ Interface
// ==========================================================
//
// ä½ ç°åœ¨å†™çš„æ˜¯â€œSolver åˆçº¦â€ï¼Œå®ƒè¦å»è°ƒç”¨é“¾ä¸ŠæŸä¸ªâ€œé¶å­åˆçº¦ targetâ€ã€‚
// ä½†æ˜¯ä½ å¯èƒ½æ²¡æœ‰é¶å­åˆçº¦çš„æºä»£ç ï¼ˆCTF å¸¸è§ï¼‰ã€‚
//
// è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª Interfaceï¼ˆæ¥å£ï¼‰ï¼Œåªå£°æ˜ï¼š
// â€œæˆ‘çŸ¥é“é¶å­åˆçº¦é‡Œæœ‰è¿™äº›å‡½æ•°ï¼Œå®ƒä»¬çš„åå­—ã€å‚æ•°ã€è¿”å›å€¼é•¿ä»€ä¹ˆæ ·â€
//
// æ³¨æ„ï¼šInterface é‡Œåªæœ‰å‡½æ•°å£°æ˜ï¼Œæ²¡æœ‰å‡½æ•°å®ç°ã€‚
// Interface ä½œç”¨å°±æ˜¯ï¼šè®©ç¼–è¯‘å™¨çŸ¥é“å¦‚ä½•å’Œå¯¹æ–¹åˆçº¦â€œå¯¹æ¥â€ã€‚
interface ITarget {

    // function hint() external view returns (string memory);
    //
    // é€ä¸ªè§£é‡Šï¼š
    // - function hint()ï¼šå‡½æ•°åå« hintï¼Œæ²¡æœ‰å‚æ•°
    // - externalï¼šåªèƒ½ä»â€œå¤–éƒ¨â€è°ƒç”¨ï¼ˆæ¯”å¦‚å…¶ä»–åˆçº¦ã€ç”¨æˆ·äº¤æ˜“è°ƒç”¨ï¼‰
    //            å¤–éƒ¨åˆçº¦è°ƒç”¨æ—¶å¸¸ç”¨ externalï¼Œgas ä¸€èˆ¬æ›´çœã€‚
    // - viewï¼šè¡¨ç¤ºè¿™ä¸ªå‡½æ•°ä¸ä¼šä¿®æ”¹é“¾ä¸ŠçŠ¶æ€ï¼ˆä¸ä¼šå†™å…¥ storageï¼‰ï¼Œåªæ˜¯è¯»å–æ•°æ®
    // - returns (string memory)ï¼šè¿”å›ä¸€ä¸ª string å­—ç¬¦ä¸²ï¼Œå®ƒå­˜æ”¾åœ¨ memoryï¼ˆä¸´æ—¶å†…å­˜ï¼‰
    //   * memoryï¼šå‡½æ•°æ‰§è¡ŒæœŸé—´ä¸´æ—¶å­˜åœ¨ï¼Œæ‰§è¡Œç»“æŸå°±é‡Šæ”¾
    function hint() external view returns (string memory);

    // function query(bytes32 _hash) external;
    //
    // - queryï¼šå‡½æ•°å query
    // - å‚æ•° bytes32 _hashï¼šä¸€ä¸ª 32 å­—èŠ‚çš„æ•°æ®ï¼ˆå›ºå®šé•¿åº¦ï¼‰ï¼Œå¸¸è§ç”¨äºå“ˆå¸Œå€¼
    // - externalï¼šå¤–éƒ¨è°ƒç”¨
    // - æ²¡å†™ returnsï¼šè¯´æ˜ä¸è¿”å›ä»»ä½•å€¼
    function query(bytes32 _hash) external;
}


// ==========================================================
// 2) Solver åˆçº¦ï¼šçœŸæ­£éƒ¨ç½²å‡ºæ¥ç”¨æ¥â€œè§£é¢˜â€çš„åˆçº¦
// ==========================================================
contract Solver {

    // ------------------------------------------------------
    // é¶å­åˆçº¦åœ°å€ targetAddress
    // ------------------------------------------------------
    //
    // address æ˜¯ä»¥å¤ªåŠåœ°å€ç±»å‹ï¼ˆ20 å­—èŠ‚ï¼‰ã€‚
    // publicï¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª getter å‡½æ•°ï¼Œè®©åˆ«äººå¯ä»¥è¯»å–è¿™ä¸ªå˜é‡ã€‚
    //
    // è¿™é‡Œç›´æ¥å†™æ­»ä¸€ä¸ªåœ°å€ï¼š
    // 0x4a6C...0A1B ä»£è¡¨é“¾ä¸Šå·²ç»éƒ¨ç½²å¥½çš„é¶å­åˆçº¦ä½ç½®ã€‚
    //
    // æ³¨æ„ï¼šå¦‚æœä½ åœ¨åˆ«çš„ç½‘ç»œï¼ˆæ¯”å¦‚æ¢åˆ°å¦ä¸€ä¸ªæµ‹è¯•ç½‘ï¼‰è¿™ä¸ªåœ°å€å¯èƒ½ä¸å¯¹ã€‚
    address public targetAddress = 0x4a6C0c0dc8bD8276b65956c9978ef941C3550A1B;


    // ======================================================
    // æ­¥éª¤ Aï¼šè·å–æç¤º getHint()
    // ======================================================
    //
    // è¿™ä¸ªå‡½æ•°åªæ˜¯â€œè¾…åŠ©ç”¨â€ï¼Œæ–¹ä¾¿ä½ åœ¨ Remix ç‚¹ä¸€ä¸‹å°±èƒ½çœ‹åˆ° hint çš„å­—ç¬¦ä¸²ã€‚
    //
    // publicï¼šè°éƒ½èƒ½è°ƒç”¨ï¼ˆä½ è‡ªå·±ã€åˆ«äººã€å…¶ä»–åˆçº¦éƒ½è¡Œï¼‰
    // viewï¼šä¸æ”¹çŠ¶æ€ï¼Œåªè¯»
    // returns (string memory)ï¼šè¿”å›æç¤ºå­—ç¬¦ä¸²
    function getHint() public view returns (string memory) {

        // ITarget(targetAddress)
        // â†‘ è¿™ä¸€æ­¥å«â€œç±»å‹è½¬æ¢/æ¥å£ç»‘å®šâ€ï¼š
        //   ä½ æŠŠä¸€ä¸ª address å½“æˆ ITarget æ¥å£ç±»å‹æ¥ç”¨ï¼Œ
        //   è®©ç¼–è¯‘å™¨ç›¸ä¿¡ï¼šè¿™ä¸ªåœ°å€ä¸Šçš„åˆçº¦ï¼Œç¡®å®æœ‰ hint() å’Œ query() è¿™äº›å‡½æ•°ã€‚
        //
        // .hint()
        // â†‘ è°ƒç”¨é¶å­åˆçº¦çš„ hint() å‡½æ•°ã€‚
        //
        // æœ€ç»ˆè¿”å› hint() çš„å­—ç¬¦ä¸²ç»“æœã€‚
        return ITarget(targetAddress).hint();
    }


    // ======================================================
    // æ­¥éª¤ Bï¼šæäº¤ç­”æ¡ˆ solve(string memory solution)
    // ======================================================
    //
    // CTF é¢˜å¸¸è§é€»è¾‘æ˜¯ï¼š
    // ä½ è¦æäº¤ä¸€ä¸ªå­—ç¬¦ä¸²ç­”æ¡ˆï¼Œä½†é¶å­åˆçº¦ä¸è®©ä½ ç›´æ¥äº¤å­—ç¬¦ä¸²ï¼Œ
    // è€Œæ˜¯è¦æ±‚ä½ æäº¤ç­”æ¡ˆçš„ keccak256 å“ˆå¸Œï¼ˆbytes32ï¼‰ã€‚
    //
    // è¿™ä¸ªå‡½æ•°å°±æ˜¯ï¼šä½ ç»™æˆ‘ä¸€ä¸ª solution å­—ç¬¦ä¸²ï¼Œæˆ‘å¸®ä½ ç®— hashï¼Œç„¶åäº¤ç»™é¶å­ query().
    //
    // æ³¨æ„ï¼šè¿™ä¸ªå‡½æ•°ä¸æ˜¯ viewï¼Œå› ä¸ºå®ƒä¼šâ€œè°ƒç”¨é¶å­åˆçº¦â€ï¼Œ
    // é¶å­åˆçº¦çš„ query() å¾ˆå¯èƒ½ä¼šä¿®æ”¹çŠ¶æ€ï¼ˆæ¯”å¦‚è®°å½•ä½ æ˜¯å¦é€šè¿‡ï¼‰ã€‚
    function solve(string memory solution) public {

        // --------------------------------------------------
        // 1) æŠŠå­—ç¬¦ä¸² solution å˜æˆ bytesï¼Œç„¶ååš keccak256
        // --------------------------------------------------
        //
        // keccak256(...) ä¼šè¿”å› bytes32ï¼ˆ32 å­—èŠ‚å“ˆå¸Œå€¼ï¼‰
        //
        // abi.encodePacked(solution)
        // â†‘ æŠŠå‚æ•°ç´§å¯†æ‰“åŒ…æˆå­—èŠ‚åºåˆ—ï¼ˆbytesï¼‰
        //   - â€œPackedâ€ ä»£è¡¨ç´§å‡‘ç¼–ç ï¼Œå¸¸ç”¨äºç®—å“ˆå¸Œ
        //   - æ³¨æ„ï¼šå¦‚æœä½ ä¼ å¤šä¸ªå‚æ•°ï¼ŒencodePacked å¯èƒ½ä¼šæœ‰â€œæ‹¼æ¥æ­§ä¹‰â€
        //     ï¼ˆåˆå­¦å…ˆè®°ä½ï¼šå•ä¸ªå­—ç¬¦ä¸²ä¸€èˆ¬æ²¡é—®é¢˜ï¼‰
        //
        // æœ€ç»ˆå¾—åˆ° answerHashï¼šç­”æ¡ˆçš„å“ˆå¸Œå€¼
        bytes32 answerHash = keccak256(abi.encodePacked(solution));

        // --------------------------------------------------
        // 2) è°ƒç”¨é¶å­åˆçº¦çš„ query(answerHash)
        // --------------------------------------------------
        //
        // ITarget(targetAddress).query(answerHash)
        // è¡¨ç¤ºï¼šæŠŠ targetAddress å½“æˆ ITarget æ¥å£ï¼Œè°ƒç”¨å®ƒçš„ query å‡½æ•°ã€‚
        //
        // è¿™é‡Œä¼šå‘èµ·ä¸€æ¬¡â€œå¤–éƒ¨åˆçº¦è°ƒç”¨â€ï¼Œ
        // å¦‚æœé¶å­åˆçº¦å†…éƒ¨é€»è¾‘è¦æ±‚æ­£ç¡® hash æ‰é€šè¿‡ï¼Œé‚£å°±çœ‹ä½ ç®—å¾—å¯¹ä¸å¯¹ã€‚
        ITarget(targetAddress).query(answerHash);
    }


    // ======================================================
    // å¤‡ç”¨å‡½æ•°ï¼šsolveRaw(bytes32 _hash)
    // ======================================================
    //
    // æœ‰æ—¶å€™ä½ å¯èƒ½åœ¨é“¾ä¸‹ï¼ˆæ¯”å¦‚ç”¨ç½‘ç«™/è„šæœ¬ï¼‰å·²ç»æŠŠ hash ç®—å¥½äº†ï¼Œ
    // ç›´æ¥å¾—åˆ°ä¸€ä¸ª bytes32ã€‚
    //
    // é‚£ä½ å°±ä¸ç”¨ä¼ å­—ç¬¦ä¸²äº†ï¼Œç›´æ¥ä¼  hash æ›´çœäº‹ã€‚
    function solveRaw(bytes32 _hash) public {
        // ç›´æ¥æŠŠä½ ç»™çš„ _hash æäº¤ç»™é¶å­ query()
        ITarget(targetAddress).query(_hash);
    }
}
```
åœ¨éƒ¨ç½²çš„æ—¶å€™ï¼ŒCONTRACT è¦é€‰æ‹© Solver - Solver.sol

ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²æ”»å‡»åˆçº¦
åœ¨ Remix å·¦ä¾§ç‚¹å‡» Solidity Compiler (ä»¥åŠå›¾æ ‡)ï¼Œç‚¹å‡» Compile Solver.solã€‚

ç‚¹å‡»å·¦ä¾§ Deploy & Run Transactions (ä»¥å¤ªåŠå›¾æ ‡)ã€‚

Environment é€‰æ‹© Injected Provider - MetaMask (è¿™ä¼šè¿æ¥ä½ çš„é’±åŒ…)ã€‚

ç¡®ä¿ Contract é€‰ä¸­çš„æ˜¯ Solverã€‚

ç‚¹å‡» Deploy æŒ‰é’®ï¼Œåœ¨ MetaMask ä¸­ç¡®è®¤äº¤æ˜“ã€‚

ç­‰å¾…äº¤æ˜“æˆåŠŸï¼Œå·¦ä¸‹è§’ "Deployed Contracts" ä¼šå‡ºç°ä½ çš„åˆçº¦ã€‚

ç¬¬ä¸‰æ­¥ï¼šè·å–æç¤º (Get Hint)
å±•å¼€ä½ åˆšéƒ¨ç½²çš„åˆçº¦ã€‚

ç‚¹å‡» getHint æŒ‰é’®ã€‚

æŸ¥çœ‹è¿”å›çš„å­—ç¬¦ä¸²å†…å®¹ï¼ˆResultï¼‰ã€‚

å‡è®¾æç¤ºæ˜¯ "Hello"ï¼Œæˆ–è€…æ˜¯æŸä¸ªå…·ä½“çš„å•è¯/çŸ­è¯­ã€‚

æ³¨æ„ï¼šæœ‰æ—¶å€™æç¤ºæœ¬èº«å°±æ˜¯ä¸€ä¸ªè°œé¢˜ï¼Œä½ éœ€è¦æ ¹æ®æç¤ºç®—å‡ºçœŸæ­£çš„ç­”æ¡ˆå­—ç¬¦ä¸²ã€‚

è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„ CTFï¼ˆCapture The Flagï¼‰æ™ºèƒ½åˆçº¦æŒ‘æˆ˜ä»»åŠ¡ã€‚ä½ éœ€è¦å……å½“ä¸€åâ€œæ”»å‡»è€…â€ï¼Œç¼–å†™ä¸€ä¸ªä¸­é—´åˆçº¦å»è°ƒç”¨é¶å­åˆçº¦ã€‚

ç”±äºé¢˜ç›®æ˜ç¡®æŒ‡å‡º query() æ–¹æ³•åªèƒ½é€šè¿‡åˆçº¦è°ƒç”¨ï¼ˆé€šå¸¸æ˜¯é€šè¿‡ msg.sender != tx.origin æ¥é™åˆ¶çš„ï¼‰ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ç›´æ¥åœ¨ Etherscan ä¸Šæ“ä½œï¼Œå¿…é¡»å†™ä»£ç ã€‚

ç»“æœï¼š
```
0: string: keccak PKUBlockchain
```

è¿™å¥è¯çš„æ„æ€æ˜¯ï¼šâ€œè¯·å¯¹å­—ç¬¦ä¸² PKUBlockchain è¿›è¡Œ keccak256 å“ˆå¸Œè¿ç®—ï¼Œå¹¶å°†ç»“æœæäº¤ä¸Šæ¥ã€‚â€

keccak: æŒ‡çš„æ˜¯å“ˆå¸Œç®—æ³• keccak256 (ä»¥å¤ªåŠçš„æ ‡å‡†å“ˆå¸Œç®—æ³•)ã€‚

PKUBlockchain: æŒ‡çš„æ˜¯ä½ éœ€è¦è¿›è¡Œå“ˆå¸Œçš„åŸå§‹å†…å®¹ï¼ˆåŸæ–‡ï¼‰ã€‚

è¿›å…¥åœ¨çº¿ç½‘ç«™ï¼šhttps://emn178.github.io/online-tools/keccak_256.html

å¾—åˆ° `PKUBlockchain` çš„å“ˆå¸Œå€¼ä¸º `e2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215`

æˆåŠŸå®Œæˆä»»åŠ¡ã€‚

**æ–°çš„ä»£ç **
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

/**
 * @title Sepolia CTF Solver (Generic)
 * @notice
 *  ç›®æ ‡ï¼šé€šè¿‡â€œåˆçº¦è°ƒç”¨â€çš„æ–¹å¼ä¸é¶å­åˆçº¦äº¤äº’ï¼š
 *    1) è°ƒ hint() è¯»å–æç¤º
 *    2) æ ¹æ®æç¤ºè®¡ç®—ç­”æ¡ˆï¼ˆé€šå¸¸æ˜¯ keccak256 å“ˆå¸Œï¼‰
 *    3) è°ƒ query(bytes32) æäº¤ç­”æ¡ˆå“ˆå¸Œï¼Œè§¦å‘é¶å­åˆçº¦çš„ ChallengeCompleted äº‹ä»¶/è¿”å› Flag
 *
 *  å…³é”®ç‚¹ï¼š
 *    - é¶å­åˆçº¦ query() é™åˆ¶â€œåªèƒ½è¢«åˆçº¦è°ƒç”¨â€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä»åˆçº¦é‡Œå» call å®ƒã€‚
 *    - ç”±äºä½ æ²¡æœ‰æä¾›é¶å­åˆçº¦ ABI/æºç ï¼Œæœ¬åˆçº¦ç”¨ low-level callï¼š
 *        - hint() ç”¨ staticcallï¼ˆåªè¯»ï¼‰
 *        - query(bytes32) ç”¨ callï¼ˆå¯èƒ½æ”¹å˜é¶å­åˆçº¦çŠ¶æ€ï¼‰
 *    - è¿”å›å€¼ç±»å‹ä¸ç¡®å®šæ—¶ï¼Œå…ˆæ‹¿åˆ° raw bytesï¼Œå†é€‰æ‹© decode æˆ string / bytes32 / address[]
 */
contract SepoliaFlagSolver {
    // ======== 0. é¶å­åˆçº¦åœ°å€ï¼ˆä½ é¢˜ç›®é‡Œç»™çš„ï¼‰ ========
    address public constant TARGET =
        0x4a6C0c0dc8bD8276b65956c9978ef941C3550A1B;

    // ======== 1. è®¿é—®æ§åˆ¶ï¼šåªå…è®¸éƒ¨ç½²è€…æ“ä½œï¼ˆé¿å…åˆ«äººç›—ç”¨ä½ çš„ solverï¼‰ ========
    address public immutable owner;

    modifier onlyOwner() {
        require(msg.sender == owner, "Only owner");
        _;
    }

    constructor() {
        owner = msg.sender;
    }

    // ======== 2. äº‹ä»¶ï¼šæŠŠå…³é”®æ•°æ®æ‰“åˆ°æ—¥å¿—é‡Œï¼Œæ–¹ä¾¿ä½ åœ¨åŒºå—æµè§ˆå™¨é‡Œç›´æ¥çœ‹ ========

    /// @notice æŠŠ hint() è¿”å›çš„ raw æ•°æ®è®°å½•ä¸‹æ¥ï¼›å¦‚æœèƒ½çŒœæµ‹å‡º string/bytes32 ä¹Ÿä¸€å¹¶è®°
    event HintFetched(bytes raw, string decodedString, bytes32 decodedBytes32);

    /// @notice æŠŠ query() è¿”å›çš„ raw æ•°æ®è®°å½•ä¸‹æ¥ï¼›å¦‚æœèƒ½ decode æˆ string/bytes32 ä¹Ÿè®°
    event QuerySubmitted(bytes32 submittedHash, bytes rawReturn, string decodedString, bytes32 decodedBytes32);

    /// @notice å¯é€‰ï¼šæŠŠ getSolvers() çš„è§£ç ç»“æœæ‰“å‡ºæ¥
    event SolversFetched(address[] solvers);

    // ======== 3. è¯»å– hint()ï¼šå…ˆæ‹¿ raw bytesï¼Œå†â€œæ™ºèƒ½çŒœæµ‹â€è§£ç  ========

    /**
     * @notice è°ƒç”¨é¶å­åˆçº¦ hint()ï¼Œè¿”å› ABI ç¼–ç åçš„ raw bytes
     * @dev
     *  staticcallï¼šEVM å±‚é¢å¼ºåˆ¶â€œä¸å¯å†™çŠ¶æ€â€ï¼Œé€‚åˆ view/pure ç±»å‡½æ•°ã€‚
     *  è¿™é‡Œä¸å‡è®¾ hint() çš„è¿”å›ç±»å‹ï¼Œå…ˆç›´æ¥æ‹¿å› dataã€‚
     */
    function hintRaw() public view returns (bytes memory data) {
        // ç›®æ ‡å‡½æ•°ç­¾åï¼šhint()
        bytes memory callData = abi.encodeWithSignature("hint()");

        (bool ok, bytes memory ret) = TARGET.staticcall(callData);
        require(ok, _revertMsg(ret));

        return ret;
    }

    /**
     * @notice å°è¯•æŠŠ hint() çš„è¿”å›å€¼â€œçŒœæµ‹æ€§è§£ç â€ä¸º string æˆ– bytes32ï¼Œå¹¶å‘äº‹ä»¶æ–¹ä¾¿æŸ¥çœ‹
     * @dev
     *  ABI è§„åˆ™ï¼š
     *   - å¦‚æœè¿”å› bytes32ï¼Œret.length é€šå¸¸æ˜¯ 32
     *   - å¦‚æœè¿”å› stringï¼ˆåŠ¨æ€ç±»å‹ï¼‰ï¼Œret.length é€šå¸¸ >= 64ï¼ˆåŒ…å« offset/length/dataï¼‰
     *  è¿™åªæ˜¯ç»éªŒè§„åˆ™ï¼šæˆ‘ä»¬ç”¨å®ƒåšâ€œå°½åŠ›çŒœæµ‹â€ï¼Œä¸ä¿è¯ 100%ã€‚
     */
    function fetchHint() external returns (bytes memory raw) {
        raw = hintRaw();

        string memory asString = "";
        bytes32 asB32 = bytes32(0);

        if (raw.length == 32) {
            // å¾ˆåƒ bytes32
            asB32 = abi.decode(raw, (bytes32));
        } else {
            // å…ˆå°è¯•å½“ä½œ string è§£ç ï¼›å¦‚æœä¸æ˜¯ stringï¼Œä¼š revert
            // ä¸ºäº†ä¸è®©æ•´ä¸ªå‡½æ•° revertï¼Œæˆ‘ä»¬ç”¨ try/catch åŒ…ä¸€å±‚å¤–éƒ¨è°ƒç”¨æŠ€å·§ï¼š
            // è¿™é‡Œç”¨å†…éƒ¨å‡½æ•° _decodeString æ¥éš”ç¦» revertã€‚
            try this._decodeString(raw) returns (string memory s) {
                asString = s;
            } catch {
                // å¿½ç•¥ï¼šè¯´æ˜ä¸æ˜¯ string æˆ–æ•°æ®ä¸ç¬¦åˆ string ABI ç¼–ç 
            }
        }

        emit HintFetched(raw, asString, asB32);
    }

    /**
     * @notice ä»…ç”¨äº try/catch çš„ string è§£ç â€œéš”ç¦»å™¨â€
     * @dev
     *  æ³¨æ„ï¼štry/catch åªèƒ½åŒ…â€œå¤–éƒ¨è°ƒç”¨â€ï¼Œæ‰€ä»¥è¿™é‡Œç”¨ this._decodeString(...) è§¦å‘ä¸€æ¬¡å¤–éƒ¨è°ƒç”¨ã€‚
     */
    function _decodeString(bytes memory raw) external pure returns (string memory) {
        return abi.decode(raw, (string));
    }

    // ======== 4. è®¡ç®—ç­”æ¡ˆ hash çš„å·¥å…·å‡½æ•°ï¼ˆä½ æ ¹æ® hint é€‰æ‹©ç”¨å“ªä¸ªï¼‰ ========

    /**
     * @notice æœ€å¸¸è§ï¼šå¯¹â€œæ˜æ–‡ç­”æ¡ˆå­—ç¬¦ä¸²â€åš keccak256
     * @dev
     *  keccak256 æ˜¯ Solidity å†…ç½®å“ˆå¸Œï¼›bytes(s) æ˜¯ UTF-8 å­—èŠ‚åºåˆ—ã€‚
     *  ç­‰ä»·å†™æ³•ï¼škeccak256(abi.encodePacked(s))ï¼ˆå¯¹å•ä¸ª string æ—¶ç­‰ä»·ï¼‰
     */
    function hashString(string calldata answerPlain) public pure returns (bytes32) {
        return keccak256(bytes(answerPlain));
    }

    /**
     * @notice å¯¹â€œä»»æ„ bytesâ€åš keccak256
     * @dev
     *  å½“ hint è¦ä½ æ‹¼æ¥/ç¼–ç æŸäº›å­—æ®µåå† hashï¼Œå°±å¯ä»¥å…ˆåœ¨æœ¬åˆçº¦é‡Œæ‹¼å‡º bytesï¼Œå†èµ°è¿™ä¸ªå‡½æ•°ã€‚
     */
    function hashBytes(bytes calldata blob) public pure returns (bytes32) {
        return keccak256(blob);
    }

    /**
     * @notice å…¸å‹ CTF æ‹¼æ¥æ³•ï¼škeccak256(abi.encodePacked(a, b, c...))
     * @dev
     *  encodePacked æ˜¯â€œç´§å¯†ç¼–ç â€ï¼Œæ›´çœå­—èŠ‚ï¼Œä½†å¦‚æœæ··ç”¨åŠ¨æ€ç±»å‹å¯èƒ½äº§ç”Ÿâ€œæ‹¼æ¥æ­§ä¹‰/ç¢°æ’é£é™©â€ï¼›
     *  å¦‚æœ hint æ²¡è¦æ±‚ï¼Œä¸€èˆ¬æ›´æ¨è abi.encode(...)ï¼ˆå¸¦ç±»å‹è¾¹ç•Œï¼‰ã€‚:contentReference[oaicite:2]{index=2}
     */
    function hashPacked(string calldata a, string calldata b, uint256 n) public pure returns (bytes32) {
        return keccak256(abi.encodePacked(a, b, n));
    }

    /**
     * @notice æ›´â€œå®‰å…¨â€çš„ç»“æ„åŒ–ç¼–ç ï¼škeccak256(abi.encode(...))
     * @dev
     *  encode ä¼šæŠŠæ¯ä¸ªå‚æ•°æŒ‰ ABI è§„åˆ™ paddingï¼Œç±»å‹è¾¹ç•Œæ˜ç¡®ï¼Œé¿å… packed çš„æ‹¼æ¥æ­§ä¹‰ã€‚
     */
    function hashEncoded(string calldata a, string calldata b, uint256 n) public pure returns (bytes32) {
        return keccak256(abi.encode(a, b, n));
    }

    // ======== 5. æäº¤ç­”æ¡ˆï¼šå¿…é¡»ä»åˆçº¦é‡Œè°ƒç”¨ query(bytes32) ========

    /**
     * @notice ç›´æ¥æäº¤â€œç­”æ¡ˆ hashâ€ï¼ˆbytes32ï¼‰ç»™é¶å­åˆçº¦çš„ query(bytes32)
     * @return rawReturn query() çš„åŸå§‹è¿”å›æ•°æ®ï¼ˆå¯èƒ½æ˜¯ç©ºï¼Œä¹Ÿå¯èƒ½æ˜¯ ABI ç¼–ç çš„ string/bytes32ï¼‰
     */
    function submitHash(bytes32 answerHash) public onlyOwner returns (bytes memory rawReturn) {
        // ç›®æ ‡å‡½æ•°ç­¾åï¼šquery(bytes32)
        bytes memory callData = abi.encodeWithSignature("query(bytes32)", answerHash);

        (bool ok, bytes memory ret) = TARGET.call(callData);
        require(ok, _revertMsg(ret));

        // å°è¯•çŒœæµ‹æ€§è§£ç è¿”å›å€¼ï¼ˆæœ‰çš„é¢˜ä¼šç›´æ¥ return flag stringï¼‰
        string memory asString = "";
        bytes32 asB32 = bytes32(0);

        if (ret.length == 32) {
            asB32 = abi.decode(ret, (bytes32));
        } else if (ret.length >= 64) {
            try this._decodeString(ret) returns (string memory s) {
                asString = s;
            } catch {
                // ignore
            }
        }

        emit QuerySubmitted(answerHash, ret, asString, asB32);
        return ret;
    }

    /**
     * @notice ä½ ä¹Ÿå¯ä»¥æŠŠâ€œæ˜æ–‡ç­”æ¡ˆâ€ç›´æ¥ä¼ è¿›æ¥ï¼Œè®©åˆçº¦å¸®ä½  hash å†æäº¤
     * @dev
     *  é€‚åˆï¼šhint ç›´æ¥å‘Šè¯‰ä½ ç­”æ¡ˆæ˜æ–‡æ˜¯ä»€ä¹ˆï¼ˆæ¯”å¦‚æŸä¸ªå•è¯/çŸ­å¥/æ•°å­—å­—ç¬¦ä¸²ï¼‰
     */
    function solveWithPlaintext(string calldata answerPlain) external onlyOwner returns (bytes memory rawReturn) {
        bytes32 h = hashString(answerPlain);
        return submitHash(h);
    }

    // ======== 6. è¯»å–å®Œæˆè€…åˆ—è¡¨ï¼šgetSolvers() ========

    /**
     * @notice è°ƒé¶å­åˆçº¦ getSolvers()ï¼Œå¹¶ decode æˆ address[]
     * @dev
     *  å¦‚æœé¶å­åˆçº¦ç¡®å®æœ‰ getSolvers() ä¸”è¿”å› address[]ï¼Œè¿™é‡Œå°±èƒ½ç›´æ¥æ‹¿åˆ°ã€‚
     */
    function getSolvers() external returns (address[] memory solvers) {
        bytes memory callData = abi.encodeWithSignature("getSolvers()");
        (bool ok, bytes memory ret) = TARGET.staticcall(callData);
        require(ok, _revertMsg(ret));

        solvers = abi.decode(ret, (address[]));
        emit SolversFetched(solvers);
    }

    // ======== 7. ä½çº§è°ƒç”¨å¤±è´¥æ—¶ï¼Œå°½é‡æŠŠ revert reason è¿˜åŸå‡ºæ¥ ========

    /**
     * @dev
     *  å½“ call/staticcall å¤±è´¥æ—¶ï¼ŒEVM ä¼šæŠŠ revert data è¿”å›ç»™ä½ ï¼š
     *   - å¦‚æœæ˜¯ Error(string)ï¼Œæ ¼å¼æ˜¯ 4 å­—èŠ‚ selector + ABI ç¼–ç  string
     *   - å¦‚æœæ˜¯è‡ªå®šä¹‰ error æˆ–ç©º revertï¼Œå¯èƒ½è§£æä¸å‡ºåŸå› 
     *  è¿™é‡Œåšâ€œå°½åŠ›è§£æâ€ï¼Œè§£æä¸å‡ºå°±ç»™ä¸€ä¸ªå…œåº•ä¿¡æ¯ã€‚
     */
    function _revertMsg(bytes memory revertData) internal pure returns (string memory) {
        if (revertData.length < 4) return "Call failed (no revert data)";

        // Error(string) çš„ selector æ˜¯ 0x08c379a0
        bytes4 selector;
        assembly {
            selector := mload(add(revertData, 32))
        }

        if (selector == 0x08c379a0 && revertData.length >= 68) {
            // è·³è¿‡ 4 å­—èŠ‚ selectorï¼Œå†æŒ‰ string è§£ç 
            bytes memory sliced = new bytes(revertData.length - 4);
            for (uint256 i = 0; i < sliced.length; i++) {
                sliced[i] = revertData[i + 4];
            }
            return abi.decode(sliced, (string));
        }

        return "Call failed (non-Error(string) revert)";
    }
}
```

1. æ‰“å¼€ Remixï¼ˆæµè§ˆå™¨ç‰ˆï¼‰ï¼Œæ–°å»º Solver.solï¼Œç²˜è´´ä¸Šé¢ä»£ç 
2. Solidity Compiler é€‰æ‹© 0.8.20+ï¼ˆæˆ–æ›´é«˜ 0.8.xï¼‰ï¼Œç‚¹å‡» Compile
3. Deploy & Runï¼š
   - Environment é€‰ Injected Provider - MetaMask
   - MetaMask åˆ‡åˆ° Sepolia
   - éƒ¨ç½² SepoliaFlagSolverï¼ˆä½ éœ€è¦ä¸€ç‚¹ç‚¹ Sepolia æµ‹è¯• ETHä»˜ gasï¼›è¿™æ˜¯æµ‹è¯•ç½‘ï¼‰ã€‚CONTRACT é€‰ SepoliaFlagSolver - Solver.solï¼Œç„¶åç‚¹å‡» `Deploy & Verify` æŒ‰é’®
4. éƒ¨ç½²åï¼Œå…ˆç‚¹è°ƒç”¨ï¼š
   - fetchHint()ï¼šä¼šè§¦å‘ HintFetched(...) äº‹ä»¶ï¼ˆåœ¨ Remix çš„ logs é‡Œçœ‹ï¼‰
     - å¦‚æœèƒ½è§£ç æˆ stringï¼Œä½ ä¼šç›´æ¥çœ‹åˆ°æç¤ºæ–‡æœ¬
     - å¦‚æœæ˜¯ bytes32ï¼Œä½ ä¼šçœ‹åˆ° decodedBytes32

5. æŒ‰ hint çš„è¦æ±‚ç®—ç­”æ¡ˆï¼š
   - å¦‚æœ hint ç›´æ¥ç»™â€œç­”æ¡ˆæ˜æ–‡â€ï¼Œç”¨ solveWithPlaintext("ç­”æ¡ˆ")
   - å¦‚æœ hint è¦ä½  hash æŸç§æ‹¼æ¥ï¼š
     - ä½ å¯ä»¥å…ˆç”¨ hashPacked(...) / hashEncoded(...) åœ¨é“¾ä¸Šç®—å‡º bytes32
     - å†æŠŠç®—å‡ºæ¥çš„ bytes32 å¡«è¿› submitHash(0x...)

6. æˆåŠŸåï¼š
   - é¶å­åˆçº¦åº”è§¦å‘ ChallengeCompletedï¼ˆåœ¨æµè§ˆå™¨/Remix äº¤æ˜“æ—¥å¿—é‡Œèƒ½çœ‹åˆ°ï¼‰
   - å¦‚æœ query() æœ‰ return flagï¼Œæœ¬åˆçº¦ä¼šåœ¨ QuerySubmitted(...) é‡Œå°½åŠ› decode æˆ string ç»™ä½ çœ‹

å®é™…æƒ…å†µ
1. ç‚¹å‡» `Deploy & Verify` éƒ¨ç½²æˆåŠŸï¼Œåœ¨ `Deployed Contracts` ä¸­å¯ä»¥çœ‹åˆ°æŒ‰é’®ã€‚
2. ç‚¹å‡» `fetchHint()`ï¼Œæ˜¾ç¤º
```Bash

[block:9830638 txIndex:4]from: 0x5b9...dbA5Ato: SepoliaFlagSolver.fetchHint() 0xb4f...35313value: 0 weidata: 0xacc...09c67logs: 1hash: 0xbdd...a5c4f
status	1 Transaction mined and execution succeed
transaction hash	0xc0c922946e69d95f0e2859f7633b211c7b5c70028ce255a317c3e2a2ac37ad34
block hash	0xbdd3e6ad55a3a0fc6ceedce9bbc1b4317d296e414343afbc3b714168af1a5c4f
block number	9830638
from	0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
to	SepoliaFlagSolver.fetchHint() 0xb4f91Dd760BebC50EAc129bE369114fc2CD35313
transaction cost	33702 gas 
decoded input	{}
decoded output	 - 
logs	[
	{
		"from": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
		"topic": "0x9ad59c52bdf90579028db124d8acf23a6fe0fca9ad05b1f452b37181b2391e5d",
		"event": "HintFetched",
		"args": {
			"0": "0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000146b656363616b20504b55426c6f636b636861696e000000000000000000000000",
			"1": "keccak PKUBlockchain",
			"2": "0x0000000000000000000000000000000000000000000000000000000000000000"
		}
	}
]
raw logs	[
  {
    "_type": "log",
    "address": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
    "blockHash": "0xbdd3e6ad55a3a0fc6ceedce9bbc1b4317d296e414343afbc3b714168af1a5c4f",
    "blockNumber": 9830638,
    "data": "0x000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000146b656363616b20504b55426c6f636b636861696e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000146b656363616b20504b55426c6f636b636861696e000000000000000000000000",
    "index": 8,
    "topics": [
      "0x9ad59c52bdf90579028db124d8acf23a6fe0fca9ad05b1f452b37181b2391e5d"
    ],
    "transactionHash": "0xc0c922946e69d95f0e2859f7633b211c7b5c70028ce255a317c3e2a2ac37ad34",
    "transactionIndex": 4
  }
]
```
æŸ¥çœ‹ logsï¼Œå‘Šè¯‰æˆ‘ä»¬ hint æ˜¯ `keccak PKUBlockchain`ï¼Œå…¶å®ƒçš„å«ä¹‰ä¸º
- 0 æ˜¯â€œåŸå§‹æ•°æ®â€ï¼ˆç»™ä½ å…œåº•ç”¨ï¼‰
- 1 æ˜¯â€œæŠŠåŸå§‹æ•°æ®å½“ string è§£å‡ºæ¥çš„å¯è¯»æç¤ºâ€ï¼ˆä½ çœŸæ­£è¦çœ‹çš„ï¼‰
- 2 æ˜¯â€œå¦‚æœå®ƒå…¶å®æ˜¯ bytes32 æ—¶çš„è§£ç ç»“æœâ€ï¼ˆè¿™é¢˜æ²¡ç”¨åˆ°ï¼Œæ‰€ä»¥æ˜¯ 0ï¼‰


3. keccak æ˜¯å“ˆå¸Œå‡½æ•°ï¼Œè¿›å…¥ç½‘é¡µï¼šhttps://emn178.github.io/online-tools/keccak_256.html ã€‚å°±å¯ä»¥å¾—åˆ° `PKUBlockchain` çš„å“ˆå¸Œå€¼ä¸º `e2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215`ï¼Œè¿™æ˜¯ä¸€ä¸ª bytes32 å€¼ï¼Œ32å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ 256 ä½çš„å“ˆå¸Œå€¼ï¼Œä½†æ˜¯è¿™æœ‰ä¸ªé—®é¢˜ï¼Œåœ¨ Solidity / Remix / Ethers.js é‡Œï¼ŒæŠŠå®ƒå½“ bytes32 ä¼ å‚æ—¶ï¼Œé€šå¸¸å¿…é¡»åŠ ä¸Š `0x` å‰ç¼€ï¼Œå˜æˆ `0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215`ã€‚
4. æäº¤ç­”æ¡ˆ
    - ç›´æ¥è°ƒç”¨`solveWithPlaintext()`ï¼Œåœ¨ Deployed Contracts é‡Œå¯ä»¥æ‰¾ä¸ªè¿™ä¸ªæŒ‰é’®ï¼Œè¾“å…¥ `PKUBlockchain`ï¼Œç„¶åæ‰§è¡Œ
    - ç›´æ¥æäº¤ hashï¼šè°ƒç”¨ `submitHash()`ï¼Œè¾“å…¥å“ˆå¸Œå€¼ `0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215`

    æ–¹æ¡ˆä¸€å¾—åˆ°
    ```Bash
    [block:9830677 txIndex:8]from: 0x5b9...dbA5Ato: SepoliaFlagSolver.submitHash(bytes32) 0xb4f...35313value: 0 weidata: 0x088...14215logs: 2hash: 0x50e...5cba0
    status	1 Transaction mined and execution succeed
    transaction hash	0x0acd7700f8954987b4bfbb29b3a746b8e5852f843ae57cdb90370121f3a2c53a
    block hash	0x50e6469264ec7e7043570e4f6f8952e20c4311a24208b44a934fe418a4e5cba0
    block number	9830677
    from	0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
    to	SepoliaFlagSolver.submitHash(bytes32) 0xb4f91Dd760BebC50EAc129bE369114fc2CD35313
    transaction cost	87756 gas 
    decoded input	{
        "bytes32 answerHash": "0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215"
    }
    decoded output	 - 
    logs	[
        {
            "from": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
            "topic": "0x8266f14bb4709222ba71d57776157a134a777a642d80bd52029333fdfdc17b76",
            "event": "QuerySubmitted",
            "args": {
                "0": "0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215",
                "1": "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002a464c41477b504b555f426c6f636b636861696e5f436f6c6561726e5f5765656b315f537563636573737d00000000000000000000000000000000000000000000",
                "2": "FLAG{PKU_Blockchain_Colearn_Week1_Success}",
                "3": "0x0000000000000000000000000000000000000000000000000000000000000000"
            }
        }
    ]
    raw logs	[
    {
        "_type": "log",
        "address": "0x4a6C0c0dc8bD8276b65956c9978ef941C3550A1B",
        "blockHash": "0x50e6469264ec7e7043570e4f6f8952e20c4311a24208b44a934fe418a4e5cba0",
        "blockNumber": 9830677,
        "data": "0x00000000000000000000000000000000000000000000000000000000693d35fc",
        "index": 17,
        "topics": [
        "0x57213678a1941131f1846559e4f0509e68d1a52c4d05bf0c3e8514c7a00b5d0b",
        "0x000000000000000000000000b4f91dd760bebc50eac129be369114fc2cd35313"
        ],
        "transactionHash": "0x0acd7700f8954987b4bfbb29b3a746b8e5852f843ae57cdb90370121f3a2c53a",
        "transactionIndex": 8
    },
    {
        "_type": "log",
        "address": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
        "blockHash": "0x50e6469264ec7e7043570e4f6f8952e20c4311a24208b44a934fe418a4e5cba0",
        "blockNumber": 9830677,
        "data": "0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd2241421500000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002a464c41477b504b555f426c6f636b636861696e5f436f6c6561726e5f5765656b315f537563636573737d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a464c41477b504b555f426c6f636b636861696e5f436f6c6561726e5f5765656b315f537563636573737d00000000000000000000000000000000000000000000",
        "index": 18,
        "topics": [
        "0x8266f14bb4709222ba71d57776157a134a777a642d80bd52029333fdfdc17b76"
        ],
        "transactionHash": "0x0acd7700f8954987b4bfbb29b3a746b8e5852f843ae57cdb90370121f3a2c53a",
        "transactionIndex": 8
    }
    ]
    ```
    ä¸Šé¢çš„ logs é‡Œæ˜¾ç¤º `FLAG{PKU_Blockchain_Colearn_Week1_Success}` ï¼Œä»£è¡¨æˆåŠŸã€‚
    æ–¹æ¡ˆäºŒå¾—åˆ°
    ```Bash
    [block:9831219 txIndex:18]from: 0x5b9...dbA5Ato: SepoliaFlagSolver.solveWithPlaintext(string) 0xb4f...35313value: 0 weidata: 0x9e4...00000logs: 2hash: 0x7b4...8e564
    status	1 Transaction mined and execution succeed
    transaction hash	0x78c07caf0dfba8a4f210d0db4279324a08a9fcf7cd8004f51808d2a9606318be
    block hash	0x7b47eac4d24823fe204791b02713ec340487a17487ee5e34f23692537848e564
    block number	9831219
    from	0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
    to	SepoliaFlagSolver.solveWithPlaintext(string) 0xb4f91Dd760BebC50EAc129bE369114fc2CD35313
    transaction cost	40845 gas 
    decoded input	{
        "string answerPlain": "PKUBlockchain"
    }
    decoded output	 - 
    logs	[
        {
            "from": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
            "topic": "0x8266f14bb4709222ba71d57776157a134a777a642d80bd52029333fdfdc17b76",
            "event": "QuerySubmitted",
            "args": {
                "0": "0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd22414215",
                "1": "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002a464c41477b504b555f426c6f636b636861696e5f436f6c6561726e5f5765656b315f537563636573737d00000000000000000000000000000000000000000000",
                "2": "FLAG{PKU_Blockchain_Colearn_Week1_Success}",
                "3": "0x0000000000000000000000000000000000000000000000000000000000000000"
            }
        }
    ]
    raw logs	[
    {
        "_type": "log",
        "address": "0x4a6C0c0dc8bD8276b65956c9978ef941C3550A1B",
        "blockHash": "0x7b47eac4d24823fe204791b02713ec340487a17487ee5e34f23692537848e564",
        "blockNumber": 9831219,
        "data": "0x00000000000000000000000000000000000000000000000000000000693d4f64",
        "index": 123,
        "topics": [
        "0x57213678a1941131f1846559e4f0509e68d1a52c4d05bf0c3e8514c7a00b5d0b",
        "0x000000000000000000000000b4f91dd760bebc50eac129be369114fc2cd35313"
        ],
        "transactionHash": "0x78c07caf0dfba8a4f210d0db4279324a08a9fcf7cd8004f51808d2a9606318be",
        "transactionIndex": 18
    },
    {
        "_type": "log",
        "address": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
        "blockHash": "0x7b47eac4d24823fe204791b02713ec340487a17487ee5e34f23692537848e564",
        "blockNumber": 9831219,
        "data": "0xe2a73c8e3af6379fa58e477b0e2129f21e0230100f0462b9832b00cd2241421500000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002a464c41477b504b555f426c6f636b636861696e5f436f6c6561726e5f5765656b315f537563636573737d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a464c41477b504b555f426c6f636b636861696e5f436f6c6561726e5f5765656b315f537563636573737d00000000000000000000000000000000000000000000",
        "index": 124,
        "topics": [
        "0x8266f14bb4709222ba71d57776157a134a777a642d80bd52029333fdfdc17b76"
        ],
        "transactionHash": "0x78c07caf0dfba8a4f210d0db4279324a08a9fcf7cd8004f51808d2a9606318be",
        "transactionIndex": 18
    }
    ]
    ```
    ç‚¹å‡» `getSolvers`ï¼Œå¯ä»¥çœ‹åˆ°å®Œæˆè€…åˆ—è¡¨ã€‚
    ```Bash

    [block:9830706 txIndex:4]from: 0x5b9...dbA5Ato: SepoliaFlagSolver.getSolvers() 0xb4f...35313value: 0 weidata: 0x8bc...1e8eblogs: 1hash: 0xc1c...eba70
    status	1 Transaction mined and execution succeed
    transaction hash	0x4179351b392ad934c20f905c2ce171a811fe511a5054f16dc978d32f31606fd1
    block hash	0xc1c16dd1d6ebd3a8855adf7b0b0808e369c8c095e6e99b6524b6a9a11f8eba70
    block number	9830706
    from	0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
    to	SepoliaFlagSolver.getSolvers() 0xb4f91Dd760BebC50EAc129bE369114fc2CD35313
    transaction cost	235300 gas 
    decoded input	{}
    decoded output	 - 
    logs	[
        {
            "from": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
            "topic": "0x7b577cdd78df5a5866441b646f0193baede556ac9221461cd2e8060ff7279731",
            "event": "SolversFetched",
            "args": {
                "0": [
                    "0x218c49ac3F5ff91E7B4224dAAd7DdB1035D8c0F5",
                    "0xE80F519C246A2ed3B8d6B169C260389259d3E984",
                    "0x9e23a871543b160c13C8934bACe43B1D254C71bD",
                    "0x6F00A229cf51DB7Eec4B6996F2eBcFE365C0Ae98",
                    "0xCAc7f9d65914D7E03570Eb483E42D4Edf57c3A24",
                    "0xD72FE434FbC195b9f9977A946b9f947b3393D9Bd",
                    "0x42f7146F2fc178D0fe9C6877132e3f198b2CA261",
                    "0xa930B5059aE91C073684f0D2AFB0bBf5d84167C9",
                    "0x259fe967B55D20d04dB16858b4b0f648DdA21Eb1",
                    "0x27dc1B8C2A7686eB9e1867eAb5Cc72ECd0B244e8",
                    "0x123A03ec3979a1dbE9e91A0a1A809D0b2C7782bf",
                    "0xe81C686e6cEb2534f9703f5FF28640FA0fDFeEC1",
                    "0x8590C303374A00b58805318188a959059bD3332E",
                    "0x6faCCA1ff14bdfA04ccc3e19175432Dd2711b4c2",
                    "0x5DAB5b8600EaBB7450fCD084D9A377F280031297",
                    "0x0c3f07ee333489b2C5a257318C90273d1192B4b6",
                    "0xAACF85a258722f7C4A95635955c579469f1E7661",
                    "0xA98043AfD36bC184285951765C2833aaCDCF014C",
                    "0x4Ec3b4499223661c6932cB76952eB3c046a1Fd3A",
                    "0x27D3b992227976DF65e7a404ca7421f94ACBea7a",
                    "0xCc6FFE507ae55807E3b2CE5dffE36Fe14b9D2a8C",
                    "0xeC8aC4624E0CAfC8384BE140dD6a5b53f4CD5cE5",
                    "0xa0d8E9A7b81a78D0031acB47defd214A7b8eBFa8",
                    "0xb3c0aBfd2f6f47952e1Cf2B9cF8A8fDBF6651F3C",
                    "0x9Bd28675069f200961B50F13C476aDa5e7067C31",
                    "0xB5312cb94F72fC0b1e42CF8393Aa55F5C3658F2d",
                    "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313"
                ]
            }
        }
    ]
    raw logs	[
    {
        "_type": "log",
        "address": "0xb4f91Dd760BebC50EAc129bE369114fc2CD35313",
        "blockHash": "0xc1c16dd1d6ebd3a8855adf7b0b0808e369c8c095e6e99b6524b6a9a11f8eba70",
        "blockNumber": 9830706,
        "data": "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000218c49ac3f5ff91e7b4224daad7ddb1035d8c0f5000000000000000000000000e80f519c246a2ed3b8d6b169c260389259d3e9840000000000000000000000009e23a871543b160c13c8934bace43b1d254c71bd0000000000000000000000006f00a229cf51db7eec4b6996f2ebcfe365c0ae98000000000000000000000000cac7f9d65914d7e03570eb483e42d4edf57c3a24000000000000000000000000d72fe434fbc195b9f9977a946b9f947b3393d9bd00000000000000000000000042f7146f2fc178d0fe9c6877132e3f198b2ca261000000000000000000000000a930b5059ae91c073684f0d2afb0bbf5d84167c9000000000000000000000000259fe967b55d20d04db16858b4b0f648dda21eb100000000000000000000000027dc1b8c2a7686eb9e1867eab5cc72ecd0b244e8000000000000000000000000123a03ec3979a1dbe9e91a0a1a809d0b2c7782bf000000000000000000000000e81c686e6ceb2534f9703f5ff28640fa0fdfeec10000000000000000000000008590c303374a00b58805318188a959059bd3332e0000000000000000000000006facca1ff14bdfa04ccc3e19175432dd2711b4c20000000000000000000000005dab5b8600eabb7450fcd084d9a377f2800312970000000000000000000000000c3f07ee333489b2c5a257318c90273d1192b4b6000000000000000000000000aacf85a258722f7c4a95635955c579469f1e7661000000000000000000000000a98043afd36bc184285951765c2833aacdcf014c0000000000000000000000004ec3b4499223661c6932cb76952eb3c046a1fd3a00000000000000000000000027d3b992227976df65e7a404ca7421f94acbea7a000000000000000000000000cc6ffe507ae55807e3b2ce5dffe36fe14b9d2a8c000000000000000000000000ec8ac4624e0cafc8384be140dd6a5b53f4cd5ce5000000000000000000000000a0d8e9a7b81a78d0031acb47defd214a7b8ebfa8000000000000000000000000b3c0abfd2f6f47952e1cf2b9cf8a8fdbf6651f3c0000000000000000000000009bd28675069f200961b50f13c476ada5e7067c31000000000000000000000000b5312cb94f72fc0b1e42cf8393aa55f5c3658f2d000000000000000000000000b4f91dd760bebc50eac129be369114fc2cd35313",
        "index": 4,
        "topics": [
        "0x7b577cdd78df5a5866441b646f0193baede556ac9221461cd2e8060ff7279731"
        ],
        "transactionHash": "0x4179351b392ad934c20f905c2ce171a811fe511a5054f16dc978d32f31606fd1",
        "transactionIndex": 4
    }
    ]
    ```

**å¦‚ä½•çœ‹åˆ° `ChallengeCompleted` äº‹ä»¶ï¼Ÿ**

ChallengeCompleted æ˜¯é¶å­åˆçº¦å‘å‡ºæ¥çš„äº‹ä»¶ï¼Œæ‰€ä»¥ä½ è¦åœ¨â€œé‚£ç¬”äº¤æ˜“çš„æ—¥å¿—ï¼ˆlogsï¼‰â€é‡Œçœ‹ã€‚æœ€ç¨³çš„æŸ¥çœ‹æ–¹å¼æœ‰ 3 ç§ï¼š

æ–¹æ³• 1ï¼šåœ¨ Etherscan çœ‹ï¼ˆæœ€æ¨èï¼‰

1. ä½ åœ¨ Remix ç‚¹ submitHash(...) ä¹‹åï¼Œåº•ä¸‹ Terminal ä¼šå‡ºç°ä¸€è¡Œç±»ä¼¼ï¼š
   - transaction hash: 0x...
2. æŠŠè¿™ä¸ª **äº¤æ˜“å“ˆå¸Œï¼ˆ0x å¼€å¤´é‚£ä¸²ï¼‰** å¤åˆ¶å‡ºæ¥
3. æ‰“å¼€ Sepolia Etherscanï¼ŒæŠŠäº¤æ˜“å“ˆå¸Œç²˜è¿›å»æœç´¢
4. åœ¨äº¤æ˜“é¡µé¢å¾€ä¸‹æ‰¾ï¼š
   - Logs / Transaction Receipt / Eventsï¼ˆä¸åŒç•Œé¢å«æ³•ç•¥æœ‰å·®åˆ«ï¼‰
5. ä½ ä¼šçœ‹åˆ°äº‹ä»¶åˆ—è¡¨ï¼š
   - ä½ è‡ªå·±çš„åˆçº¦äº‹ä»¶ï¼ˆæ¯”å¦‚ QuerySubmittedï¼‰
   - ä»¥åŠé¶å­åˆçº¦çš„äº‹ä»¶ï¼ˆå¦‚æœ ABI å¯è¯†åˆ«ï¼Œä¼šç›´æ¥æ˜¾ç¤º ChallengeCompletedï¼›å¦‚æœä¸è¯†åˆ«ï¼Œä¹Ÿä¼šæ˜¾ç¤ºä¸€æ¡ logï¼Œåªæ˜¯åå­—ä¸æ˜¾ç¤ºï¼‰

<p align="center">
    <image src="md_assets/LuBryant/image-1.png" alt="alt text"/>
</p>


æ–¹æ³• 2ï¼šåœ¨ Remix é‡Œçœ‹â€œäº¤æ˜“æ—¥å¿—â€

1. Remix é‡Œç‚¹å®Œ transact åï¼ŒTerminal ä¼šæ‰“å° â€œdecoded output / logsâ€
2. ä½ ä¸€å®šèƒ½çœ‹åˆ°ä½ è§£é¢˜åˆçº¦è‡ªå·±çš„äº‹ä»¶ï¼ˆQuerySubmittedã€HintFetchedï¼‰
3. ä½†é¶å­åˆçº¦çš„ ChallengeCompleted æœ‰æ—¶ Remix ä¸ä¸€å®šèƒ½è‡ªåŠ¨è§£ç æˆåå­—ï¼ˆå› ä¸º Remix ä¸çŸ¥é“é¶å­åˆçº¦ ABIï¼‰ï¼Œå¯èƒ½åªæ˜¾ç¤ºæˆä¸€æ¡åŸå§‹ logï¼ˆtopic + dataï¼‰
4. æ‰€ä»¥ï¼šRemix èƒ½çœ‹ï¼Œä½†ä¸ä¸€å®šç›´æ¥æ˜¾ç¤º ChallengeCompleted è¿™ä¸ªåå­—ï¼ŒEtherscan æ›´ç›´è§‚ã€‚

æ–¹æ³• 3ï¼šç”¨ getSolvers() éªŒè¯æ˜¯å¦å®Œæˆï¼ˆæ—è¯ï¼‰

- å®Œæˆåï¼Œä½ çš„åœ°å€é€šå¸¸ä¼šå‡ºç°åœ¨é¶å­åˆçº¦çš„å®Œæˆè€…åˆ—è¡¨é‡Œã€‚
- ä½ å¯ä»¥åœ¨æˆ‘ç»™ä½ çš„ Solver åˆçº¦é‡Œç‚¹ï¼šgetSolvers()
- çœ‹è¾“å‡º/äº‹ä»¶ SolversFetched
- æˆ–è€…ç›´æ¥åœ¨ Etherscan é¶å­åˆçº¦é¡µé¢çš„ â€œRead Contractâ€ é‡Œè°ƒç”¨ getSolvers()ï¼ˆå¦‚æœæœ‰å¯è¯»ç•Œé¢ï¼‰


**åˆçº¦åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ**
ä¸ºä»€ä¹ˆ getSolvers() é‡Œæ²¡æœ‰ä½ çš„é’±åŒ…åœ°å€ï¼Ÿ

å› ä¸ºä½ æ˜¯è¿™æ ·è°ƒç”¨çš„ï¼š
- ä½ çš„é’±åŒ…åœ°å€ï¼ˆEOAï¼‰ï¼š0x5b9e8d003C1D96D258E22B47cD00b8ac673dbA5A
- ä½ è°ƒç”¨çš„æ˜¯ä½ è‡ªå·±éƒ¨ç½²çš„è§£é¢˜åˆçº¦ï¼šSepoliaFlagSolverï¼ˆåœ°å€ 0xb4f91Dd760BebC50EAc129bE369114fc2CD35313ï¼‰
- ç„¶åè§£é¢˜åˆçº¦å†å»è°ƒç”¨é¶å­åˆçº¦çš„ query(...)

å¯¹é¶å­åˆçº¦æ¥è¯´ï¼Œmsg.sender çœ‹åˆ°çš„ä¸æ˜¯ä½ çš„é’±åŒ…ï¼Œè€Œæ˜¯ä½ çš„è§£é¢˜åˆçº¦åœ°å€ã€‚
æ‰€ä»¥é¶å­åˆçº¦çš„ getSolvers() å¾ˆå¯èƒ½è®°å½•çš„æ˜¯ï¼šâœ… `0xb4f91Dd760BebC50EAc129bE369114fc2CD35313`ï¼ˆä½ çš„ Solver åˆçº¦åœ°å€ï¼‰ï¼Œè€Œä¸æ˜¯ä½ çš„é’±åŒ…åœ°å€ã€‚

ä½ åœ¨ raw logs é‡Œä¹Ÿèƒ½ç›´æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼šé¶å­åˆçº¦é‚£æ¡ log çš„ topics[1] å°±æ˜¯ ...b4f91dd...35313ï¼ˆä½ çš„ Solver åˆçº¦ï¼‰ã€‚è¿™é€šå¸¸å°±æ˜¯ ChallengeCompleted(address solver, ...) è¿™ç§â€œindexed solverâ€çš„å‚æ•°ã€‚

> â€œè§£é¢˜åˆçº¦åœ°å€â€å°±æ˜¯ï¼šä½ æŠŠé‚£ä»½ Solver.sol éƒ¨ç½²åˆ° Sepolia ä¹‹åï¼Œåœ¨é“¾ä¸Šç”Ÿæˆçš„é‚£ä¸ªåˆçº¦å®ä¾‹çš„åœ°å€ï¼ˆ0xâ€¦ï¼‰ã€‚å®ƒè·Ÿâ€œé¶å­åˆçº¦åœ°å€â€æ˜¯åŒä¸€ç±»ä¸œè¥¿â€”â€”éƒ½æ˜¯é“¾ä¸Šä¸€ä¸ªåˆçº¦è´¦æˆ·çš„åœ°å€ã€‚

åœ¨ Remix é‡Œæˆ‘æ€ä¹ˆæ‰¾åˆ°â€œè§£é¢˜åˆçº¦åœ°å€â€ï¼Ÿ
- åœ¨ Remix å·¦ä¾§ Deploy & Run Transactions é‡Œï¼š
- ä½ éƒ¨ç½²å®Œåˆçº¦åï¼Œä¼šå‡ºç°åœ¨ Deployed Contracts
- åˆçº¦åå­—æ—è¾¹é€šå¸¸ä¼šæ˜¾ç¤º/å¯å±•å¼€çœ‹åˆ°ä¸€ä¸ª 0x...ï¼Œé‚£å°±æ˜¯ä½ çš„è§£é¢˜åˆçº¦åœ°å€


æƒ³çœ‹äº¤æ˜“æ•ˆæœï¼Œä¹Ÿå¯ä»¥æŠŠé¶å­åˆçº¦åœ°å€ç›´æ¥åœ¨ Etherscan é‡Œæ‰“å¼€ `0x4a6C0c0dc8bD8276b65956c9978ef941C3550A1B`
- æ‰¾ Contract â†’ Read Contract
- æ‰¾åˆ° getSolversï¼Œç‚¹ Query
- ç„¶åå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æäº¤æˆåŠŸçš„ address

<p align="center">
    <image src="md_assets/LuBryant/image-2.png" alt="alt text"/>
</p>

---

### 2025.12.13

#### Week 3 ä½¿ç”¨ Geth è¯»å–é“¾ä¸Šæ•°æ®

æœ¬å‘¨ç›®æ ‡ï¼š

- å­¦ä¼šç”¨ Geth çš„ Go å®¢æˆ·ç«¯ä» RPC èŠ‚ç‚¹è¯»å–é“¾ä¸Šä¿¡æ¯
- ç†è§£åŒºå—é“¾åº•å±‚æ•°æ®ç»“æ„ï¼ˆblockã€transactionã€receiptï¼‰

è¿™äº›æ˜¯åš DAppã€é“¾ä¸Šåˆ†æã€åˆçº¦è°ƒè¯•ç­‰çš„åŸºç¡€ã€‚

#### Week 3 Part I - Geth ç®€ä»‹

é¦–å…ˆäº†è§£äº† Gethã€‚The pronounce of Ethereum is "E-theer-ee-um", or like "uhÂ·'thehÂ·reeÂ·uhm".
By IPA Keyboard: https://ipa.typeit.org/
/É™â€™Î¸iriÉ™m/
/Iâ€™Î¸iriÉ™m/

##### èƒŒæ™¯ï¼šä»¥å¤ªåŠç½‘ç»œçš„è¿ä½œæ–¹å¼

å¯ä»¥å…ˆæŠŠä»¥å¤ªåŠç†è§£æˆä¸€ä¸ªç”±å…¨çƒè®¸å¤šè®¡ç®—æœºå…±åŒç»´æŠ¤çš„å…¬å…±è´¦æœ¬ï¼Œæ²¡æœ‰ä¸­å¿ƒæœåŠ¡å™¨ã€‚è¦è®©è¿™ä¸ªç³»ç»Ÿæ­£å¸¸è¿ä½œï¼Œä¸»è¦æ¶‰åŠä¸‰ä¸ªæ¦‚å¿µï¼š**ä»¥å¤ªåŠå®¢æˆ·ç«¯ã€èŠ‚ç‚¹ã€RPC**ã€‚

###### 1. ä»¥å¤ªåŠå®¢æˆ·ç«¯ï¼šåè®®çš„å…·ä½“å®ç°

ä»¥å¤ªåŠå®¢æˆ·ç«¯æ˜¯ä¸€ç±»éµå¾ªä»¥å¤ªåŠåè®®çš„è½¯ä»¶å®ç°ï¼Œæ¯”å¦‚ Gethã€Nethermindã€Erigon ç­‰ã€‚å®ƒä»¬è´Ÿè´£ï¼š

- æŒ‰åè®®æ ¼å¼è§£æåŒºå—å’Œäº¤æ˜“
- éªŒè¯æ–°åŒºå—æ˜¯å¦åˆæ³•
- ç»´æŠ¤æœ¬åœ°åŒºå—é“¾çŠ¶æ€ï¼ˆè´¦æˆ·ä½™é¢ã€åˆçº¦å­˜å‚¨ç­‰ï¼‰
- å’Œå…¶ä»–èŠ‚ç‚¹è¿›è¡Œ P2P é€šä¿¡ã€åŒæ­¥æ•°æ®

åªæœ‰å®‰è£…å¹¶è¿è¡Œè¿™äº›å®¢æˆ·ç«¯è½¯ä»¶ï¼Œç”µè„‘æ‰èƒ½çœŸæ­£â€œåŠ å…¥â€ä»¥å¤ªåŠç½‘ç»œã€‚

> ä½¿ç”¨æƒ…æ™¯ï¼š  
> ä½ åœ¨ç”µè„‘ä¸Šå®‰è£…å¹¶è¿è¡Œ Gethï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨è¿è¡Œä¸€ä¸ªä»¥å¤ªåŠå®¢æˆ·ç«¯å®ä¾‹ï¼Œå®ƒä¼šå¼€å§‹ä»ç½‘ç»œä¸ŠåŒæ­¥åŒºå—ï¼ŒæŠŠæœ¬åœ°å˜æˆä¸€ä¸ªä»¥å¤ªåŠèŠ‚ç‚¹ã€‚

###### 2. èŠ‚ç‚¹ï¼šè¿è¡Œå®¢æˆ·ç«¯çš„è½¯ä»¶å®ä¾‹

â€œèŠ‚ç‚¹â€æŒ‡çš„æ˜¯**è¿è¡Œäº†ä»¥å¤ªåŠå®¢æˆ·ç«¯ç¨‹åºçš„æœºå™¨**ã€‚ä»åŠŸèƒ½å’Œæ•°æ®å®Œæ•´æ€§è§’åº¦ï¼Œä¸€èˆ¬åˆ†ä¸ºï¼š

- **å…¨èŠ‚ç‚¹ï¼ˆfull nodeï¼‰**ï¼šä¿å­˜å½“å‰å®Œæ•´çŠ¶æ€å’Œå¿…è¦çš„å†å²æ•°æ®ï¼Œå¯ä»¥ç‹¬ç«‹éªŒè¯æ–°åŒºå—å’Œäº¤æ˜“ï¼›
- **è½»èŠ‚ç‚¹ï¼ˆlight nodeï¼‰**ï¼šåªä¿å­˜å°‘é‡æ•°æ®å’ŒåŒºå—å¤´ï¼Œéœ€è¦å‘å…¶ä»–èŠ‚ç‚¹è¯·æ±‚è¯¦ç»†ä¿¡æ¯ï¼›
- **å½’æ¡£èŠ‚ç‚¹ï¼ˆarchive nodeï¼‰**ï¼šä¸ä»…ä¿å­˜å½“å‰çŠ¶æ€ï¼Œè¿˜ä¿å­˜æ‰€æœ‰å†å²çŠ¶æ€ï¼Œæ–¹ä¾¿åšå†å²æŸ¥è¯¢å’Œåˆ†æï¼Œä½†èµ„æºæ¶ˆè€—å¾ˆå¤§ã€‚

èŠ‚ç‚¹ä¹‹é—´é€šè¿‡ P2P ç½‘ç»œäº’è¿ï¼Œäº’ç›¸è½¬å‘æ–°åŒºå—ã€äº¤æ˜“ï¼Œå¹¶è¿›è¡ŒéªŒè¯ï¼Œä»¥ä¿è¯ç½‘ç»œæ•´ä½“çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§ã€‚

> ä½¿ç”¨æƒ…æ™¯ï¼š ä½ åœ¨é’±åŒ…é‡Œå‘èµ·ä¸€ç¬”è½¬è´¦äº¤æ˜“.
> äº¤æ˜“ä»é’±åŒ…å‘å‡ºä¹‹åï¼Œä¼šå…ˆå‘é€ç»™ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹å†å‘ç½‘ç»œæ‰©æ•£ã€‚æœ€ç»ˆï¼Œæœ‰çŸ¿å·¥/éªŒè¯äººèŠ‚ç‚¹æŠŠå®ƒæ‰“åŒ…è¿›åŒºå—ï¼Œä½ çš„äº¤æ˜“æ‰çœŸæ­£â€œä¸Šé“¾â€ã€‚

###### 3. RPCï¼šç»™å¤–éƒ¨ç¨‹åºç”¨çš„è®¿é—®æ¥å£

RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ˜¯èŠ‚ç‚¹å‘å¤–æš´éœ²çš„ä¸€ç»„æ ‡å‡†æ¥å£ï¼Œç”¨æ¥**è®©å…¶ä»–ç¨‹åºæŸ¥è¯¢æˆ–æäº¤æ•°æ®**ï¼Œå¸¸è§æ˜¯ HTTP RPC æˆ– WebSocket RPCã€‚

é€šè¿‡ RPCï¼Œä½ å¯ä»¥ï¼š

- æŸ¥è¯¢è´¦æˆ·ä½™é¢ã€äº¤æ˜“ã€åŒºå—ç­‰ä¿¡æ¯
- è°ƒç”¨åˆçº¦çš„åªè¯»æ–¹æ³•ï¼ˆ`eth_call`ï¼‰
- å¹¿æ’­ä¸€ç¬”ç­¾åå¥½çš„äº¤æ˜“ï¼ˆ`eth_sendRawTransaction`ï¼‰

RPC çš„å¥½å¤„æ˜¯ï¼šä½ ä¸éœ€è¦åœ¨è‡ªå·±çš„ç¨‹åºé‡Œå®ç°åº•å±‚ç½‘ç»œåè®®ï¼Œåªè¦æŒ‰ JSON-RPC çš„æ ¼å¼å‘ HTTP è¯·æ±‚å³å¯ã€‚

> ä½¿ç”¨æƒ…æ™¯ï¼š  
> ä½ å†™äº†ä¸€ä¸ªåŒºå—æµè§ˆå™¨ç½‘ç«™ï¼Œå‰ç«¯/åç«¯æœåŠ¡ä¸ä¼šç›´æ¥è·‘ä¸€ä¸ªå…¨èŠ‚ç‚¹ï¼Œè€Œæ˜¯é€šè¿‡ RPC é—®æŸä¸ªèŠ‚ç‚¹ï¼šâ€œç»™æˆ‘æŸä¸ªåŒºå—çš„è¯¦ç»†ä¿¡æ¯â€ã€â€œç»™æˆ‘è¿™ä¸ªè´¦æˆ·çš„æœ€è¿‘äº¤æ˜“â€ã€‚

---

##### Gethï¼šæœ€ä¸»æµçš„ä»¥å¤ªåŠå®¢æˆ·ç«¯ä¹‹ä¸€

Gethï¼ˆGo Ethereumï¼‰æ˜¯ç”¨ Go è¯­è¨€å®ç°çš„ä»¥å¤ªåŠå®¢æˆ·ç«¯ï¼Œä¹Ÿæ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„å®ç°ä¹‹ä¸€ã€‚å®ƒä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼š

###### 1. å‘½ä»¤è¡Œç¨‹åº `geth`

å®‰è£… Geth åï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªåä¸º `geth` çš„å‘½ä»¤è¡Œå·¥å…·ã€‚è¿è¡Œå®ƒå¯ä»¥ï¼š

- å¯åŠ¨ä¸€ä¸ªä»¥å¤ªåŠèŠ‚ç‚¹ï¼ˆå…¨èŠ‚ç‚¹ / è½»èŠ‚ç‚¹ç­‰ï¼‰
- åŒæ­¥ä¸»ç½‘ã€æµ‹è¯•ç½‘ï¼ˆå¦‚ Sepoliaï¼‰çš„æ•°æ®
- ç®¡ç†æœ¬åœ°è´¦æˆ·ï¼ˆåˆ›å»ºã€å¯¼å‡ºã€ç­¾åï¼‰
- å¯¹å¤–æä¾› HTTP / WebSocket RPC æ¥å£

ä¾‹å¦‚ï¼š

```bash
geth --sepolia --http --http.api eth,net,web3
```

è¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ªè¿åˆ° Sepolia æµ‹è¯•ç½‘çš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨æœ¬åœ°å¼€ä¸€ä¸ª HTTP RPC æ¥å£ï¼Œä¾›ä½ æˆ–å…¶ä»–ç¨‹åºæ¥æŸ¥è¯¢é“¾ä¸Šæ•°æ®ã€‚

> ä½¿ç”¨æƒ…æ™¯ï¼š  
> å¦‚æœä½ è¦è‡ªå·±æ­ä¸€ä¸ªâ€œç§æœ‰çš„ RPC èŠ‚ç‚¹â€åšæ•°æ®åˆ†æï¼Œå¯ä»¥åœ¨ä¸€å°äº‘æœåŠ¡å™¨ä¸Šè·‘ `geth`ï¼Œå¼€ HTTP RPCï¼Œç„¶åä½ çš„åˆ†æè„šæœ¬å°±å¯ä»¥è¿è¿™å°æœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯ç”¨å…¬å…± RPCã€‚

###### å…¬å…± RPC èŠ‚ç‚¹ vs ç§æœ‰ RPC èŠ‚ç‚¹

ä» Geth / å®¢æˆ·ç«¯åº“çš„è§†è§’çœ‹ï¼ŒåŒºåˆ«å°±æ˜¯ä½  `Dial` çš„ URL ä¸åŒï¼Œä½†åœ¨æƒé™å’Œæˆæœ¬ä¸Šå·®å¼‚å¾ˆå¤§ï¼š

- **å…¬å…± RPC**
  - ä¾‹å­ï¼šInfuraã€Alchemyã€å…¬å…±çš„ Sepolia RPC ç­‰ï¼›
  - ä¼˜ç‚¹ï¼šä¸ç”¨è‡ªå·±åŒæ­¥é“¾ã€é…ç½®ç®€å•ï¼Œé€‚åˆè¯¾ç¨‹ä½œä¸šã€demoã€å°å·¥å…·ï¼›
  - é™åˆ¶ï¼šæœ‰è°ƒç”¨é¢‘ç‡/é…é¢é™åˆ¶ï¼Œæœ‰äº›é«˜æˆæœ¬æ¥å£å¯èƒ½è¢«å…³æ‰ï¼ŒèŠ‚ç‚¹é…ç½®ä¸å¯æ§ã€‚

- **ç§æœ‰ RPC**
  - è‡ªå·±æˆ–å›¢é˜Ÿè¿è¡Œçš„ Geth / å…¶ä»–å®¢æˆ·ç«¯èŠ‚ç‚¹ï¼Œå¯¹å¤–å¼€ RPCï¼›
  - ä¼˜ç‚¹ï¼šå¯å®Œå…¨æ§åˆ¶èŠ‚ç‚¹ç±»å‹å’Œé…ç½®ã€æ— ç¬¬ä¸‰æ–¹é™æµã€è®¿é—®æ¨¡å¼ä¸æš´éœ²ç»™æœåŠ¡å•†ï¼›
  - æˆæœ¬ï¼šè¦è‡ªå·±æ‰¿æ‹…åŒæ­¥ã€å­˜å‚¨å’Œè¿ç»´ï¼Œé€‚åˆé•¿æœŸè¿è¡Œçš„æœåŠ¡ç«¯ã€äº¤æ˜“æ‰€ã€å¤§è§„æ¨¡æ•°æ®åˆ†æç­‰ã€‚

> ä½¿ç”¨æƒ…æ™¯ï¼š  
> - æœ¬è¯¾ç¨‹ / ä¸€èˆ¬ç»ƒä¹ ï¼šç›´æ¥è¿å…¬å…±çš„ Sepolia RPC å³å¯ï¼Œæ¯”å¦‚ï¼š`https://ethereum-sepolia-rpc.publicnode.com`ã€‚  
> - éœ€è¦æ‰«ä¸»ç½‘å¤§é‡å†å²æ•°æ®ã€æˆ–åšäº¤æ˜“æ‰€é’±åŒ…æœåŠ¡æ—¶ï¼Œæ›´å€¾å‘äºè‡ªå·±èµ·ä¸€ä¸ª Geth èŠ‚ç‚¹ï¼Œè·‘ç§æœ‰ RPCã€‚

###### 2. Go å®¢æˆ·ç«¯åº“ï¼ˆ`go-ethereum`ï¼‰

é™¤äº†å‘½ä»¤è¡Œå·¥å…·ï¼ŒGeth è¿˜æä¾›äº†ä¸€å¥— Go å®¢æˆ·ç«¯åº“ï¼Œæ–¹ä¾¿åœ¨ Go ä»£ç é‡Œå’Œä»¥å¤ªåŠäº¤äº’ã€‚å¸¸ç”¨çš„æ˜¯ `ethclient` åŒ…ï¼š

```go
import (
    "context"

    "github.com/ethereum/go-ethereum/ethclient"
)

func main() {
    // è¿æ¥å…¬å…± RPCï¼ˆé»˜è®¤ç”¨æ³•ï¼‰
    client, err := ethclient.Dial("https://ethereum-sepolia-rpc.publicnode.com")
    // ä¹Ÿå¯ä»¥æ¢æˆä½ è‡ªå·±çš„ç§æœ‰ RPC èŠ‚ç‚¹
    // client, err := ethclient.Dial("http://your-server-ip:8545")

    if err != nil {
        panic(err)
    }
    defer client.Close()

    // åé¢å¯ä»¥ç”¨ client æŸ¥è¯¢åŒºå—ã€äº¤æ˜“ã€ä½™é¢ç­‰
}
```

åœ¨æœ¬å‘¨ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬ä¸è‡ªå·±è¿è¡Œ Geth èŠ‚ç‚¹ï¼Œè€Œæ˜¯ä¾§é‡ä½¿ç”¨ **Go å®¢æˆ·ç«¯åº“ + å…¬å…± Sepolia RPC** æ¥è¯»å–é“¾ä¸Šæ•°æ®ï¼Œå¹¶ç†è§£ block / transaction / receipt çš„ç»“æ„ã€‚
<br>

è¿™ä¸ªé¡¹ç›®ä¸éœ€è¦å®‰è£… gethï¼Œåªéœ€è¦åœ¨é¡¹ç›®é‡Œå¼•å…¥ go-ethereum è¿™ä¸ª Go åº“ï¼ˆä¹Ÿå°±æ˜¯ Geth çš„ Go SDKï¼‰ã€‚

ä½†æ˜¯ä¸ºäº†å­¦ä¹ ï¼Œæˆ‘è¿˜æ˜¯å¯ä»¥å®‰è£…ä¸€ä¸‹ã€‚

Official website: https://geth.ethereum.org 

Just download it and install it.

æ˜¾ç¤º `PATH not updated, original length 1842 > 1024`

è¿™ä¸ªæŠ¥é”™å¸¸è§åŸå› æ˜¯ï¼šä¸€äº› Windows å®‰è£…å™¨ç”¨ NSIS å†™çš„ï¼Œæ›´æ–° PATH æ—¶æœ‰ å­—ç¬¦ä¸²é•¿åº¦ä¸Šé™ï¼ˆ1024ï¼‰ï¼Œä½ çš„ PATH å·²ç» 1842ï¼Œæ‰€ä»¥å®ƒç›´æ¥æ”¾å¼ƒæ›´æ–°ã€‚ 

ä½ è¦åšçš„å°±æ˜¯ æ‰‹åŠ¨æŠŠ geth.exe æ‰€åœ¨æ–‡ä»¶å¤¹åŠ åˆ° PATHï¼ˆæ¨èåŠ åˆ°â€œç”¨æˆ· Pathâ€ï¼Œä¸ä¼šå½±å“å…¨å±€ï¼‰ï¼š

1. æ‰¾åˆ° geth.exe çš„å®‰è£…ç›®å½•ï¼ˆä¾‹å¦‚ C:\Program Files\Geth\ æˆ–ä½ è‡ªå·±é€‰çš„ç›®å½•ï¼‰
2. Windowsï¼šå¼€å§‹èœå•æœç´¢ â€œç¯å¢ƒå˜é‡â€ â†’ æ‰“å¼€ â€œç¼–è¾‘ç³»ç»Ÿç¯å¢ƒå˜é‡â€
3. ç‚¹ â€œç¯å¢ƒå˜é‡â€¦â€ â†’ åœ¨ ç”¨æˆ·å˜é‡ é‡Œé€‰ Path â†’ ç¼–è¾‘ â†’ æ–°å»º â†’ ç²˜è´´ geth æ‰€åœ¨ç›®å½• â†’ ä¸€è·¯ç¡®å®š
4. å…³é—­å¹¶é‡æ–°æ‰“å¼€ PowerShell/cmdï¼Œç„¶åè¿è¡Œï¼š
```shell
where geth
geth version
```
æˆåŠŸå®‰è£…ã€‚

---

### 2025.12.17

#### Week 3 Part II - Go è¯­è¨€ç¯å¢ƒå‡†å¤‡

*æœ¬å‘¨éœ€è¦ç”¨ Go ç¼–å†™ä¸èŠ‚ç‚¹äº¤äº’çš„ç®€å•ç¨‹åºã€‚æœ¬èŠ‚åªä»‹ç»å®Œæˆæœ¬è¯¾æ‰€éœ€çš„**æœ€å°çŸ¥è¯†**ã€‚*

Goï¼ˆGolangï¼‰æ˜¯ Google å¼€å‘çš„ä¸€é—¨é™æ€å¼ºç±»å‹è¯­è¨€ï¼Œè¯­æ³•ç›¸å¯¹ç®€æ´ï¼Œå†…ç½®å¹¶å‘æ”¯æŒã€‚Geth æœ¬èº«å°±æ˜¯ç”¨ Go å†™çš„ï¼Œå› æ­¤å®˜æ–¹æä¾›çš„ä»¥å¤ªåŠå®¢æˆ·ç«¯åº“ä¹Ÿæ˜¯ç”¨ Go å®ç°çš„ã€‚ä½ åªéœ€è¦ä¼šï¼š

- å®‰è£… Go å¹¶èƒ½åœ¨å‘½ä»¤è¡Œè¿è¡Œ `go`ï¼›
- æ–°å»ºä¸€ä¸ªæœ€ç®€å•çš„ Go é¡¹ç›®ï¼›
- çŸ¥é“å¦‚ä½• `import` å…¶ä»–åº“ï¼Œå¹¶è°ƒç”¨å®ƒä»¬æä¾›çš„å‡½æ•°ã€‚

å…³äº Go çš„è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒï¼š

+ A Tour of Go https://go.dev/tour/list
+ ä¸­æ–‡ç‰ˆ https://tour.go-zh.org/list

##### 1. å®‰è£… Go

å®˜æ–¹ä¸‹è½½ï¼šhttps://go.dev/dl/

æŒ‰ç³»ç»Ÿæç¤ºå®‰è£…å®Œæˆåï¼Œåœ¨å‘½ä»¤è¡Œï¼ˆPowerShell / cmdï¼‰æ£€æŸ¥ï¼š

```bash
go version
```

å¦‚æœèƒ½çœ‹åˆ°ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ `go version go1.22.3 windows/amd64`ï¼‰ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚

å¾—åˆ° `go version go1.25.5 windows/amd64`

> å°æç¤ºï¼š  
> åç»­æ‰€æœ‰ `go xxx` å‘½ä»¤éƒ½æ˜¯åœ¨å‘½ä»¤è¡Œé‡Œæ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨ Go æºç æ–‡ä»¶é‡Œå†™ã€‚

##### 2. æ–°å»ºé¡¹ç›®

åœ¨ä½ å‡†å¤‡å­˜æ”¾æœ¬å‘¨ä»£ç çš„ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶åˆå§‹åŒ– Go æ¨¡å—ï¼š

```bash
mkdir week3-geth
cd week3-geth
go mod init week3-geth
```

`go mod init` ä¼šåˆ›å»ºä¸€ä¸ª `go.mod` æ–‡ä»¶ï¼Œè®°å½•å½“å‰é¡¹ç›®çš„æ¨¡å—åå’Œä¾èµ–ä¿¡æ¯ï¼Œåé¢ `go get` çš„ç¬¬ä¸‰æ–¹åº“éƒ½ä¼šå†™è¿›è¿™é‡Œã€‚

åˆ›å»º `main.go`ï¼š

```go
package main

import "fmt"

func main() {
    fmt.Println("hello go")
}
```

è¿è¡Œï¼š

```bash
go run main.go
```

å¦‚æœèƒ½åœ¨å‘½ä»¤è¡Œçœ‹åˆ°è¾“å‡º `hello go`ï¼Œè¯´æ˜ä½ çš„ Go ç¯å¢ƒå’Œé¡¹ç›®ç»“æ„æ˜¯æ­£å¸¸çš„ã€‚

ï¼ˆè¿è¡Œçš„æ—¶å€™ä¸€ç›´å¡ä½ï¼Œåé¢çªç„¶åˆå¥½äº†ï¼‰

> ä½ å¯ä»¥æŠŠåé¢æ‰€æœ‰ç¤ºä¾‹ä»£ç éƒ½æ”¾åœ¨è¿™ä¸ª `main.go` é‡Œï¼Œé€æ­¥æ›¿æ¢å’Œæ‰©å±•ã€‚

##### 3. å®‰è£… go-ethereum åº“

æœ¬è¯¾æ‰€æœ‰ä¸ä»¥å¤ªåŠäº¤äº’çš„èƒ½åŠ›ï¼Œéƒ½æ¥è‡ªå®˜æ–¹çš„ `go-ethereum` åº“ã€‚æˆ‘ä»¬ç”¨ `go get` æŠŠå®ƒåŠ å…¥å½“å‰é¡¹ç›®ä¾èµ–ï¼š

```bash
go get github.com/ethereum/go-ethereum
```

æ‰§è¡Œå®Œæˆåï¼Œä½ ä¼šåœ¨ `go.mod` / `go.sum` é‡Œçœ‹åˆ°ç›¸åº”è®°å½•ï¼›åœ¨ä»£ç é‡Œå°±å¯ä»¥è¿™æ ·å¼•ç”¨ï¼š

```go
import "github.com/ethereum/go-ethereum/ethclient"
```

> ä¸­å›½å¤§é™†è®¿é—® go-ethereum ä¾èµ–å¤±è´¥ï¼Œå¯è®¾ç½® Go ä»£ç†ï¼š
> - **Windows (PowerShell)ï¼š**
>   ```powershell
>   $env:GOPROXY="https://goproxy.cn,direct" # ä¸´æ—¶ä»£ç†, åœ¨åŒä¸€ç»ˆç«¯ä¼šè¯ç”Ÿæ•ˆ
>   ```
> - **Linux/macOS (bash/zsh)ï¼š**
>   ```bash
>   export GOPROXY=https://goproxy.cn,direct # ä¸´æ—¶ä»£ç†, åœ¨åŒä¸€ç»ˆç«¯ä¼šè¯ç”Ÿæ•ˆ
>   ```
>   è®¾ç½®åé‡æ–°æ‰§è¡Œ `go get` å‘½ä»¤å³å¯ã€‚

æœ¬è¯¾ç”¨åˆ°çš„ Go çŸ¥è¯†åŸºæœ¬åªæœ‰ï¼š

- `package main` / `func main()` å…¥å£å‡½æ•°ï¼›
- `import` å¼•å…¥æ ‡å‡†åº“å’Œç¬¬ä¸‰æ–¹åº“ï¼›
- åŸºæœ¬çš„å‡½æ•°è°ƒç”¨ã€é”™è¯¯å¤„ç†ï¼ˆ`if err != nil { ... }`ï¼‰ï¼›
- ä½¿ç”¨ `go-ethereum` æä¾›çš„ç±»å‹å’Œæ–¹æ³•ï¼ˆä¾‹å¦‚ `ethclient.Dial`ã€`HeaderByNumber` ç­‰ï¼‰ã€‚

å…¶ä½™è¯­æ³•å¦‚æœæš‚æ—¶ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥è¾¹æŸ¥è¾¹ç”¨ï¼Œä¸å½±å“å®Œæˆæœ¬å‘¨ä»»åŠ¡ã€‚

#### Week 3 Part III - ä½¿ç”¨ go-ethereum è¯»å–é“¾ä¸Šæ•°æ®

å¼•å…¥å®¢æˆ·ç«¯ï¼š

```go
import "github.com/ethereum/go-ethereum/ethclient"
```

è¿æ¥åˆ° Sepolia RPC

```go
client, err := ethclient.Dial("https://ethereum-sepolia-rpc.publicnode.com")
if err != nil {
    panic(err)
}
```

è·å–å½“å‰åŒºå—é«˜åº¦

```go
header, err := client.HeaderByNumber(context.Background(), nil)
fmt.Println("current block:", header.Number.String())
```

æŸ¥è¯¢åŒºå—

```go
blockNumber := big.NewInt(123456)
block, _ := client.BlockByNumber(context.Background(), blockNumber)

fmt.Println("hash:", block.Hash().Hex())
fmt.Println("parent:", block.ParentHash().Hex())
fmt.Println("tx count:", len(block.Transactions()))
```

æŸ¥è¯¢äº¤æ˜“ä¸å›æ‰§

```go
txHash := common.HexToHash("0xä½ çš„äº¤æ˜“å“ˆå¸Œ")
tx, _, _ := client.TransactionByHash(context.Background(), txHash)

fmt.Println("to:", tx.To())
fmt.Println("value:", tx.Value().String())
```

Receiptï¼š

```go
receipt, _ := client.TransactionReceipt(context.Background(), txHash)

fmt.Println("status:", receipt.Status)
fmt.Println("logs:", receipt.Logs)
```

åˆå¹¶åˆ°ä¸€èµ·çš„ä¸€ä¸ªæ ·ä¾‹ï¼Œè¯¥æ ·ä¾‹ä»…æ‰“å°äº†éƒ¨åˆ†å­—æ®µï¼Œå»ºè®®åŒå­¦ä»¬ä¿®æ”¹ä»£ç ï¼Œæ‰“å°å‡ºå®Œæ•´çš„ç»“æ„: 

å‚è€ƒå®Œæ•´ä»£ç æ–‡ä»¶ï¼š[main.go](./week3-geth/main.go)

```go
package main

import (
	"context"
	"fmt"
	"log"
	"math/big" 
	// go æ ‡å‡†åº“

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/ethclient" // å¦‚æœæç¤ºç¼ºå°‘ä¾èµ–, æŒ‰ç…§ç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯å®‰è£…å³å¯ï¼Œä½¿ç”¨ go get
)

func main() {
	ctx := context.Background()

	client, err := ethclient.Dial("https://ethereum-sepolia-rpc.publicnode.com")
	if err != nil {
		log.Fatal(err)
	}
	defer client.Close()

	header, err := client.HeaderByNumber(ctx, nil)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Current block: %s\n", header.Number.String())

	targetBlock := big.NewInt(123456)
	block, err := client.BlockByNumber(ctx, targetBlock)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Block #%s hash: %s\n", block.Number().String(), block.Hash().Hex())
	fmt.Printf("Parent hash: %s\n", block.ParentHash().Hex())
	fmt.Printf("Tx count: %d\n", len(block.Transactions()))
//==========================
	txHash := common.HexToHash("0x903bd6b44ce5cfa9269d456d2e7a10e3d8a485281c1c46631ec8f79e48f7accb") //æµ‹è¯•ç”¨äº¤æ˜“hash, ä½ å¯ä»¥æ›¿æ¢æˆä»»ä½•ä½ æƒ³æŸ¥è¯¢çš„äº¤æ˜“hash
//=========================
	tx, isPending, err := client.TransactionByHash(ctx, txHash)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Tx pending: %t\n", isPending)
	if to := tx.To(); to != nil {
		fmt.Printf("To: %s\n", to.Hex())
	} else {
		fmt.Println("To: contract creation")
	}
	fmt.Printf("Value (wei): %s\n", tx.Value().String())

	receipt, err := client.TransactionReceipt(ctx, txHash)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Receipt status: %d\n", receipt.Status)
	fmt.Printf("Logs: %d entries\n", len(receipt.Logs))
}
```

ç¤ºä¾‹ç»“æœ
```bash
Current block: 9750075
Block #123456 hash: 0x2056507046b07a5d7ed4f124a7febce2aec7295b464746523787b8c2acc627dc
Parent hash: 0x93bff867b68a2822ee7b6e0a4166cfdf5fc4782d60458fae1185de9b2ecdba16
Tx count: 0
Tx pending: false
To: 0x9Bd28675069f200961B50F13C476aDa5e7067C31
Value (wei): 0
Receipt status: 1
Logs: 2 entries
# å¦‚æœä¸€åˆ‡æ­£å¸¸, ä½ å°†ä¼šå¾—åˆ°ç±»ä¼¼äºä¸Šé¢çš„è¾“å‡ºç»“æœ
# ä½ å¯ä»¥ä¿®æ”¹ä»£ç æ‰“å°ä»»ä½•ä½ æƒ³æŸ¥è¯¢çš„æ•°æ®å’Œæ•°æ®ç»“æ„
```

æˆ‘çš„ç»“æœ
```bash
Current block: 9854809
Block #123456 hash: 0x2056507046b07a5d7ed4f124a7febce2aec7295b464746523787b8c2acc627dc
Parent hash: 0x93bff867b68a2822ee7b6e0a4166cfdf5fc4782d60458fae1185de9b2ecdba16
Tx count: 0
Tx pending: false
To: 0x9Bd28675069f200961B50F13C476aDa5e7067C31
Value (wei): 0
Receipt status: 1
Logs: 2 entries
```

#### Week 3 Follow Up - ç†è§£ block, transaction, receipt çš„ç»“æ„

ä¸Šä¸€èŠ‚ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šåŒ…å«å¤§é‡å­—æ®µã€‚æœ¬éƒ¨åˆ†ä»»åŠ¡è¦æ±‚ç†è§£å…¶ä¸­å…³é”®å­—æ®µçš„å«ä¹‰ã€‚

å…³äº Block å»ºè®®ç†è§£çš„å­—æ®µåŒ…æ‹¬ï¼š

- ä»¥å¤ªåŠé‡Œä¸€ä¸ª block å¯ä»¥ç†è§£æˆï¼šHeaderï¼ˆå¤´ï¼‰ + Bodyï¼ˆä½“ï¼‰
  - Headerï¼šæè¿°è¿™ä¸ªåŒºå—â€œæ˜¯è°ã€ä»€ä¹ˆæ—¶å€™ã€æ¥åœ¨è°åé¢ã€å…è®¸æ¶ˆè€—å¤šå°‘ gasâ€ç­‰å…ƒä¿¡æ¯
  - Bodyï¼šä¸»è¦å°±æ˜¯ transactionsï¼ˆäº¤æ˜“åˆ—è¡¨ï¼‰ä»¥åŠå”å—ç­‰ï¼ˆç°åœ¨ PoS è¯­å¢ƒä¸‹æ¦‚å¿µç•¥å˜ï¼Œä½†ä½ ç”¨ go-ethereum è¯»åˆ°çš„ç»“æ„ä»æ˜¯ç±»ä¼¼ç»„ç»‡ï¼‰
- number
  - åŒºå—é«˜åº¦ï¼Œä» 0 å¼€å§‹é€’å¢ã€‚
  - ç”¨å®ƒå¯ä»¥å®šä½åŒºå—åºåˆ—ä½ç½®ï¼Œä½†ä¸å…·å¤‡æŠ—ç¯¡æ”¹æ€§ï¼ˆçœŸæ­£æŠ—ç¯¡æ”¹é  hash é“¾æ¥ï¼‰ã€‚
- hash
  - åŒºå—å¤´ï¼ˆheaderï¼‰å†…å®¹å“ˆå¸Œåçš„ç»“æœï¼ˆç®€åŒ–ç†è§£å³å¯ï¼‰ã€‚
  - åªè¦ header ä»»ä¸€å…³é”®å­—æ®µå˜åŒ–ï¼ˆå¦‚ timestampã€parentHashã€stateRootã€transactionsRootâ€¦ï¼‰ï¼Œhash å°±ä¼šå˜åŒ–ã€‚
- parent Hash
  - ä¸Šä¸€ä¸ªåŒºå—çš„ hashã€‚
  - å®¢æˆ·ç«¯ç”¨å®ƒæŠŠåŒºå—è¿æˆâ€œä»åˆ›ä¸–å—å¼€å§‹çš„ä¸€æ¡é“¾â€ã€‚
- timestamp
  - å‡ºå—æ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰ã€‚
  - æ³¨æ„å®ƒä¸æ˜¯â€œç»å¯¹å¯ä¿¡çš„å¢™é’Ÿæ—¶é—´â€ï¼Œåè®®åªè¦æ±‚æ»¡è¶³ä¸€äº›çº¦æŸï¼ˆä¾‹å¦‚å¿…é¡»å¤§äºçˆ¶å—æ—¶é—´æˆ³ç­‰ï¼‰ï¼Œæ‰€ä»¥æ›´é€‚åˆç”¨ä½œâ€œé“¾ä¸Šæ—¶é—´è¿‘ä¼¼â€ã€‚
- gasUsed / gasLimit
  - gasLimitï¼ˆåŒºå—çº§ï¼‰ï¼šè¿™ä¸ªåŒºå— æœ€å¤šå…è®¸æ¶ˆè€—çš„æ€» gas ä¸Šé™ï¼ˆæ‰€æœ‰äº¤æ˜“çš„ gas æ¶ˆè€—åŠ èµ·æ¥ä¸èƒ½è¶…è¿‡å®ƒï¼‰ã€‚
  - gasUsedï¼ˆåŒºå—çº§ï¼‰ï¼šè¿™ä¸ªåŒºå— å®é™…æ¶ˆè€—çš„ gas æ€»é‡ã€‚
  - ç›´è§‚ç†è§£ï¼šgasLimit å†³å®šäº†ä¸€ä¸ªåŒºå—æœ€å¤šèƒ½å¡å¤šå°‘è®¡ç®—/å¤šå°‘äº¤æ˜“ï¼ŒgasUsed åˆ™æ˜¯â€œå®é™…å¡äº†å¤šå°‘â€ã€‚
- transactions
  - åŒºå—ä¸­äº¤æ˜“åˆ—è¡¨ï¼ˆæ¯ç¬”äº¤æ˜“è‡³å°‘åŒ…å« from/to/value/data/gas/gasPrice æˆ– EIP-1559 å­—æ®µç­‰ï¼‰ã€‚
  - ä½ è¿™å„¿ Tx count: 0 è¡¨ç¤ºè¯¥åŒºå—æ²¡æœ‰äº¤æ˜“ï¼Œæ‰€ä»¥â€œåŒºå—ä½“â€é‡Œäº¤æ˜“æ•°ç»„ä¸ºç©ºã€‚

Transactionï¼ˆäº¤æ˜“ï¼‰ vs Receiptï¼ˆå›æ‰§ï¼‰
Transaction å¸¸è§å…³é”®å­—æ®µï¼ˆä½ è¾“å‡ºé‡Œå‡ºç°äº† Toã€Valueã€pending ç­‰ï¼‰
- toï¼šæ¥æ”¶æ–¹åœ°å€
  - è‹¥æ˜¯ åˆçº¦åˆ›å»ºäº¤æ˜“ï¼što == nilï¼ˆæˆ–æ˜¾ç¤ºä¸ºç©ºï¼‰ï¼Œæ–°åˆçº¦åœ°å€ä¼šåœ¨ receipt é‡Œç»™ä½ ï¼ˆcontractAddressï¼‰ã€‚
- valueï¼šè½¬è´¦ ETH æ•°é‡ï¼ˆå•ä½ weiï¼‰ã€‚ä½ è¿™é‡Œ Value (wei): 0 è¡¨ç¤ºè¿™ç¬”äº¤æ˜“æ²¡æœ‰è½¬ ETHï¼ˆä½†ä»å¯èƒ½åœ¨è°ƒç”¨åˆçº¦ã€å†™çŠ¶æ€ï¼‰ã€‚
- dataï¼šè°ƒç”¨åˆçº¦çš„ calldataï¼ˆABI ç¼–ç åï¼‰ã€‚
- gasï¼ˆäº¤æ˜“çº§ä¸Šé™ï¼‰ï¼šå‘é€æ–¹æ„¿æ„ä¸ºè¿™ç¬”äº¤æ˜“æœ€å¤šæä¾›å¤šå°‘ gasï¼ˆæ³¨æ„è¿™å’ŒåŒºå—çš„ gasLimit ä¸ä¸€æ ·ï¼‰ã€‚
- pendingï¼šæ˜¯å¦è¿˜åœ¨ mempool æœªè¢«æ‰“åŒ…ã€‚ä½ è¿™é‡Œ Tx pending: false è¡¨ç¤ºå·²ä¸Šé“¾ï¼ˆæˆ–è‡³å°‘èŠ‚ç‚¹è®¤ä¸ºä¸åœ¨ pending çŠ¶æ€ï¼‰ã€‚

Receiptï¼ˆå›æ‰§ï¼‰å…³é”®å­—æ®µï¼ˆä½ è¾“å‡ºé‡Œå‡ºç°äº† Receipt statusã€Logsï¼‰
- statusï¼šæ‰§è¡Œæ˜¯å¦æˆåŠŸ
  - 1 æˆåŠŸï¼Œ0 å¤±è´¥ï¼ˆå¤±è´¥é€šå¸¸æ„å‘³ç€ revert æˆ–å¼‚å¸¸ï¼‰ã€‚ä½ è¿™é‡Œ Receipt status: 1ã€‚
- logsï¼šäº‹ä»¶æ—¥å¿—æ•°ç»„ï¼ˆåˆçº¦ emit Event(...) äº§ç”Ÿï¼‰
  - ä½ è¿™é‡Œ Logs: 2 entries è¡¨ç¤ºè¿™ç¬”äº¤æ˜“æ‰§è¡Œè¿‡ç¨‹ä¸­å‘å‡ºäº† 2 æ¡äº‹ä»¶æ—¥å¿—ã€‚
- å¸¸è§ä½†ä½ æ²¡æ‰“å°çš„è¿˜æœ‰ï¼šgasUsedï¼ˆäº¤æ˜“å®é™…æ¶ˆè€—ï¼‰ã€transactionIndexï¼ˆåœ¨åŒºå—ä¸­çš„ä½ç½®ï¼‰ã€blockHash/blockNumberï¼ˆæ‰€å±åŒºå—ï¼‰ç­‰ã€‚

Follow-Upï¼š

- ä¸ºä½• parent Hash èƒ½å½¢æˆåŒºå—é“¾ï¼Ÿ
  - æ ¸å¿ƒåŸå› ï¼šæ¯ä¸ªåŒºå—éƒ½æŠŠçˆ¶åŒºå—çš„ hash â€œå†™æ­»â€åœ¨è‡ªå·±çš„ header é‡Œã€‚
  - å‡è®¾æœ‰é“¾ ... -> B(n-1) -> B(n)ï¼Œå…¶ä¸­ B(n).parentHash = hash(B(n-1))
  - å¦‚æœæœ‰äººæƒ³ç¯¡æ”¹ B(n-1) çš„å†…å®¹ï¼ˆæ¯”å¦‚æ”¹äº¤æ˜“ï¼‰ï¼Œé‚£ä¹ˆ hash(B(n-1)) ä¼šå˜åŒ–
  - äºæ˜¯ B(n) é‡Œè®°å½•çš„ parentHash å°±ä¸åŒ¹é…äº†ï¼Œé“¾ä¼šæ–­æ‰
  æƒ³è®©é“¾é‡æ–°æ¥ä¸Šï¼Œå¿…é¡»åŒæ—¶é‡å†™ B(n)ã€B(n+1)â€¦ ç›´åˆ°æœ€æ–°å—ï¼Œå¹¶ä¸”è¿˜è¦åœ¨å…±è¯†è§„åˆ™ä¸‹â€œèµ¢è¿‡â€è¯šå®ç½‘ç»œï¼ˆPoW æ—¶ä»£æ˜¯ç®—åŠ›ï¼ŒPoS æ—¶ä»£æ˜¯æƒç›Š/æœ€ç»ˆæ€§ä¸éªŒè¯è€…æŠ•ç¥¨æœºåˆ¶ï¼‰
- gasLimit å¦‚ä½•å½±å“åˆçº¦æ‰§è¡Œ
  - äº¤æ˜“çº§ gas ä¸Šé™ï¼ˆtx.gas / gasLimitï¼‰ï¼šé™åˆ¶â€œè¿™ç¬”äº¤æ˜“æœ€å¤šèƒ½èŠ±å¤šå°‘ gasâ€
    - å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­ gas ä¸å¤Ÿï¼Œä¼š Out of Gasï¼ŒçŠ¶æ€å›æ»šï¼ˆä½†å·²æ¶ˆè€—çš„ gas ä»ä¼šä»˜è´¹ï¼‰ã€‚
    - æ‰€ä»¥ï¼šäº¤æ˜“å‘èµ·è€…è®¾å¾—å¤ªå°ï¼Œåˆçº¦å†æ­£ç¡®ä¹Ÿå¯èƒ½è·‘ä¸å®Œã€‚
  - åŒºå—çº§ gasLimitï¼ˆblock.gasLimitï¼‰ï¼šé™åˆ¶â€œä¸€ä¸ªåŒºå—å†…æ‰€æœ‰äº¤æ˜“åŠ èµ·æ¥æœ€å¤šèƒ½æ¶ˆè€—å¤šå°‘ gasâ€
    - çŸ¿å·¥/å‡ºå—è€…åœ¨æ‰“åŒ…äº¤æ˜“æ—¶ï¼Œä¸èƒ½è®©æ€» gasUsed è¶…è¿‡è¿™ä¸ªä¸Šé™ã€‚
    - æ‰€ä»¥ï¼šåŒºå— gasLimit è¶Šé«˜ï¼Œç†è®ºä¸Šæ¯ä¸ªåŒºå—èƒ½å®¹çº³çš„è®¡ç®—è¶Šå¤šï¼Œååæ›´é«˜ï¼›ä½†ä¹Ÿä¼šå¸¦æ¥æ›´å¤§çš„åŒºå—éªŒè¯/ä¼ æ’­å‹åŠ›ï¼ˆç½‘ç»œä¸èŠ‚ç‚¹æˆæœ¬ä¸Šå‡ï¼‰ï¼Œæ‰€ä»¥å®ƒæ˜¯æ€§èƒ½ä¸å»ä¸­å¿ƒåŒ–æˆæœ¬ä¹‹é—´çš„æƒè¡¡ç‚¹ã€‚
  - å¯¹â€œåˆçº¦æ‰§è¡Œâ€æœ€ç›´æ¥çš„å½±å“æ˜¯ï¼š
    - å•ç¬”åˆçº¦è°ƒç”¨èƒ½å¦å®Œæ•´æ‰§è¡Œï¼šä¸»è¦çœ‹äº¤æ˜“çº§ gas ä¸Šé™æ˜¯å¦è¶³å¤Ÿã€‚
    - ä½ çš„äº¤æ˜“èƒ½å¦å°½å¿«è¢«æ‰“åŒ…ï¼šè¿˜å—åŒºå—çº§ gasLimit + å½“å‰åŒºå—æ‹¥å µåº¦ + è´¹ç”¨æŠ¥ä»·å½±å“ã€‚
  


***

å…³äº Transcation å»ºè®®ç†è§£çš„å­—æ®µåŒ…æ‹¬ï¼š

- nonce
  - è´¦æˆ·å·²å‘é€äº¤æ˜“æ•°ï¼›é˜²é‡æ”¾å’Œæ’åº
- from / to
  - å‘èµ·æ–¹åœ°å€ï¼›to ä¸ºç©ºæˆ–ä¸å­˜åœ¨æ—¶æ˜¯åˆ›å»ºåˆçº¦äº¤æ˜“ï¼Œéç©ºæ˜¯è°ƒç”¨/è½¬è´¦ã€‚
- input (call data)
  - è°ƒç”¨æ•°æ®ã€‚è½¬è´¦é€šå¸¸ä¸ºç©ºï¼›åˆçº¦è°ƒç”¨åŒ…å«å‡½æ•°é€‰æ‹©å™¨å’Œå‚æ•°ç¼–ç ã€‚
- gas / gasPrice
  - gas æ˜¯æ„¿æ„æ¶ˆè€—çš„ä¸Šé™ï¼›gasPriceï¼ˆæˆ– EIP-1559 ä¸‹çš„ maxFeePerGas / maxPriorityFeePerGasï¼‰æ˜¯æ¯å•ä½ gas æ„¿æ”¯ä»˜çš„ä»·æ ¼ã€‚
- value
  - éšäº¤æ˜“é™„å¸¦çš„ ETH æ•°é‡ï¼ˆweiï¼‰
- type (legacy, EIP-1559)
  - 0 ä¸º legacyï¼›2 ä¸º EIP-1559ï¼ˆå¸¦ base fee + priority feeï¼‰ï¼›1 å¤šç”¨äºè®¿é—®åˆ—è¡¨ EIP-2930ã€‚

Follow-Upï¼š

- ä»€ä¹ˆæ˜¯ ABI ï¼Ÿä¸€ç¬”äº¤æ˜“æœ€ç»ˆæ‰§è¡Œé€»è¾‘æ˜¯å¦‚ä½•è§£æ input çš„
  - ï¼ˆApplication Binary Interfaceï¼‰ï¼šå®šä¹‰åˆçº¦å‡½æ•°ã€äº‹ä»¶çš„ç­¾åä¸å‚æ•°ç±»å‹çš„è§„èŒƒï¼Œå‘Šè¯‰å¤–ç•Œå¦‚ä½•ç¼–ç /è§£ç è°ƒç”¨æ•°æ®ä¸æ—¥å¿—ã€‚
  - è§£æ inputï¼šå‰ 4 å­—èŠ‚æ˜¯å‡½æ•°é€‰æ‹©å™¨ï¼ˆkeccak256("funcName(argTypes)") å‰ 4 å­—èŠ‚ï¼‰ï¼›åç»­å‚æ•°æŒ‰ ABI ç±»å‹ç¼–ç ï¼ˆå®šé•¿/åŠ¨æ€ã€åç§»ä¸é•¿åº¦ï¼‰ã€‚èŠ‚ç‚¹æˆ–åº“ï¼ˆethers.jsã€web3.jsã€viem ç­‰ï¼‰ç”¨ ABI æŠŠé€‰æ‹©å™¨åŒ¹é…åˆ°å‡½æ•°ï¼Œå†æŒ‰ ABI è§„åˆ™è§£ç å­—èŠ‚å¾—åˆ°äººç±»å¯è¯»çš„å‚æ•°ï¼Œéšå EVM æ‰§è¡Œå¯¹åº”å‡½æ•°é€»è¾‘ã€‚

***

å…³äº Receipt å»ºè®®ç†è§£çš„å­—æ®µåŒ…æ‹¬:

- status
  - å«ä¹‰ï¼šäº¤æ˜“æ‰§è¡Œçš„æœ€ç»ˆçŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆæˆ– 0/1ï¼‰
  - è§£é‡Šï¼š
    - 1 (Success): äº¤æ˜“æ‰§è¡ŒæˆåŠŸï¼ŒçŠ¶æ€æ”¹å˜å·²ç”Ÿæ•ˆã€‚
    - 0 (Failure/Revert): äº¤æ˜“æ‰§è¡Œå¤±è´¥ï¼ˆä¾‹å¦‚ require ä¸æ»¡è¶³ã€ Gas ä¸è¶³ç­‰ï¼‰ï¼Œæ‰€æœ‰çŠ¶æ€å˜æ›´ï¼ˆé™¤äº† Gas æ¶ˆè€—ï¼‰å…¨éƒ¨å›æ»šã€‚
  - é‡è¦æ€§ï¼šåˆ¤æ–­äº¤æ˜“æ˜¯å¦â€œçœŸæ­£â€å®Œæˆçš„æ ¸å¿ƒå­—æ®µã€‚ï¼ˆæ³¨æ„ï¼šäº¤æ˜“ä¸Šé“¾ä¸ä»£è¡¨äº¤æ˜“æˆåŠŸï¼Œå¿…é¡»çœ‹ Receipt çš„ statusï¼‰ã€‚
- logs
  - å«ä¹‰ï¼šäº¤æ˜“æ‰§è¡Œè¿‡ç¨‹ä¸­è§¦å‘çš„äº‹ä»¶ï¼ˆEventsï¼‰æ•°ç»„ã€‚
  - è§£é‡Šï¼šæ¯ä¸ªæ—¥å¿—åŒ…å« addressï¼ˆå‘å‡ºäº‹ä»¶çš„åˆçº¦ï¼‰ã€topicsï¼ˆç´¢å¼•ä¸»é¢˜ï¼Œtopic[0] é€šå¸¸æ˜¯äº‹ä»¶ç­¾åçš„å“ˆå¸Œï¼‰ã€dataï¼ˆéç´¢å¼•å‚æ•°æ•°æ®ï¼‰ã€‚
  - é‡è¦æ€§ï¼šè¿™æ˜¯é“¾ä¸Šä¸é“¾ä¸‹ï¼ˆå‰ç«¯ã€indexerã€The Graphï¼‰é€šä¿¡çš„ä¸»è¦æ–¹å¼ã€‚ä¾‹å¦‚è½¬è´¦çš„ Transfer äº‹ä»¶ã€Swap çš„ Swap äº‹ä»¶éƒ½åœ¨è¿™é‡Œã€‚
- contractAddress
  - å«ä¹‰ï¼šå¦‚æœè¯¥äº¤æ˜“æ˜¯â€œéƒ¨ç½²åˆçº¦â€äº¤æ˜“ï¼ˆå³ to å­—æ®µä¸ºç©ºï¼‰ï¼Œæ­¤å­—æ®µæ˜¾ç¤ºæ–°éƒ¨ç½²åˆçº¦çš„åœ°å€ã€‚
  - è§£é‡Šï¼šå¦‚æœæ˜¯æ™®é€šè°ƒç”¨äº¤æ˜“ï¼Œè¯¥å­—æ®µé€šå¸¸ä¸º nullã€‚
  - è®¡ç®—æ–¹å¼ï¼šé€šå¸¸ç”± keccak256(rlp([sender, nonce])) è®¡ç®—å¾—å‡ºï¼ˆå¯¹äº CREATE æ“ä½œï¼‰ï¼›å¦‚æœæ˜¯ CREATE2 æ“ä½œï¼Œåˆ™ä¸ salt å’Œ initCode æœ‰å…³ã€‚

***

å¯ä¾›å‚è€ƒçš„èµ„æ–™åŒ…æ‹¬ä½†ä¸é™äºï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œæ£€ç´¢ï¼š

+ https://www.bilibili.com/video/BV1Vt411X7JF
+ ä»¥å¤ªåŠæ–‡æ¡£é‡Œå…³äº Blocks çš„ä»‹ç»ï¼šhttps://ethereum.org/developers/docs/blocks/
+ https://ethereum.org/developers/docs/transactions/
+ https://www.geeksforgeeks.org/computer-networks/ethereum-block-structure/

### 2025.12.18

#### Week 4 Part1-Geth-Part I: Geth

##### ä¸Šå‘¨å›é¡¾:

###### I. Gethï¼šä»¥å¤ªåŠçš„ Go è¯­è¨€å®¢æˆ·ç«¯

**Geth**ï¼ˆGo-Ethereumï¼‰æ˜¯ç”¨ Go è¯­è¨€ç¼–å†™çš„ä»¥å¤ªåŠåè®®çš„å®˜æ–¹å®¢æˆ·ç«¯ã€‚

* **æ€§è´¨ï¼š** Geth æ˜¯æœ€ä¸»æµçš„**æ‰§è¡Œå®¢æˆ·ç«¯**ï¼Œè´Ÿè´£å¤„ç†äº¤æ˜“å’Œç»´æŠ¤åŒºå—é“¾çŠ¶æ€ã€‚
* **åŠŸèƒ½ï¼š** å®ƒè¿è¡Œä¸€ä¸ªä»¥å¤ªåŠ**èŠ‚ç‚¹**ï¼ˆå¦‚å…¨èŠ‚ç‚¹ï¼‰ï¼ŒåŒæ­¥æ•°æ®ï¼Œå¹¶æä¾› **JSON-RPC API** æ¥å£ï¼Œå…è®¸å¤–éƒ¨ç¨‹åºï¼ˆå¦‚æ‚¨ç”¨ Go ç¼–å†™çš„åˆ†æå·¥å…·ï¼‰è¿æ¥å¹¶æŸ¥è¯¢é“¾ä¸Šä¿¡æ¯ã€‚
    
---

###### II.  ä»¥å¤ªåŠæ ¸å¿ƒæ•°æ®ç»“æ„

ä»¥å¤ªåŠåŒºå—é“¾çš„ä¸‰å¤§æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š

| æ•°æ®ç»“æ„ | ä½œç”¨ | å…³é”®ç‚¹ |
| :--- | :--- | :--- |
| **Block (åŒºå—)** | å­˜å‚¨ä¸€ç»„å·²éªŒè¯çš„äº¤æ˜“ã€‚ | **`ParentHash`** å°†åŒºå—é¦–å°¾ç›¸è¿ï¼Œå½¢æˆä¸å¯ç¯¡æ”¹çš„é“¾ã€‚ |
| **Transaction (äº¤æ˜“)** | ç”¨æˆ·æäº¤çš„æ“ä½œæŒ‡ä»¤ï¼ˆè½¬è´¦ã€åˆçº¦è°ƒç”¨ï¼‰ã€‚ | **`Input`** å­—æ®µåŒ…å«åˆçº¦è°ƒç”¨çš„æŒ‡ä»¤å’Œå‚æ•°ï¼Œç”± **ABI** è§£æã€‚ |
| **Receipt (å›æ‰§)** | äº¤æ˜“æ‰§è¡Œåçš„ç»“æœè¯æ˜ã€‚ | **`Status`** (æˆåŠŸ/å¤±è´¥) å’Œ **`Logs`** (åˆçº¦å‘å‡ºçš„äº‹ä»¶æ•°æ®) æ˜¯æœ€é‡è¦çš„ä¿¡æ¯ã€‚ |

---

**ğŸ”¥ ä¸‹ä¸€æ­¥ï¼š** æˆ‘ä»¬å°†ä¸“æ³¨äº **Receipt ä¸­çš„ `Logs`**ï¼Œè¿™æ˜¯è·å–åˆçº¦äº‹ä»¶æ•°æ®çš„å…³é”®ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Geth çš„ Go å®¢æˆ·ç«¯è¿›è¡Œ**æ—¥å¿—è¿‡æ»¤**å’Œ**é«˜é€šé‡æ•°æ®æŸ¥è¯¢**ã€‚

##### å†…å®¹:

æœ¬éƒ¨åˆ†çš„æ ¸å¿ƒæ˜¯æŒæ¡å¦‚ä½•ä½¿ç”¨ **Go è¯­è¨€å®¢æˆ·ç«¯ï¼ˆgo-ethereum/ethclient)** é«˜æ•ˆã€ç¨³å®šåœ°æŸ¥è¯¢å’Œè®¢é˜…ä»¥å¤ªåŠæ•°æ®ã€‚

ğŸ¯ ç›®æ ‡: æŒæ¡ä½¿ç”¨ `ethclient` åº“è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š

1. **å†å²æ•°æ®æŸ¥è¯¢ï¼š** é€šè¿‡ `FilterLogs` é«˜æ•ˆè¿‡æ»¤å’Œåˆ†é¡µæŸ¥è¯¢å†å²åˆçº¦äº‹ä»¶ï¼ˆLogsï¼‰ã€‚

2. **å®æ—¶æ•°æ®ç›‘æ§ï¼š** ä½¿ç”¨ `SubscribeNewHead` å’Œ `SubscribePendingTransactions` å®æ—¶ç›‘å¬æ–°åŒºå—å’Œå¾…å¤„ç†äº¤æ˜“ã€‚

3. **é“¾ä¸ŠçŠ¶æ€è¯»å–ï¼š** ä½¿ç”¨ `CallContract` è¯»å–åˆçº¦çš„åªè¯»çŠ¶æ€ï¼Œå¹¶æ¢ç´¢å›æº¯åˆ°ä»»æ„å†å²çŠ¶æ€çš„èƒ½åŠ›ã€‚

##### I. FilterLogs

###### èƒŒæ™¯çŸ¥è¯†

EVM æ—¥å¿—ï¼ˆLogï¼‰æ˜¯æ™ºèƒ½åˆçº¦ä¸é“¾ä¸‹ä¸–ç•Œé€šä¿¡çš„æ¡¥æ¢ï¼Œæ˜¯åˆçº¦æ‰§è¡ŒæœŸé—´äº§ç”Ÿçš„åªè¯»æ•°æ®è®°å½•ï¼Œä¸»è¦ç”¨äºå‰ç«¯äº¤äº’ã€æ•°æ®ç´¢å¼•å’ŒçŠ¶æ€ç›‘æ§ã€‚

**1. Log æ ¸å¿ƒç»“æ„**

ä¸€ä¸ª EVM Log åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š

| å­—æ®µ | è¯´æ˜ | å…³é”®ç‰¹æ€§ |
| :--- | :--- | :--- |
| **Address** | è§¦å‘è¯¥æ—¥å¿—çš„åˆçº¦åœ°å€ | æ ‡è¯†äº‹ä»¶çš„æ¥æº |
| **Topics** | ç”¨äºç´¢å¼•çš„å­—æ®µæ•°ç»„ | æœ€å¤š 4 ä¸ªï¼Œæ¯ä¸ª 32 å­—èŠ‚ï¼Œç”¨äº Bloom Filter å¿«é€ŸæŸ¥æ‰¾ |
| **Data** | éç´¢å¼•çš„è´Ÿè½½æ•°æ® | åŒ…å«æ— æ³•ç›´æ¥æœç´¢çš„å…·ä½“æ•°å€¼ï¼ˆå¦‚è½¬è´¦é‡‘é¢ã€å¤æ‚ç»“æ„ä½“ï¼‰ |

**2. Topics è¯¦è§£**

**Topics** æ˜¯æ—¥å¿—ä¸­æœ€å…³é”®çš„éƒ¨åˆ†ï¼Œå†³å®šäº†å¦‚ä½•è¿‡æ»¤å’ŒæŸ¥æ‰¾äº‹ä»¶ã€‚

- **Topic 0 (äº‹ä»¶ç­¾å):**
  - å¿…å¡«é¡¹ï¼ˆåŒ¿åäº‹ä»¶é™¤å¤–ï¼‰ï¼Œç”¨äºæ ‡è¯†äº‹ä»¶ç±»å‹
  - è®¡ç®—å…¬å¼: $Topic_0 = Keccak\text{-}256(\text{"EventName(type1,type2,...)"})$
  - æ³¨æ„: ç­¾åå­—ç¬¦ä¸²ä¸­ä¸èƒ½åŒ…å«å‚æ•°åç§°ï¼Œä¸”å‚æ•°ç±»å‹é—´ä¸èƒ½æœ‰ç©ºæ ¼

- **Topic 1-3 (ç´¢å¼•å‚æ•°):**
  - å¯¹åº” Solidity ä¸­è¢«æ ‡è®°ä¸º `indexed` çš„å‚æ•°
  - ç”¨äºå¿«é€Ÿç­›é€‰ï¼ˆä¾‹å¦‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ A è½¬å‡ºçš„è®°å½•"ï¼‰

**ä»€ä¹ˆæ˜¯ Event Signatureï¼Ÿ**

**Event Signatureï¼ˆäº‹ä»¶ç­¾åï¼‰** æ˜¯äº‹ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨æ—¥å¿—ä¸­è¯†åˆ«ç‰¹å®šç±»å‹çš„äº‹ä»¶ã€‚

- **å®šä¹‰ï¼š** äº‹ä»¶ç­¾åå­—ç¬¦ä¸²æ ¼å¼ä¸º `EventName(type1,type2,...)`ï¼Œå…¶ä¸­åªåŒ…å«äº‹ä»¶åç§°å’Œå‚æ•°ç±»å‹ï¼Œä¸åŒ…å«å‚æ•°åç§°
- **è®¡ç®—ï¼š** å¯¹ç­¾åå­—ç¬¦ä¸²è¿›è¡Œ Keccak-256 å“ˆå¸Œï¼Œå¾—åˆ° 32 å­—èŠ‚çš„å“ˆå¸Œå€¼ï¼Œå­˜å‚¨åœ¨ Topic 0 ä¸­
- **ä½œç”¨ï¼š** é€šè¿‡åŒ¹é… Topic 0ï¼Œå¯ä»¥å¿«é€Ÿè¿‡æ»¤å‡ºç‰¹å®šç±»å‹çš„äº‹ä»¶ï¼ˆå¦‚æ‰€æœ‰ `Transfer` äº‹ä»¶ï¼‰

**ç¤ºä¾‹ï¼š**
- äº‹ä»¶å®šä¹‰: `event Transfer(address indexed from, address indexed to, uint256 value);`
- äº‹ä»¶ç­¾å: `Transfer(address,address,uint256)`
- Topic 0: `Keccak256("Transfer(address,address,uint256)")`

**3. ç¤ºä¾‹ï¼šERC-20 Transfer äº‹ä»¶**

ä»¥æ ‡å‡†çš„ ERC-20 `Transfer` äº‹ä»¶ä¸ºä¾‹ï¼š

```solidity
// æ³¨æ„ indexed å…³é”®å­—
event Transfer(address indexed from, address indexed to, uint256 value);
```

**æ‰§è¡Œåœºæ™¯ï¼š** ç”¨æˆ· A å‘ç”¨æˆ· B è½¬è´¦ 100 ä»£å¸ï¼Œåˆçº¦æ‰§è¡Œ `emit Transfer(A, B, 100);`

**ç”Ÿæˆçš„ Log ç»“æ„ï¼š**

| å­—æ®µ | å€¼ | è¯´æ˜ |
| :--- | :--- | :--- |
| **Topic 0** | `Keccak256("Transfer(address,address,uint256)")` | äº‹ä»¶ç­¾åå“ˆå¸Œ |
| **Topic 1** | `0x000...ç”¨æˆ·Aåœ°å€` (32 å­—èŠ‚) | ç¬¬ä¸€ä¸ª `indexed` å‚æ•° (from) |
| **Topic 2** | `0x000...ç”¨æˆ·Båœ°å€` (32 å­—èŠ‚) | ç¬¬äºŒä¸ª `indexed` å‚æ•° (to) |
| **Data** | `100` (åå…­è¿›åˆ¶) | æœªæ ‡è®° `indexed` çš„å‚æ•° (value) |

**ç‰¹ç‚¹ï¼š** Data å­—æ®µå­˜å‚¨æ›´ä¾¿å®œï¼Œä½†æ— æ³•ç›´æ¥é€šè¿‡ä»¥å¤ªåŠèŠ‚ç‚¹ API è¿›è¡Œæ¡ä»¶è¿‡æ»¤ã€‚

**4. Log çš„å­˜å‚¨ç‰¹æ€§ä¸åº”ç”¨**

- **Gas ç»æµå­¦ï¼š**
  - **Storage:** æ°¸ä¹…å­˜å‚¨åœ¨çŠ¶æ€æ ‘ä¸­ï¼Œæ‰€æœ‰åˆçº¦å¯è§ï¼Œè¯»å†™æ˜‚è´µ
  - **Log:** å­˜å‚¨åœ¨äº¤æ˜“æ”¶æ®ä¸­ï¼Œåˆçº¦æ— æ³•è¯»å–ï¼ŒGas è´¹ç”¨è¿œä½äº Storage

- **åº”ç”¨åœºæ™¯ï¼š**
  - **å‰ç«¯å“åº”:** MetaMask ç­‰é’±åŒ…ç›‘å¬ Log æ›´æ–°ä½™é¢
  - **æ•°æ®ç´¢å¼•:** The Graph/Dune é€šè¿‡ Topic è¿‡æ»¤æ„å»ºå†å²æ•°æ®åº“
  - **é“¾ä¸‹è§¦å‘å™¨:** ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€æ”¶åˆ° Log åè‡ªåŠ¨å…¥è´¦

**åº•å±‚çš„ eth_call æ˜¯ä»€ä¹ˆï¼Ÿ**

**`eth_call`** æ˜¯ä»¥å¤ªåŠå®¢æˆ·ç«¯ï¼ˆå¦‚ Gethï¼‰ç”¨äºè¿›è¡Œ"åªè¯»æŸ¥è¯¢"çš„æ ¸å¿ƒ JSON-RPC æ–¹æ³•ã€‚

- **åŠŸèƒ½ï¼š** æ¨¡æ‹Ÿæ‰§è¡Œåˆçº¦çš„å‡½æ•°è°ƒç”¨ï¼ˆä¸»è¦æ˜¯è¯»å–çŠ¶æ€çš„å‡½æ•°ï¼‰ï¼Œè·å–é“¾ä¸Šæ•°æ®
- **ç‰¹ç‚¹ï¼š**
  - **ä¸å‘é€äº¤æ˜“**ï¼Œä¸æ¶ˆè€— Gas
  - **ä¸æ”¹å˜**åŒºå—é“¾çŠ¶æ€
  - å¯ä»¥æŸ¥è¯¢**å†å²åŒºå—çŠ¶æ€**ï¼ˆé€šè¿‡æŒ‡å®š block number å‚æ•°ï¼‰
- **åº”ç”¨ï¼š** 
  - é¢„å…ˆéªŒè¯äº¤æ˜“æ˜¯å¦ä¼šæˆåŠŸ
  - è¯»å–åˆçº¦çš„åªè¯»çŠ¶æ€
  - å¯¹ä»»æ„å†å²çŠ¶æ€è¿›è¡Œ"æ—¶é—´æ—…è¡Œ"å¼æŸ¥è¯¢

**æ³¨æ„ï¼š** `FilterLogs` åº•å±‚é€šè¿‡ `eth_getLogs` RPC æ–¹æ³•å®ç°ï¼Œè€Œ `CallContract` åˆ™ä½¿ç”¨ `eth_call` æ–¹æ³•ã€‚

###### åŸºç¡€å®ç°

é€šè¿‡åˆçº¦åœ°å€å’Œ Event Signature è¿‡æ»¤æ—¥å¿—çš„å®Œæ•´å®ç°ä»£ç è¯·å‚è€ƒï¼š[log_filter.go](./week4/Part1-Geth/log_filter.go)

è¯¥ä»£ç å®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **ä»£ç†é…ç½®ï¼š** é…ç½® HTTP ä»£ç†ä»¥è®¿é—® Infura RPC æœåŠ¡
2. **RPC è¿æ¥ï¼š** ä½¿ç”¨è‡ªå®šä¹‰ HTTP å®¢æˆ·ç«¯è¿æ¥åˆ°ä»¥å¤ªåŠèŠ‚ç‚¹
3. **äº‹ä»¶ç­¾åè®¡ç®—ï¼š** è®¡ç®— `Transfer(address,address,uint256)` äº‹ä»¶çš„ç­¾åå“ˆå¸Œï¼ˆTopic 0ï¼‰
4. **æ—¥å¿—è¿‡æ»¤ï¼š** ä½¿ç”¨ `FilterLogs` æ–¹æ³•æŸ¥è¯¢æŒ‡å®šåˆçº¦åœ°å€å’Œäº‹ä»¶ç­¾åçš„å†å²æ—¥å¿—

###### ä½¿ç”¨è¯´æ˜

**å‰ç½®æ¡ä»¶ï¼š**

1. **è·å– Infura API Keyï¼š**
   - è®¿é—® [MetaMask Developer](https://developer.metamask.io/) æ³¨å†Œè´¦å·
   - åˆ›å»ºæ–°é¡¹ç›®ï¼Œé€‰æ‹© Ethereum ç½‘ç»œ
   - å¤åˆ¶ API Keyï¼ˆæ ¼å¼ï¼š`https://mainnet.infura.io/v3/YOUR_API_KEY`ï¼‰
   - åœ¨ä»£ç æ–‡ä»¶ [log_filter.go](./log_filter.go) ä¸­æ›¿æ¢ `InfuraURL` å¸¸é‡

å¾—åˆ°äº†
![alt text](md_assets/LuBryant/image-3.png)

2. **é…ç½®ä»£ç†ï¼ˆä¸­å›½å¤§é™†ç”¨æˆ·ï¼‰ï¼š**
   - ä»£ç ä¸­å·²é…ç½®ä»£ç†æ”¯æŒï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ `PROXY_PORT` å¸¸é‡
   - å¸¸è§ä»£ç†ç«¯å£ï¼š
     - Clash: 7890 (HTTP), 7891 (SOCKS5)
     - V2Ray: 10808 (HTTP), 10809 (SOCKS5)
     - Shadowsocks: 1080 (SOCKS5)
   - ä¸ºä¿è¯å¯ä»¥é¡ºåˆ©è¿æ¥, è¯·å°½é‡æ‰“å¼€**å…¨å±€ä»£ç†**æ¨¡å¼

**ç¯å¢ƒé…ç½®ï¼š**

- åˆå§‹åŒ–ä¾èµ–ï¼šè¿è¡Œ `go mod tidy` è‡ªåŠ¨å®‰è£…æ‰€éœ€åŒ…
- å¦‚é‡ Go åŒ…å®‰è£…é—®é¢˜ï¼ˆWindowsï¼‰ï¼Œè®¾ç½®ä»£ç†ï¼š`$env:GOPROXY="https://goproxy.cn,direct"`
- è¿è¡Œä»£ç ï¼š`go run log_filter.go`

**ä»£ç å®ç°è¯´æ˜ï¼š**

å‚è€ƒ [log_filter.go](./log_filter.go) ä¸­çš„å®ç°ï¼Œè¯¥ä»£ç å®ç°äº†**æ ¹æ®åˆçº¦åœ°å€å’Œäº‹ä»¶ç­¾åè¿‡æ»¤å†å²æ—¥å¿—**çš„åŠŸèƒ½ï¼š

1. **åœ°å€è¿‡æ»¤ï¼š** é€šè¿‡ `Addresses: []common.Address{usdcAddr}` æŒ‡å®šæŸ¥è¯¢ USDC åˆçº¦åœ°å€
2. **äº‹ä»¶ç­¾åè¿‡æ»¤ï¼š** é€šè¿‡ `Topics: [][]common.Hash{{transferEventSignature}}` æŒ‡å®š `Transfer` äº‹ä»¶çš„ç­¾åï¼ˆTopic 0ï¼‰
3. **åŒºå—èŒƒå›´ï¼š** æŸ¥è¯¢æœ€æ–° 100 ä¸ªåŒºå—å†…çš„æ—¥å¿—
4. **æŸ¥è¯¢æ–¹æ³•ï¼š** ä½¿ç”¨ `client.FilterLogs(ctx, query)` æ‰§è¡Œè¿‡æ»¤æŸ¥è¯¢

###### è¾“å‡ºç¤ºä¾‹ä¸è§£é‡Š

è¿è¡ŒæˆåŠŸåï¼Œè¾“å‡ºç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
2025/12/10 19:15:16 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2025/12/10 19:15:16 è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯æˆåŠŸ (å·²é…ç½®ä»£ç†)
2025/12/10 19:15:16 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2025/12/10 19:15:18 æœ€æ–°åŒºå—å·: 23981946
2025/12/10 19:15:18 æŸ¥è¯¢ USDC åœ°å€: 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48
2025/12/10 19:15:18 æŸ¥è¯¢åŒºå—èŒƒå›´: 23981846 åˆ° 23981946 (å…± 100 ä¸ªåŒºå—)
2025/12/10 19:15:18 å¼€å§‹æŸ¥è¯¢æ—¥å¿—...
âœ… æˆåŠŸ: åœ¨åŒºå— 23981846 åˆ° 23981946 ä¹‹é—´æ‰¾åˆ°äº† 6645 æ¡ Transfer äº‹ä»¶æ—¥å¿—
--- ç¬¬ä¸€æ¡ Log è¯¦æƒ… ---
TxHash: 0x3e12511e30a45f3b6d422d8f98c9f9a4f437c22dff51118fe244d796bcc2d21e
BlockNumber: 23981846
Topics: [0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef 0x00000000000000000000000087f643460e3d26efc839f61c2997753a30e2c72e 0x000000000000000000000000432505f4c6409d64ba53ea34b09365e9c9b446a4]
æ³¨æ„: è¦è·å–å¯è¯»çš„è½¬è´¦é‡‘é¢ï¼Œéœ€è¦ä½¿ç”¨ ABI è§£ç  log.Data å­—æ®µã€‚
```

**è¾“å‡ºè§£é‡Šï¼š**

| è¾“å‡ºå†…å®¹ | è¯´æ˜ |
| :--- | :--- |
| **æœ€æ–°åŒºå—å·: 23981946** | å½“å‰ä»¥å¤ªåŠä¸»ç½‘çš„æœ€æ–°åŒºå—é«˜åº¦ |
| **æŸ¥è¯¢åŒºå—èŒƒå›´: 23981846 åˆ° 23981946** | æŸ¥è¯¢æœ€è¿‘ 100 ä¸ªåŒºå—ï¼ˆ23981846-23981946ï¼‰ |
| **æ‰¾åˆ°äº† 6645 æ¡ Transfer äº‹ä»¶æ—¥å¿—** | åœ¨æŒ‡å®šèŒƒå›´å†…ï¼ŒUSDC åˆçº¦å…±äº§ç”Ÿäº† 6645 æ¬¡è½¬è´¦äº‹ä»¶ |
| **TxHash** | åŒ…å«è¯¥äº‹ä»¶çš„äº¤æ˜“å“ˆå¸Œ |
| **BlockNumber** | è¯¥äº‹ä»¶æ‰€åœ¨çš„åŒºå—å· |
| **Topics[0]** | `0xddf2...` æ˜¯ `Transfer(address,address,uint256)` çš„äº‹ä»¶ç­¾åå“ˆå¸Œ |
| **Topics[1]** | `0x000...87f6...` æ˜¯è½¬è´¦å‘é€æ–¹åœ°å€ï¼ˆfromï¼Œå¡«å……è‡³ 32 å­—èŠ‚ï¼‰ |
| **Topics[2]** | `0x000...4325...` æ˜¯è½¬è´¦æ¥æ”¶æ–¹åœ°å€ï¼ˆtoï¼Œå¡«å……è‡³ 32 å­—èŠ‚ï¼‰ |
| **log.Data** | åŒ…å«è½¬è´¦é‡‘é¢ï¼ˆéœ€è¦ ABI è§£ç æ‰èƒ½è¯»å–ï¼‰ |

**æ³¨æ„ï¼š** ä»£ç æˆåŠŸå®ç°äº†æ ¹æ®åˆçº¦åœ°å€ï¼ˆUSDCï¼‰å’Œäº‹ä»¶ç­¾åï¼ˆTransferï¼‰è¿‡æ»¤å†å²æ—¥å¿—çš„åŠŸèƒ½ã€‚

æˆ‘çš„è¾“å‡º
```bash
2026/01/27 03:35:51 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2026/01/27 03:35:51 è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯æˆåŠŸ (å·²é…ç½®ä»£ç†)
2026/01/27 03:35:51 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2026/01/27 03:35:53 æœ€æ–°åŒºå—å·: 24321126
2026/01/27 03:35:53 æŸ¥è¯¢ USDC åœ°å€: 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48
2026/01/27 03:35:53 æŸ¥è¯¢åŒºå—èŒƒå›´: 24321116 åˆ° 24321126 (å…± 10 ä¸ªåŒºå—)
2026/01/27 03:35:53 å¼€å§‹æŸ¥è¯¢æ—¥å¿—...
âœ… æˆåŠŸ: åœ¨åŒºå— 24321116 åˆ° 24321126 ä¹‹é—´æ‰¾åˆ°äº† 898 æ¡ Transfer äº‹ä»¶æ—¥å¿—
--- ç¬¬ä¸€æ¡ Log è¯¦æƒ… ---
TxHash: 0x26c344c034aabe19296d0dd32c7429d48a9b04b3b370ab9c3fb2f84848660f38
BlockNumber: 24321116
Topics: [0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef 0x00000000000000000000000005ff6964d21e5dae3b1010d5ae0465b3c450f381 0x00000000000000000000000017b9e3f77df5a7aae543150f17ed0693d375f4fd]
æ³¨æ„: è¦è·å–å¯è¯»çš„è½¬è´¦é‡‘é¢ï¼Œéœ€è¦ä½¿ç”¨ ABI è§£ç  log.Data å­—æ®µã€‚
```

```bash
2026/01/27 04:11:12 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2026/01/27 04:11:12 è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯æˆåŠŸ (å·²é…ç½®ä»£ç†)
2026/01/27 04:11:12 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2026/01/27 04:11:14 æœ€æ–°åŒºå—å·: 24321303
2026/01/27 04:11:14 æŸ¥è¯¢ USDC åœ°å€: 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48
2026/01/27 04:11:14 æŸ¥è¯¢åŒºå—èŒƒå›´: 24321203 åˆ° 24321303 (å…± 100 ä¸ªåŒºå—)        
2026/01/27 04:11:14 å¼€å§‹æŸ¥è¯¢æ—¥å¿—...
âœ… æˆåŠŸ: åœ¨åŒºå— 24321203 åˆ° 24321303 ä¹‹é—´æ‰¾åˆ°äº† 8321 æ¡ Transfer äº‹ä»¶æ—¥å¿—
--- ç¬¬ä¸€æ¡ Log è¯¦æƒ… ---
TxHash: 0xdbc91c6090234aaf79ea6d722f41d694e9a196d1f744afbdecf1ae28e7b604db
BlockNumber: 24321203
Topics: [0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef 0x0000000000000000000000003a7be35c905b70453367eb0118f8ab6fe399a7fe 0x0000000000000000000000003f69532b603c5c9b01a75af8976c4c6445c6a1a1]
æ³¨æ„: è¦è·å–å¯è¯»çš„è½¬è´¦é‡‘é¢ï¼Œéœ€è¦ä½¿ç”¨ ABI è§£ç  log.Data å­—æ®µã€‚
```

##### Challengeâš”ï¸: é«˜é€šé‡æ•°æ®çš„é«˜æ•ˆæŸ¥è¯¢å’Œå¤„ç†

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒæŸ¥è¯¢å¤§é‡å†å²æ—¥å¿—ï¼ˆå¦‚ Uniswap V2 çš„ Swap äº‹ä»¶ï¼‰ä¼šé¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š

1. **æ•°æ®é‡å·¨å¤§ï¼š** å•æ¬¡æŸ¥è¯¢å¯èƒ½è¿”å›æ•°ä¸‡æ¡æ—¥å¿—ï¼Œå¯¼è‡´è¶…æ—¶æˆ–å†…å­˜æº¢å‡º
2. **API é™åˆ¶ï¼š** RPC æœåŠ¡å•†ï¼ˆå¦‚ Infuraï¼‰æœ‰ RPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰é™åˆ¶
3. **ç½‘ç»œé”™è¯¯ï¼š** éœ€è¦å¤„ç†è¿æ¥è¶…æ—¶ã€ä¸´æ—¶ç½‘ç»œæ•…éšœç­‰å¼‚å¸¸æƒ…å†µ

**æŒ‘æˆ˜ç›®æ ‡ï¼š** å®ç°ä¸€ä¸ªå¥å£®çš„é«˜é€šé‡æ—¥å¿—æŸ¥è¯¢ç³»ç»Ÿï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢ã€é”™è¯¯é‡è¯•å’Œ RPS é™åˆ¶ã€‚

###### ä»£ç æ¡†æ¶

å®Œæ•´çš„ä»£ç æ¡†æ¶å’Œå®ç°è¯·å‚è€ƒï¼š[log_filter_big.go](./week4/Part1-Geth/log_filter_big.go)

è¯¥ä»£ç æ¡†æ¶æä¾›äº†ä»¥ä¸‹åŠŸèƒ½æ¨¡å—ï¼š

1. **åˆ†é¡µæŸ¥è¯¢ï¼š** `paginatedQueryLogs()` - å°†å¤§èŒƒå›´åŒºå—åˆ†å‰²æˆå¤šä¸ªå°èŒƒå›´ï¼Œé€é¡µæŸ¥è¯¢å¹¶åˆå¹¶ç»“æœ
2. **é”™è¯¯é‡è¯•ï¼š** `queryLogsWithRetry()` - æŸ¥è¯¢å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•ï¼Œæœ€å¤šé‡è¯• MaxRetries æ¬¡
3. **é€Ÿç‡é™åˆ¶ï¼š** `RateLimiter` - æ§åˆ¶è¯·æ±‚é¢‘ç‡ï¼Œé¿å…è§¦å‘ API çš„ RPS é™åˆ¶
4. **å®Œæ•´æŸ¥è¯¢ï¼š** `queryHighVolumeLogs()` - ç»“åˆåˆ†é¡µã€é‡è¯•å’Œé€Ÿç‡é™åˆ¶çš„å®Œæ•´æŸ¥è¯¢å‡½æ•°

ä»£ç ä¸­åŒ…å«æ ‡è®°ä¸º `// TODO: your code here` çš„éƒ¨åˆ†ï¼Œéœ€è¦æ‚¨å®Œæˆå®ç°ã€‚

###### å®ç°æç¤º

å‚è€ƒ [log_filter_big.go](./week4/Part1-Geth/log_filter_big.go) ä¸­çš„ä»£ç æ¡†æ¶ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹éƒ¨åˆ†ï¼š

1. **åˆ†é¡µæŸ¥è¯¢ï¼š** å°†å¤§èŒƒå›´åŒºå—åˆ†å‰²æˆå¤šä¸ª `MaxBlockRange` å¤§å°çš„å°èŒƒå›´ï¼Œé€é¡µæŸ¥è¯¢
   - è®¡ç®—å½“å‰é¡µçš„ç»“æŸåŒºå—å·ï¼ˆä¸èƒ½è¶…è¿‡æ€»ç»“æŸåŒºå—ï¼‰
   - è°ƒç”¨ `client.FilterLogs()` æŸ¥è¯¢å½“å‰é¡µ
   - åˆå¹¶ç»“æœå¹¶æ›´æ–°èµ·å§‹åŒºå—

2. **é”™è¯¯é‡è¯•ï¼š** ä½¿ç”¨å›ºå®šå»¶è¿Ÿï¼Œåœ¨æŸ¥è¯¢å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
   - å®ç°é‡è¯•å¾ªç¯ï¼ˆæœ€å¤š MaxRetries æ¬¡ï¼‰
   - å¤±è´¥æ—¶ç­‰å¾… RetryDelay åé‡è¯•
   - è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°åè¿”å›é”™è¯¯

3. **RPS é™åˆ¶ï¼š** ä½¿ç”¨æ—¶é—´æˆ³è®°å½•ä¸Šæ¬¡è¯·æ±‚æ—¶é—´ï¼Œç¡®ä¿è¯·æ±‚é—´éš”ä¸å°äº `RequestInterval`
   - è®¡ç®—è·ç¦»ä¸Šæ¬¡è¯·æ±‚çš„æ—¶é—´é—´éš”
   - å¦‚æœé—´éš”å°äº intervalï¼Œåˆ™ç­‰å¾…å‰©ä½™æ—¶é—´
   - æ›´æ–° lastRequestTime

###### æµ‹è¯•å»ºè®®

- å…ˆç”¨å°èŒƒå›´åŒºå—ï¼ˆå¦‚ 100 ä¸ªåŒºå—ï¼‰æµ‹è¯•åŸºæœ¬åŠŸèƒ½
- é€æ­¥å¢å¤§æŸ¥è¯¢èŒƒå›´ï¼Œè§‚å¯Ÿåˆ†é¡µå’Œé€Ÿç‡é™åˆ¶çš„æ•ˆæœ
- æ¨¡æ‹Ÿç½‘ç»œé”™è¯¯ï¼ˆå¦‚æ–­å¼€ä»£ç†ï¼‰ï¼ŒéªŒè¯é‡è¯•æœºåˆ¶æ˜¯å¦ç”Ÿæ•ˆ

###### æˆ‘çš„ç»“æœ
æµ‹è¯•100ä¸ªåŒºå—
```bash
2026/01/27 04:13:14 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2026/01/27 04:13:14 âœ… ä»£ç† URL è§£ææˆåŠŸ: http://127.0.0.1:7897
2026/01/27 04:13:14 âœ… HTTP ä¼ è¾“å™¨åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:13:14 âœ… HTTP å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆè¶…æ—¶æ—¶é—´: 45sï¼‰
2026/01/27 04:13:14 âœ… RPC å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²æ³¨å…¥è‡ªå®šä¹‰ HTTP å®¢æˆ·ç«¯ï¼‰
2026/01/27 04:13:14 âœ… ä»¥å¤ªåŠå®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:13:14 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2026/01/27 04:13:16 âœ… æœ€æ–°åŒºå—å·: 24321313
2026/01/27 04:13:16 æŸ¥è¯¢åœ°å€: 0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc
2026/01/27 04:13:16 æŸ¥è¯¢åŒºå—èŒƒå›´: 24321213 åˆ° 24321313 (å…± 100 ä¸ªåŒºå—)
2026/01/27 04:13:16
ğŸš€ å¼€å§‹æŸ¥è¯¢æ—¥å¿—ï¼ˆé€šè¿‡ä»£ç†ï¼‰...
å·²æŸ¥è¯¢åŒºå— 24321213-24321313
âœ… æˆåŠŸ: åœ¨åŒºå— 24321213 åˆ° 24321313 ä¹‹é—´æ‰¾åˆ°äº† 10 æ¡ Swap äº‹ä»¶æ—¥å¿—
--- ç¬¬ä¸€æ¡ Log è¯¦æƒ… ---
TxHash: 0x6d5977b0e2b312cbb4722e28c13f35bf4662be8e9f5246c61e8cea9e1d22ab79
BlockNumber: 24321218
Topics: [0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822 0x00000000000000000000000066a9893cc07d91d95644aedd05d03f95e1dba8af 0x000000000000000000000000bc7ce7b6b5437d7d715fbb1cc7b4ec12399c5516]
```

æµ‹è¯•1000ä¸ªåŒºå—
```bash
2026/01/27 04:24:23 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2026/01/27 04:24:23 âœ… ä»£ç† URL è§£ææˆåŠŸ: http://127.0.0.1:7897
2026/01/27 04:24:23 âœ… HTTP ä¼ è¾“å™¨åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:24:23 âœ… HTTP å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆè¶…æ—¶æ—¶é—´: 45sï¼‰
2026/01/27 04:24:23 âœ… RPC å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²æ³¨å…¥è‡ªå®šä¹‰ HTTP å®¢æˆ·ç«¯ï¼‰
2026/01/27 04:24:23 âœ… ä»¥å¤ªåŠå®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:24:23 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2026/01/27 04:24:24 âœ… æœ€æ–°åŒºå—å·: 24321368
2026/01/27 04:24:24 æŸ¥è¯¢åœ°å€: 0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc
2026/01/27 04:24:24 æŸ¥è¯¢åŒºå—èŒƒå›´: 24320368 åˆ° 24321368 (å…± 1000 ä¸ªåŒºå—)
2026/01/27 04:24:24
ğŸš€ å¼€å§‹æŸ¥è¯¢æ—¥å¿—ï¼ˆé€šè¿‡ä»£ç†ï¼‰...
å·²æŸ¥è¯¢åŒºå— 24320368-24321368
âœ… æˆåŠŸ: åœ¨åŒºå— 24320368 åˆ° 24321368 ä¹‹é—´æ‰¾åˆ°äº† 138 æ¡ Swap äº‹ä»¶æ—¥å¿—
--- ç¬¬ä¸€æ¡ Log è¯¦æƒ… ---
TxHash: 0x8b5690203c1ecf56f1a091f1cf1737d5832de7677a2f4ed33a33299702dbe419
BlockNumber: 24320397
Topics: [0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822 0x00000000000000000000000066a9893cc07d91d95644aedd05d03f95e1dba8af 0x0000000000000000000000005d2c95651e0ee953b9abd8ec47ce2a165c852ae9]
```

æµ‹è¯•3000ä¸ªåŒºå—
```bash
2026/01/27 04:25:37 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2026/01/27 04:25:37 âœ… ä»£ç† URL è§£ææˆåŠŸ: http://127.0.0.1:7897
2026/01/27 04:25:37 âœ… HTTP ä¼ è¾“å™¨åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:25:37 âœ… HTTP å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆè¶…æ—¶æ—¶é—´: 45sï¼‰
2026/01/27 04:25:37 âœ… RPC å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²æ³¨å…¥è‡ªå®šä¹‰ HTTP å®¢æˆ·ç«¯ï¼‰
2026/01/27 04:25:37 âœ… ä»¥å¤ªåŠå®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:25:37 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2026/01/27 04:25:39 âœ… æœ€æ–°åŒºå—å·: 24321375
2026/01/27 04:25:39 æŸ¥è¯¢åœ°å€: 0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc
2026/01/27 04:25:39 æŸ¥è¯¢åŒºå—èŒƒå›´: 24318375 åˆ° 24321375 (å…± 3000 ä¸ªåŒºå—)
2026/01/27 04:25:39
ğŸš€ å¼€å§‹æŸ¥è¯¢æ—¥å¿—ï¼ˆé€šè¿‡ä»£ç†ï¼‰...
å·²æŸ¥è¯¢åŒºå— 24318375-24319375
å·²æŸ¥è¯¢åŒºå— 24319376-24320376
å·²æŸ¥è¯¢åŒºå— 24320377-24321375
âœ… æˆåŠŸ: åœ¨åŒºå— 24318375 åˆ° 24321375 ä¹‹é—´æ‰¾åˆ°äº† 422 æ¡ Swap äº‹ä»¶æ—¥å¿—
--- ç¬¬ä¸€æ¡ Log è¯¦æƒ… ---
TxHash: 0xd28ad51de9e0348c65a465ceb2978db7a318e7ac2bc5342bc90c6d1bb92f4126
BlockNumber: 24318390
Topics: [0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822 0x000000000000000000000000990636ecb3ff04d33d92e970d3d588bf5cd8d086 0x0000000000000000000000004ff4c7c8754127cc097910cf9d80400adef5b65d]
```

ç½‘ç»œé”™è¯¯
```bash
2026/01/27 04:22:36 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ°ä»¥å¤ªåŠå®¢æˆ·ç«¯
2026/01/27 04:22:36 âœ… ä»£ç† URL è§£ææˆåŠŸ: http://127.0.0.1:7890
2026/01/27 04:22:36 âœ… HTTP ä¼ è¾“å™¨åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:22:36 âœ… HTTP å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆè¶…æ—¶æ—¶é—´: 45sï¼‰
2026/01/27 04:22:36 âœ… RPC å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²æ³¨å…¥è‡ªå®šä¹‰ HTTP å®¢æˆ·ç«¯ï¼‰
2026/01/27 04:22:36 âœ… ä»¥å¤ªåŠå®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸï¼ˆå·²é…ç½®ä»£ç†ï¼‰
2026/01/27 04:22:36 æ­£åœ¨è·å–æœ€æ–°åŒºå—å·...
2026/01/27 04:22:36 âŒ è·å–æœ€æ–°åŒºå—å·å¤±è´¥: Post "https://mainnet.infura.io/v3/f4b1765357b1449e84efc12dcdbc502d": proxyconnect tcp: dial tcp 127.0.0.1:7890: connectex: No connection could be made because the target machine actively refused it.
   å¯èƒ½çš„åŸå› ï¼š
   1. ä»£ç†è¿æ¥ä¸ç¨³å®š
   2. Infura API é™åˆ¶æˆ–ä¸å¯ç”¨
   3. ç½‘ç»œè¶…æ—¶
   è¯·æ£€æŸ¥ä»£ç†è®¾ç½®å’Œç½‘ç»œè¿æ¥ã€‚
exit status 1
```
---

### 2025.12.25

#### Week 4 Part1-Geth-Part II: Geth è¿›é˜¶

**å›é¡¾:**
åœ¨ Part I ä¸­ï¼Œæˆ‘ä»¬æŒæ¡äº† **å†å²æ•°æ®çš„è€ƒå¤**ï¼š

  * ä½¿ç”¨ `FilterLogs` é…åˆ `Topic` å’Œ `Event Signature` ç²¾å‡†å®šä½å†å²äº‹ä»¶ã€‚
  * ç†è§£äº† `Block`ã€`Transaction` å’Œ `Receipt` (Logs) çš„å…³ç³»ã€‚
  * è§£å†³äº†é«˜é€šé‡æŸ¥è¯¢ï¼ˆPaginationï¼‰å’Œ API é™åˆ¶çš„é—®é¢˜ã€‚

**ğŸ”¥ ä¸‹ä¸€æ­¥ï¼š** åŒºå—é“¾ä¸ä»…ä»…æ˜¯é™æ€çš„å†å²æ•°æ®åº“ï¼Œå®ƒæ˜¯ä¸€æ¡å¥”æµä¸æ¯çš„æ²³ã€‚
æœ¬éƒ¨åˆ†æˆ‘ä»¬å°†å­¦ä¹  **å®æ—¶æ•°æ®çš„ç›‘æ§ (Live Monitoring)**ã€‚è¿™å°†æ˜¯ä½ ç¼–å†™ MEV Botã€é“¾ä¸Šç›‘æ§æŠ¥è­¦ç³»ç»Ÿï¼ˆå¦‚å¤§é¢è½¬è´¦ç›‘æ§ï¼‰æˆ–å®æ—¶æ•°æ®çœ‹æ¿çš„åŸºç¡€ã€‚

-----

##### å†…å®¹: å®æ—¶è®¢é˜…ä¸å®¢æˆ·ç«¯æ¶æ„

ğŸ¯ **ç›®æ ‡:**

1.  **æ¶æ„è®¤çŸ¥ï¼š** å½»åº•ç†æ¸… `rpc.Client`, `ethclient`, `gethclient` çš„åŒºåˆ«ä¸è”ç³»ã€‚
2.  **åŒºå—ç›‘å¬ï¼š** ä½¿ç”¨ `SubscribeNewHead` ç¬¬ä¸€æ—¶é—´è·å–æ–°åŒºå—ç”Ÿæˆä¿¡å·ã€‚
3.  **äº¤æ˜“æ± ç›‘å¬ï¼š** ä½¿ç”¨ `SubscribePendingTransactions` ç›‘å¬æœªæ‰“åŒ…äº¤æ˜“ï¼ˆMempoolï¼‰ï¼Œè¿™æ˜¯ MEV çš„æˆ˜åœºã€‚

-----

###### I. Geth å®¢æˆ·ç«¯æ¶æ„ (The Client Hierarchy)

åœ¨ä½¿ç”¨ Go å¼€å‘ä»¥å¤ªåŠåº”ç”¨æ—¶ï¼Œä½ ç»å¸¸ä¼šçœ‹åˆ°å‡ ç§ä¸åŒçš„ Client åˆå§‹åŒ–æ–¹å¼ã€‚å¦‚æœä¸ç†è§£å®ƒä»¬çš„å±‚çº§å…³ç³»ï¼Œçœ‹æºç æ—¶ä¼šéå¸¸æ™•ã€‚

**1. ä¸‰å±‚æ¶æ„æ¨¡å‹**

è¿™ä¸‰å±‚å®¢æˆ·ç«¯çš„å…³ç³»ç±»ä¼¼äº**è®¡ç®—æœºç³»ç»Ÿçš„åˆ†å±‚æ¶æ„**ï¼š

| å®¢æˆ·ç«¯å±‚çº§ | åŒ…è·¯å¾„ (`go-ethereum`) | ä½œç”¨ä¸ç‰¹ç‚¹ | ç±»æ¯”è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **RPC Client**<br>(åº•å±‚) | `rpc` | **åŸºç¡€é€šä¿¡å±‚**ã€‚è´Ÿè´£å»ºç«‹ TCP/HTTP/WebSocket è¿æ¥ï¼Œå‘é€åŸå§‹ JSON è¯·æ±‚å¹¶æ¥æ”¶å“åº”ã€‚å®ƒä¸å…³å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œåªç®¡ä¼ è¾“æ•°æ®åŒ…ã€‚ | **ç¡¬ä»¶å±‚**<br>å°±åƒè®¡ç®—æœºçš„ç¡¬ä»¶ï¼ˆCPUã€å†…å­˜ã€ç½‘å¡ï¼‰ï¼Œåªè´Ÿè´£åº•å±‚çš„ç‰©ç†é€šä¿¡ï¼Œä¸å…³å¿ƒä¼ è¾“çš„æ˜¯ä»€ä¹ˆå†…å®¹ã€‚ |
| **EthClient**<br>(æ ‡å‡†å±‚) | `ethclient` | **é€šç”¨æ ‡å‡†å±‚**ã€‚å°è£…äº†ä»¥å¤ªåŠé€šç”¨çš„ JSON-RPC æ–¹æ³•ï¼ˆå¦‚ `eth_getBalance`, `eth_call`ï¼‰ã€‚å®ƒæ˜¯å¤§å¤šæ•°å¼€å‘è€…çš„é¦–é€‰ã€‚å®ƒåº•å±‚æŒæœ‰ä¸€ä¸ª `rpc.Client`ã€‚ | **æ“ä½œç³»ç»Ÿå±‚**<br>å°±åƒæ“ä½œç³»ç»Ÿæä¾›çš„æ ‡å‡† APIï¼ˆå¦‚ Windows APIã€MacOS syscallï¼‰ï¼Œå®šä¹‰äº†é€šç”¨çš„æ¥å£è§„èŒƒï¼Œæ‰€æœ‰ä»¥å¤ªåŠèŠ‚ç‚¹éƒ½éµå¾ªè¿™äº›æ ‡å‡†ã€‚ |
| **GethClient**<br>(ç‰¹åŒ–å±‚) | `eth/gethclient` | **Geth ä¸“ç”¨å±‚**ã€‚å°è£…äº† Geth èŠ‚ç‚¹ç‰¹æœ‰çš„ã€éé€šç”¨æ ‡å‡†çš„ APIï¼ˆé€šå¸¸æ¶‰åŠèŠ‚ç‚¹ç®¡ç†ã€TxPool æ·±åº¦æ“ä½œç­‰ï¼‰ã€‚å®ƒåº•å±‚ä¹ŸæŒæœ‰ä¸€ä¸ª `rpc.Client`ã€‚ | **åº”ç”¨å±‚**<br>å°±åƒç‰¹å®šæ“ä½œç³»ç»Ÿä¸Šçš„ä¸“ç”¨è½¯ä»¶ï¼ˆå¦‚ macOS çš„ç‰¹å®šåº”ç”¨ï¼‰ï¼Œåªèƒ½ä¸ Geth èŠ‚ç‚¹é…åˆä½¿ç”¨ï¼Œå…¶ä»–å®¢æˆ·ç«¯ï¼ˆå¦‚ Nethermindã€Erigonï¼‰å¯èƒ½ä¸æ”¯æŒè¿™äº›æ¥å£ã€‚ |

**å…³é”®ç†è§£ï¼š**

- **å…¼å®¹æ€§å…³ç³»ï¼š** å°±åƒä½ ä¸èƒ½åœ¨ macOS ä¸Šç›´æ¥è¿è¡Œ Windows çš„ `.exe` æ–‡ä»¶ï¼Œ`GethClient` çš„æ–¹æ³•åªèƒ½åœ¨ Geth èŠ‚ç‚¹ä¸Šä½¿ç”¨ï¼Œä¸èƒ½ç”¨äºå…¶ä»–å®¢æˆ·ç«¯ã€‚
- **ä¾èµ–å…³ç³»ï¼š** `EthClient` å’Œ `GethClient` éƒ½ä¾èµ– `RPC Client`ï¼Œå°±åƒåº”ç”¨ç¨‹åºä¾èµ–æ“ä½œç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿä¾èµ–ç¡¬ä»¶ã€‚
- **é€‰æ‹©åŸåˆ™ï¼š** ä¼˜å…ˆä½¿ç”¨ `EthClient`ï¼ˆé€šç”¨æ€§å¼ºï¼‰ï¼Œåªæœ‰åœ¨éœ€è¦ Geth ç‰¹æœ‰åŠŸèƒ½æ—¶æ‰ä½¿ç”¨ `GethClient`ã€‚

**2. ä¸ºä»€ä¹ˆéœ€è¦åŒºåˆ†ï¼Ÿ**

  * **é€šç”¨æ€§ vs åŠŸèƒ½æ€§**ï¼šå¦‚æœä½ åªéœ€è¦æŸ¥è¯¢ä½™é¢ã€å‘é€äº¤æ˜“ï¼Œç”¨ `ethclient` è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœä½ éœ€è¦è®¢é˜…æ›´åº•å±‚çš„**å¾…å¤„ç†äº¤æ˜“è¯¦æƒ…**ï¼Œæˆ–è€…è®¿é—® Geth ç‰¹æœ‰çš„ `txpool` å‘½åç©ºé—´ï¼Œä½ éœ€è¦ `gethclient`ã€‚

-----

###### II. Subscribe (è®¢é˜…æ¨¡å¼)

**èƒŒæ™¯çŸ¥è¯†ï¼š**

  * **åè®®è¦æ±‚ï¼š** è®¢é˜…åŠŸèƒ½å¿…é¡»ä½¿ç”¨ **WebSocket (WSS)** æˆ– **IPC** è¿æ¥ã€‚HTTP æ˜¯æ— çŠ¶æ€çš„ï¼Œæ— æ³•ç»´æŒé•¿è¿æ¥æ¨é€æ•°æ®ã€‚
  * **ç¼–ç¨‹æ¨¡å¼ï¼š** Go è¯­è¨€ä¸­ä¸»è¦é€šè¿‡ `channel` (é€šé“) æ¥æ¥æ”¶æ¨é€æ•°æ®ã€‚

**1. ç›‘å¬æ–°åŒºå— (`Client.SubscribeNewHead`)**

è¿™æ˜¯æ‰€æœ‰ç›‘æ§ç¨‹åºçš„â€œå¿ƒè·³â€ã€‚æ¯å½“ç½‘ç»œä¸­äº§ç”Ÿä¸€ä¸ªæ–°åŒºå—ï¼Œä½ çš„ç¨‹åºä¼šç«‹å³æ”¶åˆ°é€šçŸ¥ã€‚

  * **æ–¹æ³•æ¥æºï¼š** `ethclient`
  * **åº”ç”¨åœºæ™¯ï¼š**
      * æ›´æ–°æœ¬åœ°æ•°æ®åº“çš„åŒºå—é«˜åº¦ã€‚
      * è§¦å‘æ–°çš„åˆçº¦çŠ¶æ€æ£€æŸ¥ï¼ˆå¦‚ Chainlink Oracle æ›´æ–°ï¼‰ã€‚

**2. ç›‘å¬å¾…å¤„ç†äº¤æ˜“ (`gethClient.SubscribePendingTransactions`)**

è¿™æ˜¯ **MEV (æœ€å¤§å¯æå–ä»·å€¼)** å’Œ **PVP (é“¾ä¸Šåšå¼ˆ)** çš„æ ¸å¿ƒã€‚

**æ–¹æ³•æ¥æºï¼š** `ethclient` ä¹Ÿæœ‰æ­¤æ–¹æ³•ï¼Œä½† `gethclient` æä¾›äº†æ›´è´´åˆ Geth èŠ‚ç‚¹ç‰¹æ€§çš„å°è£…ï¼ˆåœ¨æŸäº›ç‰ˆæœ¬ä¸­è¿”å›çš„æ•°æ®ç»“æ„ç•¥æœ‰ä¸åŒï¼Œæˆ–è€…æ”¯æŒç‰¹å®šçš„è¿‡æ»¤ï¼‰ã€‚é€šå¸¸æˆ‘ä»¬æŒ‡ç›‘å¬ Mempool ä¸­çš„ Transaction Hashã€‚

**æ•°æ®æµï¼š**

1. **ç”¨æˆ·å‘é€äº¤æ˜“** â†’ äº¤æ˜“è¢«å¹¿æ’­åˆ°ä»¥å¤ªåŠç½‘ç»œ
2. **èŠ‚ç‚¹æ¥æ”¶å¹¶éªŒè¯** â†’ äº¤æ˜“è¿›å…¥èŠ‚ç‚¹çš„ **Mempool (äº¤æ˜“æ± )**
3. **èŠ‚ç‚¹æ¨é€ Hash ç»™è®¢é˜…è€…** â†’ ä½ çš„ç¨‹åºé€šè¿‡ WebSocket å®æ—¶æ”¶åˆ°äº¤æ˜“ Hash
4. **çŸ¿å·¥/Validator æ‰“åŒ…** â†’ äº¤æ˜“è¢«é€‰å…¥åŒºå—å¹¶ç¡®è®¤

**ä¸ºä»€ä¹ˆäº¤æ˜“ä¼šè¿›å…¥ Mempoolï¼Ÿ**

- **Mempoolï¼ˆMemory Poolï¼‰** æ˜¯æ¯ä¸ªä»¥å¤ªåŠèŠ‚ç‚¹ç»´æŠ¤çš„**å¾…å¤„ç†äº¤æ˜“æ± **ã€‚
- å½“ç”¨æˆ·é€šè¿‡é’±åŒ…æˆ– DApp å‘é€äº¤æ˜“æ—¶ï¼Œäº¤æ˜“é¦–å…ˆè¢«å¹¿æ’­åˆ°ç½‘ç»œä¸­çš„èŠ‚ç‚¹ã€‚
- èŠ‚ç‚¹æ”¶åˆ°äº¤æ˜“åä¼šè¿›è¡Œåˆæ­¥éªŒè¯ï¼ˆç­¾åã€nonceã€Gas ä»·æ ¼ç­‰ï¼‰ï¼Œå¦‚æœé€šè¿‡éªŒè¯ï¼Œå°±ä¼šå°†äº¤æ˜“æ”¾å…¥ Mempool ç­‰å¾…è¢«æ‰“åŒ…ã€‚
- Mempool ä¸­çš„äº¤æ˜“å¤„äº **Pendingï¼ˆå¾…å¤„ç†ï¼‰** çŠ¶æ€ï¼Œè¿˜æ²¡æœ‰è¢«ç¡®è®¤ã€‚

**ä¸ºä»€ä¹ˆèŠ‚ç‚¹ä¼šæ¨é€ Hash ç»™è®¢é˜…è€…ï¼Ÿ**

- **å®æ—¶æ€§éœ€æ±‚ï¼š** è®¸å¤šåº”ç”¨ï¼ˆå¦‚ MEV Botã€å¥—åˆ©æœºå™¨äººï¼‰éœ€è¦åœ¨äº¤æ˜“è¢«æ‰“åŒ…å‰å°±è·å–ä¿¡æ¯ï¼Œä»¥ä¾¿å¿«é€Ÿå“åº”ã€‚
- **è®¢é˜…æœºåˆ¶ï¼š** é€šè¿‡ WebSocket è®¢é˜…ï¼ŒèŠ‚ç‚¹ä¼šåœ¨æ–°äº¤æ˜“è¿›å…¥ Mempool æ—¶ä¸»åŠ¨æ¨é€ï¼Œè€Œä¸æ˜¯è®©å®¢æˆ·ç«¯ä¸æ–­è½®è¯¢ã€‚
- **æ•ˆç‡ä¼˜åŠ¿ï¼š** æ¨é€æ¨¡å¼æ¯”è½®è¯¢æ›´é«˜æ•ˆï¼Œå‡å°‘äº†ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ï¼ŒåŒæ—¶èƒ½ä¿è¯å®æ—¶æ€§ã€‚

**æ³¨æ„ï¼š** è®¢é˜…é€šå¸¸åªè¿”å› **TxHash**ã€‚å¦‚æœä½ æƒ³çŸ¥é“äº¤æ˜“å†…å®¹ï¼ˆæ¯”å¦‚æ˜¯ä¸æ˜¯åœ¨ä¹°å…¥æŸä¸ª Tokenï¼‰ï¼Œä½ æ‹¿åˆ° Hash åéœ€è¦ç«‹å³è°ƒç”¨ `TransactionByHash` å»æŸ¥è¯¢è¯¦æƒ…ã€‚ 

-----

###### III. å®æˆ˜ä»£ç  (Code Practice)

**1. ç¯å¢ƒå‡†å¤‡**
  - ä»£ç†é…ç½®å‚è€ƒpart1

**ç¯å¢ƒé…ç½®ï¼š**

- åˆå§‹åŒ–ä¾èµ–ï¼šè¿è¡Œ `go mod tidy` è‡ªåŠ¨å®‰è£…æ‰€éœ€åŒ…
- å¦‚é‡ Go åŒ…å®‰è£…é—®é¢˜ï¼ˆWindowsï¼‰ï¼Œè®¾ç½®ä»£ç†ï¼š`$env:GOPROXY="https://goproxy.cn,direct"`
- ç¡®ä¿æœ¬åœ° Geth èŠ‚ç‚¹æ­£åœ¨è¿è¡Œ
- è¿è¡Œä»£ç ï¼š`go run monitor_setup.go`
- æœ‰çš„æ—¶å€™å¡ä½ï¼Œè¿è¡Œ `set HTTP_PROXY=` å’Œ `set HTTPS_PROXY=` æ¸…é™¤ç¯å¢ƒå˜é‡åé‡è¯•

**2. ä»£ç å®ç°**

å®Œæ•´çš„å®ç°ä»£ç è¯·å‚è€ƒï¼š[monitor_setup.go](./week4/Part1-Geth/monitor_setup.go)

è¯¥ä»£ç å±•ç¤ºäº†å¦‚ä½•ï¼š

1. **å»ºç«‹ WebSocket è¿æ¥ï¼š** ä½¿ç”¨ `rpc.DialContext` è¿æ¥åˆ°æœ¬åœ° Geth èŠ‚ç‚¹
2. **å¤ç”¨ RPC è¿æ¥ï¼š** åŒæ—¶åˆå§‹åŒ– `ethclient` å’Œ `gethclient`ï¼Œå…±äº«åŒä¸€ä¸ªåº•å±‚è¿æ¥
3. **åŒé€šé“ç›‘å¬ï¼š** ä½¿ç”¨ Go çš„ `channel` æœºåˆ¶å¹¶å‘ç›‘å¬æ–°åŒºå—å’Œå¾…å¤„ç†äº¤æ˜“
4. **ä¼˜é›…é€€å‡ºï¼š** æ•è·ç³»ç»Ÿä¿¡å·ï¼ˆCtrl+Cï¼‰ï¼Œæ­£ç¡®å…³é—­è®¢é˜…å’Œè¿æ¥


**æ ¸å¿ƒåŠŸèƒ½ï¼š**

- **æ–°åŒºå—ç›‘å¬ï¼š** ä½¿ç”¨ `ethClient.SubscribeNewHead()` å®æ—¶è·å–æ–°åŒºå—å¤´ä¿¡æ¯
- **äº¤æ˜“æ± ç›‘å¬ï¼š** ä½¿ç”¨ `gethClient.SubscribePendingTransactions()` ç›‘å¬ Mempool ä¸­çš„æ–°äº¤æ˜“
- **é”™è¯¯å¤„ç†ï¼š** å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¿æœºåˆ¶
- **èµ„æºæ¸…ç†ï¼š** ç¨‹åºé€€å‡ºæ—¶æ­£ç¡®å–æ¶ˆè®¢é˜…å¹¶å…³é—­è¿æ¥

**3. è¿è¡Œä¸è¾“å‡ºè§£é‡Š**

**è¿è¡Œæ­¥éª¤ï¼š**

1. **ä¿®æ”¹é…ç½®ï¼š** åœ¨ [monitor_setup.go](./week4/Part1-Geth/monitor_setup.go) ä¸­æ›¿æ¢ `NodeWSS` ä¸ºä½ çš„ WebSocket åœ°å€
2. **é…ç½®ä»£ç†ï¼š** æ ¹æ®ä½ çš„ä»£ç†è½¯ä»¶ä¿®æ”¹ `PROXY_PORT` å¸¸é‡ï¼ˆå¦‚ä¸éœ€è¦ä»£ç†å¯è®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰
3. **è¿è¡Œä»£ç ï¼š** `go run monitor_setup.go`
4. **è§‚å¯Ÿè¾“å‡ºï¼š** ç¨‹åºä¼šå®æ—¶æ˜¾ç¤ºæ–°åŒºå—å’Œå¾…å¤„ç†äº¤æ˜“
5. **é€€å‡ºç¨‹åºï¼š** æŒ‰ `Ctrl+C` ä¼˜é›…é€€å‡º

**é¢„æœŸè¾“å‡ºï¼š**

```text
2025/12/10 20:00:00 å¼€å§‹è¿æ¥åˆ°æœ¬åœ° WebSocket èŠ‚ç‚¹
âœ… æˆåŠŸå»ºç«‹ RPC WebSocket è¿æ¥
ğŸ§ å¼€å§‹ç›‘å¬æ–°åŒºå— (NewHeads)...
ğŸ§ å¼€å§‹ç›‘å¬äº¤æ˜“æ±  (Pending Transactions)...

ğŸ“¡ ç›‘æ§å·²å¯åŠ¨ï¼ŒæŒ‰ Ctrl+C é€€å‡º...

ğŸŒŠ [Pending Tx] 0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
ğŸŒŠ [Pending Tx] 0xabcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
... (å¤§é‡çš„äº¤æ˜“ Hash æ¶Œå…¥) ...

ğŸ“¦ [New Block] Height: 19283001 | Hash: 0x789... | Time: 1709123456
ğŸŒŠ [Pending Tx] 0x456def789abc123456def789abc123456def789abc123456def789abc123456
...
```

**è¾“å‡ºè§£é‡Šï¼š**

| è¾“å‡ºå†…å®¹ | è¯´æ˜ |
| :--- | :--- |
| **âœ… æˆåŠŸå»ºç«‹ RPC WebSocket è¿æ¥** | WebSocket è¿æ¥å·²å»ºç«‹ï¼Œå¯ä»¥å¼€å§‹è®¢é˜… |
| **ğŸ§ å¼€å§‹ç›‘å¬æ–°åŒºå—** | å·²è®¢é˜…æ–°åŒºå—äº‹ä»¶ï¼Œç­‰å¾…åŒºå—ç”Ÿæˆ |
| **ğŸ§ å¼€å§‹ç›‘å¬äº¤æ˜“æ± ** | å·²è®¢é˜…å¾…å¤„ç†äº¤æ˜“äº‹ä»¶ï¼Œç­‰å¾…æ–°äº¤æ˜“è¿›å…¥ Mempool |
| **ğŸŒŠ [Pending Tx]** | æ–°äº¤æ˜“è¿›å…¥ Mempoolï¼Œæ˜¾ç¤ºäº¤æ˜“ Hash |
| **ğŸ“¦ [New Block]** | æ–°åŒºå—å·²ç”Ÿæˆï¼Œæ˜¾ç¤ºåŒºå—é«˜åº¦ã€å“ˆå¸Œå’Œæ—¶é—´æˆ³ |

**æˆ‘çš„ç»“æœ**
```bash
2026/01/27 04:34:11 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ° WebSocket èŠ‚ç‚¹
2026/01/27 04:34:11 âœ… ä»£ç†é…ç½®: http://127.0.0.1:7897
âœ… æˆåŠŸå»ºç«‹ RPC WebSocket è¿æ¥ (å·²é…ç½®ä»£ç†)
ğŸ§ å¼€å§‹ç›‘å¬æ–°åŒºå— (NewHeads)...
ğŸ§ å¼€å§‹ç›‘å¬äº¤æ˜“æ±  (Pending Transactions)...

ğŸ“¡ ç›‘æ§å·²å¯åŠ¨ï¼ŒæŒ‰ Ctrl+C é€€å‡º...


ğŸ“¦ [New Block] Height: 24321419 | Hash: 0x36263c13b759f20ddffed1f2dd515f686c1b33102b2976d7bbb9cdcffe488f40 | Time: 1769459663
ğŸŒŠ [Pending Tx] 0x4d69ed91f553d8b0a48f3382af066274d3629e8a75e68ece2c831bcaeed5da92
ğŸŒŠ [Pending Tx] 0xdb11572e54c93d9d922288e5adfed58146827f73cd95c2397275816911904497
ğŸŒŠ [Pending Tx] 0xc20b5e4024d8a89c33f397ca2544378309a4453944bb3dc9be9677c72548b2dd
ğŸŒŠ [Pending Tx] 0xb63bb2e27c22b450963f6848679a4e5adc0253d00dab95c9847b4aef568f554e
ğŸŒŠ [Pending Tx] 0x2ce6d7ea8750822fd4356accc631a74edb1c7ed04500bc4a60c2135814bf8b61

ğŸ›‘ åœæ­¢ç›‘æ§ï¼Œæ­£åœ¨æ–­å¼€è¿æ¥...
```

### 2025.12.31

#### Week 4 Part1-Geth-Part III: The Graph & GraphQL


**å›é¡¾:**
åœ¨ Part II ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥ä¸ **Geth èŠ‚ç‚¹** å¯¹è¯ï¼Œå­¦ä¼šäº†ç›‘å¬å®æ—¶çš„åŒºå—å’Œäº¤æ˜“ã€‚

  * **ç—›ç‚¹ï¼š** Geth å¾ˆå¼ºï¼Œä½†ä¹Ÿå¾ˆâ€œç¬¨â€ã€‚å¦‚æœä½ é—® Gethï¼šâ€œè¯·å‘Šè¯‰æˆ‘ Uniswap ä¸Šè¿‡å»ä¸€å¹´ ETH/USDC çš„æ‰€æœ‰äº¤æ˜“é‡æ€»å’Œâ€ï¼ŒGeth ä¼šå´©æºƒã€‚å› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œæ²¡æœ‰æ ¹æ®ä¸šåŠ¡é€»è¾‘å»ºç«‹ç´¢å¼•ã€‚
  
  * **è§£å†³ï¼š** æˆ‘ä»¬éœ€è¦ä¸€ä¸ª **ä¸­é—´ä»¶**ï¼Œå®ƒèƒ½åƒâ€œçˆ¬è™«â€ä¸€æ ·é€šè¿‡ RPC æŠ“å–é“¾ä¸Šæ•°æ®ï¼Œæ¸…æ´—ã€æ•´ç†å¹¶å­˜å…¥æ•°æ®åº“ï¼Œä¾›æˆ‘ä»¬å¿«é€ŸæŸ¥è¯¢ã€‚è¿™å°±æ˜¯ **The Graph**ã€‚

-----

##### æ•°æ®çš„è°·æ­Œ

ğŸ¯ **ç›®æ ‡:**

1.  **ç†è§£æ¶æ„ï¼š** ä»€ä¹ˆæ˜¯ Subgraphï¼Œå®ƒæ˜¯å¦‚ä½•ä½œä¸ºâ€œPer Protocolâ€çš„æ•°æ®èšåˆå™¨çš„ã€‚
2.  **æŒæ¡è¯­æ³•ï¼š** å­¦ä¹  GraphQL æŸ¥è¯¢è¯­è¨€ï¼Œæ‘†è„± REST API çš„æŸç¼šã€‚
3.  **å®æˆ˜æ¼”ç»ƒï¼š** åœ¨ Graph Explorer ä¸­è°ƒè¯•æŸ¥è¯¢ï¼Œå¹¶ç¼–å†™ Go è¯­è¨€è„šæœ¬è¿›è¡Œ**é«˜é€šé‡åˆ†é¡µæŠ“å–**ã€‚

###### ä¸ºä»€ä¹ˆéœ€è¦ The Graphï¼Ÿ

**ä¸€å¥è¯æ€»ç»“ï¼š** Geth æ˜¯ä¸ºäº†"éªŒè¯"è€Œè®¾è®¡çš„ï¼ˆå†™ä¼˜åŒ–ï¼‰ï¼ŒThe Graph æ˜¯ä¸ºäº†"æœç´¢"è€Œè®¾è®¡çš„ï¼ˆè¯»ä¼˜åŒ–ï¼‰ã€‚

**1. æ ¸å¿ƒæ•°æ®ç»“æ„å¯¹æ¯”**

| ç‰¹æ€§ | Geth (Layer 1 èŠ‚ç‚¹) | The Graph (ç´¢å¼•å±‚) |
| :--- | :--- | :--- |
| **ç‰©ç†å­˜å‚¨** | LevelDB (Key-Value æ•°æ®åº“) | PostgreSQL (å…³ç³»å‹æ•°æ®åº“) |
| **é€»è¾‘ç»“æ„** | é“¾è¡¨ (Linked List) + Merkle Patricia Trie (MPT) | å®ä½“è¡¨ (Tables) (å¦‚ User è¡¨, Swap è¡¨) |
| **ç´¢å¼•æ–¹å¼** | ä»…å“ˆå¸Œç´¢å¼• | B-Tree ç´¢å¼• |
| **æŸ¥è¯¢èƒ½åŠ›** | åªèƒ½é€šè¿‡ Block Hash æˆ– Tx Hash æŸ¥æ‰¾ | å¯ä»¥ä¸ºä»»æ„å­—æ®µï¼ˆUser Address, Amount, Token Symbolï¼‰å»ºç«‹ç´¢å¼• |
| **æŸ¥è¯¢å¤æ‚åº¦** | O(N) - å…¨è¡¨æ‰«æ | O(log N) æˆ– O(1) - ç´¢å¼•æŸ¥æ‰¾ |

**ä½æ•ˆåŸå› ï¼š** Geth çš„æ•°æ®æ˜¯ä¸€æ¡å•å‘çš„æ—¶é—´è½´ã€‚æŸ¥æ‰¾ç‰¹å®šä¸šåŠ¡æ•°æ®ï¼ˆå¦‚"Bob çš„æ‰€æœ‰äº¤æ˜“"ï¼‰ç­‰åŒäºåœ¨æ•°æ®åº“ä¸­åšå…¨è¡¨æ‰«æ (Full Table Scan)ã€‚

**é«˜æ•ˆåŸå› ï¼š** The Graph å°†é“¾ä¸Šçš„çº¿æ€§æ•°æ®é‡ç»„æˆäº†ç»“æ„åŒ–è¡¨æ ¼ã€‚æŸ¥æ‰¾ç‰¹å®šä¸šåŠ¡æ•°æ®ç­‰åŒäº SQL æŸ¥è¯¢ä¸­çš„ç´¢å¼•æŸ¥æ‰¾ã€‚

**æ¯”å–»ï¼š**
- **Geth** æ˜¯ä¸€å·å½•åƒå¸¦ï¼šä½ æƒ³æ‰¾"ç”·ä¸»è§’ç¬¬ä¸€æ¬¡å‡ºç°"çš„ç”»é¢ï¼Œå¿…é¡»ä»å¤´å¿«è¿›æ’­æ”¾å»æ‰¾ã€‚
- **The Graph** æ˜¯ä¸€æœ¬ä¹¦çš„ç›®å½•ï¼šä½ å¯ä»¥ç›´æ¥æŸ¥"ç”·ä¸»è§’"åœ¨å“ªä¸€é¡µï¼Œç„¶åç›´æ¥ç¿»è¿‡å»ã€‚

###### I. The Graph æ˜¯ä»€ä¹ˆï¼Ÿ

The Graph æ˜¯åŒºå—é“¾æ•°æ®çš„ **å»ä¸­å¿ƒåŒ–ç´¢å¼•åè®®**ã€‚

  * **Subgraph (å­å›¾):** å¯ä»¥ç†è§£ä¸ºæ¯ä¸€ä¸ª DAppï¼ˆå¦‚ Uniswap, Aave, Compoundï¼‰éƒ½æœ‰ä¸€ä¸ªä¸“å±çš„â€œæ•°æ®åº“Schemaâ€å’Œâ€œç´¢å¼•é€»è¾‘â€ï¼Œè¿™è¢«ç§°ä¸º Subgraphã€‚
  * **Per Protocol:** å®ƒæ˜¯ä»¥**åè®®ä¸ºä¸­å¿ƒ**çš„ã€‚ä½ æƒ³æŸ¥ Uniswap çš„æ•°æ®ï¼Œå°±å» Uniswap çš„ Subgraphï¼›æƒ³æŸ¥ ENS çš„åŸŸåï¼Œå°±å» ENS çš„ Subgraphã€‚

###### II. äº¤äº’å¼ä½“éªŒï¼šGraph Explorer

åœ¨å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåœ¨ç½‘é¡µä¸Š"ç©"ä¸€ä¸‹æ•°æ®ã€‚

**å®æ“æ­¥éª¤ (è¯·åŒå­¦ä»¬è·Ÿéšæ“ä½œ):**

1. æ‰“å¼€ [The Graph Explorer (Arbitrum)](https://thegraph.com/explorer?chain=arbitrum-one)
2. åœ¨æœç´¢æ¡†è¾“å…¥ `Uniswap V3` (æˆ–è€… V2ï¼Œè§†å…·ä½“æ•™ç¨‹éœ€æ±‚)
3. ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µï¼Œç‚¹å‡»å³ä¾§çš„ **"Query"** æŒ‰é’®
4. ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼ IDE çš„ç•Œé¢ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å°±åœ°æµ‹è¯• GraphQL çš„åœ°æ–¹

**å¿«é€Ÿé“¾æ¥ï¼š** ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ [Uniswap V3 Subgraph (Substreams)](https://thegraph.com/explorer/subgraphs/HUZDsRpEVP2AvzDCyzDHtdc64dyDxx8FQjzsmqSg4H3B?view=Query&chain=arbitrum-one)ï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥æŸ¥è¯¢ï¼Œä¸éœ€è¦è‡ªå·±æœç´¢ã€‚

###### III. GraphQL è¯­æ³•é€Ÿæˆ

GraphQL æ˜¯ä¸€ç§"æŒ‰éœ€ç´¢å–"çš„æŸ¥è¯¢è¯­è¨€ã€‚ä½ éœ€è¦ä»€ä¹ˆå­—æ®µï¼Œå°±å†™ä»€ä¹ˆå­—æ®µï¼Œä¸ä¼šå¤šç»™ï¼Œä¹Ÿä¸ä¼šå°‘ç»™ã€‚

**1. åŸºç¡€æŸ¥è¯¢ç»“æ„**

ä»¥ Uniswap V3 ä¸ºä¾‹ï¼Œæˆ‘ä»¬æŸ¥è¯¢ä¸€ä¸‹æœ€è¿‘çš„ `Swaps` (äº¤æ˜“äº‹ä»¶)ã€‚

**åœ¨ Graph Explorer ä¸­æµ‹è¯•ï¼š** [Uniswap V3 Subgraph (Substreams)](https://thegraph.com/explorer/subgraphs/HUZDsRpEVP2AvzDCyzDHtdc64dyDxx8FQjzsmqSg4H3B?view=Query&chain=arbitrum-one)

```graphql
{
  swaps(first: 5, orderBy: timestamp, orderDirection: desc) {
    id
    timestamp
    token0 {
      symbol
    }
    token1 {
      symbol
    }
    amount0
    amount1
  }
}
```

ç»“æœ
```graphql
{
  "data": {
    "swaps": [
      {
        "amount0": "-107577.612228325596955085",
        "amount1": "2787.834346892399459931",
        "id": "0xf352dbeaf7113ada709cc4640ddea97aadd1ccd90cf4b9f6f565bb8c1637ee13#4490",
        "timestamp": "1769460407",
        "token0": {
          "symbol": "TOWER"
        },
        "token1": {
          "symbol": "CTA"
        }
      },
      {
        "amount0": "-2787.834346892399459931",
        "amount1": "0.015830141740642321",
        "id": "0xf352dbeaf7113ada709cc4640ddea97aadd1ccd90cf4b9f6f565bb8c1637ee13#30230",
        "timestamp": "1769460407",
        "token0": {
          "symbol": "CTA"
        },
        "token1": {
          "symbol": "WETH"
        }
      },
      {
        "amount0": "-0.240561508286516444",
        "amount1": "700.84177",
        "id": "0xf2595e6fb6b62aa1eeb427d6cabf1f0164ab5597c9288d65f473b24d0c9df8ec#7087146",
        "timestamp": "1769460407",
        "token0": {
          "symbol": "WETH"
        },
        "token1": {
          "symbol": "USDT"
        }
      },
      {
        "amount0": "89.01822",
        "amount1": "-0.889164123230358978",
        "id": "0xd9365c538baa2d9b7a5a098f9c7d0e2a5ed0dc3f2084e9ebf4ce40d13d7dc270#9380",
        "timestamp": "1769460407",
        "token0": {
          "symbol": "USDC"
        },
        "token1": {
          "symbol": "SLVon"
        }
      },
      {
        "amount0": "-105",
        "amount1": "0.036084967620213681",
        "id": "0xc78d334faa0efde378d7207c50efd320f731d62015a7366fc5089485051e976e#10682375",
        "timestamp": "1769460407",
        "token0": {
          "symbol": "USDC"
        },
        "token1": {
          "symbol": "WETH"
        }
      }
    ]
  }
}
```

**è¯­æ³•è¯´æ˜ï¼š**

- **`swaps`**: å®ä½“åç§° (Entity)
- **`first: 5`**: é™åˆ¶è¿”å›æ¡æ•° (Limit)
- **`orderBy: timestamp`**: æ’åºå­—æ®µ
- **`orderDirection: desc`**: æ’åºæ–¹å‘ï¼ˆé™åºï¼‰
- **`{ ... }`**: è¿™é‡Œé¢æ˜¯ä½ éœ€è¦çš„å­—æ®µã€‚æ³¨æ„ `token0` æ˜¯ä¸€ä¸ªåµŒå¥—å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å±•å¼€è·å–å®ƒçš„ `symbol`

**2. æ¡ä»¶è¿‡æ»¤ (Where)**

æŸ¥è¯¢ **USDC (å‡è®¾åœ°å€ä¸º 0xff97...)** ç›¸å…³çš„ Swapï¼š

```graphql
{
  swaps(
    first: 5, 
    where: { 
      token0: "0xff970a61a04b1ca14834a43f5de4533ebddb5cc8" 
    }
  ) {
    id
    amount0
  }
}
```

**è¯­æ³•è¯´æ˜ï¼š**

- **`where`**: æ¡ä»¶è¿‡æ»¤ï¼Œæ”¯æŒå¤šç§æ¯”è¾ƒæ“ä½œç¬¦ï¼ˆå¦‚ `id_gt`, `amount_gte` ç­‰ï¼‰
- **`token0: "0xff97..."`**: ç²¾ç¡®åŒ¹é… token0 åœ°å€

ç»“æœ
```graphql
{
  "errors": [
    {
      "message": "bad indexers: {0x2f09092aacd80196fc984908c5a9a7ab3ee4f1ce: Timeout, 0x32bbd16a94ebb289edceebe77f35acc82664157b: Unavailable(no status: indexer not available), 0xedca8740873152ff30a2696add66d1ab41882beb: BadResponse(unattestable response: Failed to get entities from store: canceling statement due to statement timeout, query = /* controller='filter',application='sgd1442',route='3ab75b08cb0cd338-1139e878482b73ed',action='24321485' */\nselect 'Swap' as entity, to_jsonb(c.*) as data from (select)}"
    }
  ]
}
```

###### IV. å®æˆ˜ï¼šç”¨ Go è¯­è¨€"æ¬è¿"æ•°æ®

**æŒ‘æˆ˜èƒŒæ™¯ï¼š**

ä½ éœ€è¦è·å– Uniswap V3 ä¸Š **æ‰€æœ‰çš„** Pool åœ°å€ï¼ˆæˆåƒä¸Šä¸‡ä¸ªï¼‰ã€‚Graph å•æ¬¡æŸ¥è¯¢é€šå¸¸é™åˆ¶ `100` æˆ– `1000` æ¡æ•°æ®ã€‚æ™®é€šçš„ `skip` (è·³è¿‡) åˆ†é¡µåœ¨æ•°æ®é‡å¤§æ—¶ä¼šææ…¢ç”šè‡³æŠ¥é”™ã€‚

**Challenge âš”ï¸: é«˜é€šé‡ Pagination (åˆ†é¡µ) ç­–ç•¥**

- **é”™è¯¯åšæ³•:** ä½¿ç”¨ `skip: 1000`, `skip: 2000`... (æ€§èƒ½æå·®ï¼Œä¸” Graph æœ‰æœ€å¤§ skip é™åˆ¶)
- **æ­£ç¡®åšæ³•:** **Cursor-based Pagination (åŸºäºæ¸¸æ ‡çš„åˆ†é¡µ)**
  1. æŒ‰ `id` æ’åº
  2. è®°å½•æœ€åä¸€æ¡æ•°æ®çš„ `id`
  3. ä¸‹ä¸€æ¬¡æŸ¥è¯¢ä½¿ç”¨ `where: { id_gt: "Last_ID" }` (id greater than)

**ä¸ºä»€ä¹ˆ Cursor-based æ›´å¿«ï¼Ÿ**

- **Skip æ–¹å¼:** æ•°æ®åº“éœ€è¦æ‰«æå‰ N æ¡è®°å½•å†è·³è¿‡ï¼Œå¤æ‚åº¦ä¸º O(N)
- **Cursor æ–¹å¼:** åˆ©ç”¨ä¸»é”®ç´¢å¼•ç›´æ¥å®šä½ï¼Œå¤æ‚åº¦ä¸º O(log N) æˆ– O(1)

**ä»£ç å®ç°**

æˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªç‰ˆæœ¬çš„ä»£ç ï¼Œå¸®åŠ©ä½ æ·±å…¥ç†è§£åˆ†é¡µç­–ç•¥ï¼š

**1. å®Œæ•´å®ç°ç‰ˆæœ¬ï¼š** [graph_query.go](./graph_query.go)
- å®Œæ•´çš„ Cursor-based Pagination å®ç°
- åŒ…å«è¯¦ç»†çš„æ³¨é‡Šå’Œæ€§èƒ½ç»Ÿè®¡
- é€‚åˆç›´æ¥è¿è¡Œå’Œå‚è€ƒ

**2. æ€§èƒ½å¯¹æ¯”ç‰ˆæœ¬ï¼š** [graph_query_comparison.go](./graph_query_comparison.go)
- åŒæ—¶å®ç° Skip-based å’Œ Cursor-based ä¸¤ç§æ–¹å¼
- è‡ªåŠ¨å¯¹æ¯”æ€§èƒ½å·®å¼‚ï¼ˆè€—æ—¶ã€è¯·æ±‚æ¬¡æ•°ï¼‰
- **å¼ºçƒˆæ¨èè¿è¡Œ**ï¼Œç›´è§‚æ„Ÿå—æ€§èƒ½å·®å¼‚

**3. æŒ‘æˆ˜ç‰ˆæœ¬ï¼š** [graph_query_challenge.go](./graph_query_challenge.go)
- ä»£ç å¡«ç©ºç»ƒä¹ ï¼Œéœ€è¦ä½ å®Œæˆå…³é”®éƒ¨åˆ†
- åŒ…å« TODO æç¤ºï¼Œå¼•å¯¼ä½ æ€è€ƒ
- å®Œæˆåå¯ä»¥å¯¹æ¯”å®Œæ•´å®ç°ï¼ŒéªŒè¯ç†è§£

**æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š**

1. **å®šä¹‰æ•°æ®ç»“æ„ï¼š** æ ¹æ® GraphQL Schema å®šä¹‰ Go ç»“æ„ä½“
2. **æ„é€  GraphQL æŸ¥è¯¢ï¼š** ä½¿ç”¨ Cursor-based åˆ†é¡µç­–ç•¥
3. **å‘é€ HTTP è¯·æ±‚ï¼š** å°è£… GraphQL æŸ¥è¯¢ä¸º JSON è¯·æ±‚
4. **è§£æå“åº”ï¼š** å°† JSON å“åº”è§£æä¸º Go ç»“æ„ä½“
5. **æ›´æ–°æ¸¸æ ‡ï¼š** è®°å½•æœ€åä¸€æ¡æ•°æ®çš„ IDï¼Œç”¨äºä¸‹ä¸€æ¬¡æŸ¥è¯¢
6. **é€Ÿç‡æ§åˆ¶ï¼š** æ·»åŠ å»¶è¿Ÿé¿å…è§¦å‘ API Rate Limit

**å‰ç½®æ¡ä»¶ï¼š**

1. **è·å– API Keyï¼š**
   - è®¿é—® [The Graph Studio](https://thegraph.com/studio/) è·å–ä¸€ä¸ª API Key
   - æˆ–è€…ä½¿ç”¨å…¬å¼€çš„æµ‹è¯•ç½‘ URLï¼ˆä»£ç ä¸­å·²é…ç½®ï¼‰

2. **é…ç½®ä»£ç†ï¼ˆä¸­å›½å¤§é™†ç”¨æˆ·ï¼‰ï¼š**
   - å‚è€ƒ part1  

**å®æˆ˜ä»»åŠ¡ï¼š**

**æ­¥éª¤ 1ï¼šéªŒè¯ Subgraph è¿æ¥**
```bash
go run graph_query.go
```
ä»£ç ä¼šè‡ªåŠ¨è¿›è¡Œæµ‹è¯•æŸ¥è¯¢ï¼ŒéªŒè¯ Subgraph æ˜¯å¦å¯ç”¨ã€‚

**å¦‚æœé‡åˆ°è¿”å› 0 æ¡æ•°æ®çš„é—®é¢˜ï¼š**

1. **æ£€æŸ¥å®ä½“åç§°ï¼š** åœ¨ [Graph Explorer](https://thegraph.com/explorer/subgraphs/HUZDsRpEVP2AvzDCyzDHtdc64dyDxx8FQjzsmqSg4H3B?view=Query&chain=arbitrum-one) ä¸­æŸ¥çœ‹ Schemaï¼Œç¡®è®¤æ­£ç¡®çš„å®ä½“åç§°
   - å¯èƒ½æ˜¯ `pool` è€Œä¸æ˜¯ `pools`
   - å¯èƒ½æ˜¯ `pair` æˆ–å…¶ä»–åç§°

2. **æ£€æŸ¥æŸ¥è¯¢è¯­æ³•ï¼š** åœ¨ Graph Explorer ä¸­æ‰‹åŠ¨æµ‹è¯•æŸ¥è¯¢ï¼Œç¡®ä¿è¯­æ³•æ­£ç¡®

3. **å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼š** åœ¨ä»£ç ä¸­å°† `DEBUG_MODE = true`ï¼ŒæŸ¥çœ‹å®é™…æŸ¥è¯¢å’Œå“åº”

ç»“æœ
```bash
2026/01/27 23:23:24 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ° The Graph API
2026/01/27 23:23:24 âœ… ä»£ç†é…ç½®æˆåŠŸï¼Œå¼€å§‹è¿æ¥ The Graph API
ğŸ” æµ‹è¯•è¿æ¥...
âœ… è¿æ¥æˆåŠŸï¼Œæ‰¾åˆ° 1 ä¸ª Pool

ğŸš€ å¼€å§‹ä½¿ç”¨ Cursor-based Pagination å…¨é‡æ‹‰å– Uniswap Pools...
ğŸ’¡ æ ¸å¿ƒåŸç†ï¼šä½¿ç”¨ id_gt æ¡ä»¶ï¼Œåˆ©ç”¨æ•°æ®åº“ç´¢å¼•å®ç°é«˜æ•ˆåˆ†é¡µ

  [è¯·æ±‚ #1] è·å– 1000 æ¡ | èŒƒå›´: 0x000024feb2... ... 0x04d136bf0d...
  [è¯·æ±‚ #2] è·å– 1000 æ¡ | èŒƒå›´: 0x04d1b3513c... ... 0x09818325af...
  [è¯·æ±‚ #3] è·å– 1000 æ¡ | èŒƒå›´: 0x0981a5c074... ... 0x0e85672ac5...
  [è¯·æ±‚ #4] è·å– 1000 æ¡ | èŒƒå›´: 0x0e879863aa... ... 0x137f27a899...
  [è¯·æ±‚ #5] è·å– 1000 æ¡ | èŒƒå›´: 0x137f767100... ... 0x1849b0cc37...
  [è¯·æ±‚ #6] è·å– 1000 æ¡ | èŒƒå›´: 0x1849dff24c... ... 0x1cf0f48f45...
  [è¯·æ±‚ #7] è·å– 1000 æ¡ | èŒƒå›´: 0x1cf3db2309... ... 0x21e18a0063...
  [è¯·æ±‚ #8] è·å– 1000 æ¡ | èŒƒå›´: 0x21e415a466... ... 0x26ce569324...
  [è¯·æ±‚ #9] è·å– 1000 æ¡ | èŒƒå›´: 0x26ce863c25... ... 0x2b73ac13d1...
  [è¯·æ±‚ #10] è·å– 1000 æ¡ | èŒƒå›´: 0x2b776bc293... ... 0x309cd67390...
  [è¯·æ±‚ #11] è·å– 1000 æ¡ | èŒƒå›´: 0x309d54007b... ... 0x358a7e593d...
  [è¯·æ±‚ #12] è·å– 1000 æ¡ | èŒƒå›´: 0x358ac5b959... ... 0x3a988846fd...
  [è¯·æ±‚ #13] è·å– 1000 æ¡ | èŒƒå›´: 0x3a9c04ccde... ... 0x3f8d2fd65e...
  [è¯·æ±‚ #14] è·å– 1000 æ¡ | èŒƒå›´: 0x3f8eb867f6... ... 0x447de4d908...
  [è¯·æ±‚ #15] è·å– 1000 æ¡ | èŒƒå›´: 0x447dfacc8d... ... 0x496eb82c49...
  [è¯·æ±‚ #16] è·å– 1000 æ¡ | èŒƒå›´: 0x496f609da5... ... 0x4e8700440b...
  [è¯·æ±‚ #17] è·å– 1000 æ¡ | èŒƒå›´: 0x4e8bdc1e95... ... 0x53a08eafeb...
  [è¯·æ±‚ #18] è·å– 1000 æ¡ | èŒƒå›´: 0x53a0f0dc01... ... 0x586b75a0b4...
  [è¯·æ±‚ #19] è·å– 1000 æ¡ | èŒƒå›´: 0x586d395a01... ... 0x5cfd29e2a4...
  [è¯·æ±‚ #20] è·å– 1000 æ¡ | èŒƒå›´: 0x5cfe940225... ... 0x619d65f803...
  [è¯·æ±‚ #21] è·å– 1000 æ¡ | èŒƒå›´: 0x61a01596c3... ... 0x66db612413...
  [è¯·æ±‚ #22] è·å– 1000 æ¡ | èŒƒå›´: 0x66dca51245... ... 0x6bdf9d5379...
  [è¯·æ±‚ #23] è·å– 1000 æ¡ | èŒƒå›´: 0x6bdfd53db2... ... 0x70f36dcde0...
  [è¯·æ±‚ #24] è·å– 1000 æ¡ | èŒƒå›´: 0x70f3cc4e03... ... 0x75d83dc0d4...
  [è¯·æ±‚ #25] è·å– 1000 æ¡ | èŒƒå›´: 0x75d9433c93... ... 0x7ad5084dfe...
  [è¯·æ±‚ #26] è·å– 1000 æ¡ | èŒƒå›´: 0x7ad549ad6d... ... 0x7fbae575fc...
  [è¯·æ±‚ #27] è·å– 1000 æ¡ | èŒƒå›´: 0x7fbb47217a... ... 0x84aca18583...
  [è¯·æ±‚ #28] è·å– 1000 æ¡ | èŒƒå›´: 0x84ae4aa958... ... 0x899b776c9c...
  [è¯·æ±‚ #29] è·å– 1000 æ¡ | èŒƒå›´: 0x899cac70af... ... 0x8e5e9463e8...
  [è¯·æ±‚ #30] è·å– 1000 æ¡ | èŒƒå›´: 0x8e5f36db7c... ... 0x932aec20a4...
  [è¯·æ±‚ #31] è·å– 1000 æ¡ | èŒƒå›´: 0x932aed405e... ... 0x982f0114cc...
  [è¯·æ±‚ #32] è·å– 1000 æ¡ | èŒƒå›´: 0x982fc9ac1a... ... 0x9d563e1244...
  [è¯·æ±‚ #33] è·å– 1000 æ¡ | èŒƒå›´: 0x9d56b9b5fd... ... 0xa23780c506...
  [è¯·æ±‚ #34] è·å– 1000 æ¡ | èŒƒå›´: 0xa237a87157... ... 0xa725022c7b...
  [è¯·æ±‚ #35] è·å– 1000 æ¡ | èŒƒå›´: 0xa727b7ac5b... ... 0xabfa25a497...
  [è¯·æ±‚ #36] è·å– 1000 æ¡ | èŒƒå›´: 0xabfa6b8392... ... 0xb10adb35ea...
  [è¯·æ±‚ #37] è·å– 1000 æ¡ | èŒƒå›´: 0xb10bb5a061... ... 0xb5f713dffa...
  [è¯·æ±‚ #38] è·å– 1000 æ¡ | èŒƒå›´: 0xb5f7db69d7... ... 0xbade75b528...
  [è¯·æ±‚ #39] è·å– 1000 æ¡ | èŒƒå›´: 0xbadea2bd41... ... 0xbff73fb6da...
  [è¯·æ±‚ #40] è·å– 1000 æ¡ | èŒƒå›´: 0xbff7d64976... ... 0xc4ee13dcd8...
  [è¯·æ±‚ #41] è·å– 1000 æ¡ | èŒƒå›´: 0xc4ef688049... ... 0xc9e0d57049...
  [è¯·æ±‚ #42] è·å– 1000 æ¡ | èŒƒå›´: 0xc9e296ce0f... ... 0xced09871c0...
  [è¯·æ±‚ #43] è·å– 1000 æ¡ | èŒƒå›´: 0xced0b3dc00... ... 0xd3f7c1ecbf...
  [è¯·æ±‚ #44] è·å– 1000 æ¡ | èŒƒå›´: 0xd3f9027d12... ... 0xd91ebe6bf7...
  [è¯·æ±‚ #45] è·å– 1000 æ¡ | èŒƒå›´: 0xd91ef5e1cb... ... 0xde0400e931...
  [è¯·æ±‚ #46] è·å– 1000 æ¡ | èŒƒå›´: 0xde0520711f... ... 0xe2d07beda3...
  [è¯·æ±‚ #47] è·å– 1000 æ¡ | èŒƒå›´: 0xe2d0f0663a... ... 0xe7a8b008c0...
  [è¯·æ±‚ #48] è·å– 1000 æ¡ | èŒƒå›´: 0xe7a8d8feb1... ... 0xec54f76fc4...
  [è¯·æ±‚ #49] è·å– 1000 æ¡ | èŒƒå›´: 0xec5547ef03... ... 0xf1339dc0d5...
  [è¯·æ±‚ #50] è·å– 1000 æ¡ | èŒƒå›´: 0xf1345142ac... ... 0xf60aad7f73...
  [è¯·æ±‚ #51] è·å– 1000 æ¡ | èŒƒå›´: 0xf60afed42d... ... 0xfb012ebf4e...
  [è¯·æ±‚ #52] è·å– 977 æ¡ | èŒƒå›´: 0xfb04eef5a8... ... 0xfffec72482...

âœ… æ‹‰å–å®Œæˆï¼

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:
  - æ€»è®¡è·å–: 51977 ä¸ª Pool
  - è¯·æ±‚æ¬¡æ•°: 53 æ¬¡
  - æ€»è€—æ—¶: 2m35.4390977s
  - å¹³å‡è€—æ—¶: 2.932813164s/è¯·æ±‚

ğŸ’¡ ä¸ºä»€ä¹ˆ Cursor-based é«˜æ•ˆï¼Ÿ
  - åˆ©ç”¨æ•°æ®åº“ä¸»é”®ç´¢å¼•ï¼Œç›´æ¥å®šä½åˆ°æ¸¸æ ‡ä½ç½®
  - å¤æ‚åº¦: O(log N) æˆ– O(1)ï¼Œè€Œé O(N)
  - ä¸å—æ•°æ®æ€»é‡å½±å“ï¼Œæ€§èƒ½ç¨³å®š
```

**æ­¥éª¤ 2ï¼šè¿è¡Œæ€§èƒ½å¯¹æ¯”ï¼ˆæ¨èï¼‰**
```bash
go run graph_query_comparison.go
```
è§‚å¯Ÿä¸¤ç§æ–¹å¼çš„æ€§èƒ½å·®å¼‚ï¼Œç†è§£ä¸ºä»€ä¹ˆ Cursor-based æ›´å¿«ã€‚

æˆ‘çš„ç»“æœ
```bash
2026/01/27 23:52:09 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ° The Graph API
2026/01/27 23:52:09 âœ… ä»£ç†é…ç½®æˆåŠŸ

==============================================================

ğŸ”¬ æ€§èƒ½å¯¹æ¯”å®éªŒï¼šSkip vs Cursor-based Pagination
==============================================================


ğŸ“Š æ–¹å¼ 1: Skip-based Pagination (é”™è¯¯åšæ³•)
==============================================================
  [Skip 0] è·å– 1000 æ¡ï¼Œç´¯è®¡: 1000 æ¡
  [Skip 1000] è·å– 1000 æ¡ï¼Œç´¯è®¡: 2000 æ¡
  [Skip 2000] è·å– 1000 æ¡ï¼Œç´¯è®¡: 3000 æ¡
  [Skip 3000] è·å– 1000 æ¡ï¼Œç´¯è®¡: 4000 æ¡
  [Skip 4000] è·å– 1000 æ¡ï¼Œç´¯è®¡: 5000 æ¡

ğŸ“Š æ–¹å¼ 2: Cursor-based Pagination (æ­£ç¡®åšæ³•)
==============================================================
  [Cursor ...] è·å– 1000 æ¡ï¼Œç´¯è®¡: 1000 æ¡
  [Cursor 0x04d136...] è·å– 1000 æ¡ï¼Œç´¯è®¡: 2000 æ¡
  [Cursor 0x098183...] è·å– 1000 æ¡ï¼Œç´¯è®¡: 3000 æ¡
  [Cursor 0x0e8567...] è·å– 1000 æ¡ï¼Œç´¯è®¡: 4000 æ¡
  [Cursor 0x137f27...] è·å– 1000 æ¡ï¼Œç´¯è®¡: 5000 æ¡

==============================================================

ğŸ“ˆ æ€§èƒ½å¯¹æ¯”ç»“æœ
==============================================================

æ–¹å¼ 1 (Skip-based):
  - è·å–æ•°é‡: 5000 æ¡
  - è€—æ—¶: 15.8077893s
  - è¯·æ±‚æ¬¡æ•°: 5 æ¬¡
  - å¹³å‡è€—æ—¶: 3.16155786s/è¯·æ±‚

æ–¹å¼ 2 (Cursor-based):
  - è·å–æ•°é‡: 5000 æ¡
  - è€—æ—¶: 11.9199187s
  - è¯·æ±‚æ¬¡æ•°: 5 æ¬¡
  - å¹³å‡è€—æ—¶: 2.38398374s/è¯·æ±‚

==============================================================

ğŸ’¡ å…³é”®æ´å¯Ÿï¼š
  - Skip æ–¹å¼ï¼šæ•°æ®åº“éœ€è¦æ‰«æå‰ N æ¡è®°å½•ï¼Œå¤æ‚åº¦ O(N)
  - Cursor æ–¹å¼ï¼šåˆ©ç”¨ç´¢å¼•ç›´æ¥å®šä½ï¼Œå¤æ‚åº¦ O(log N) æˆ– O(1)
  - æ•°æ®é‡è¶Šå¤§ï¼Œæ€§èƒ½å·®å¼‚è¶Šæ˜æ˜¾
==============================================================
```

**æ­¥éª¤ 3ï¼šå®ŒæˆæŒ‘æˆ˜ç‰ˆæœ¬**
1. æ‰“å¼€ [graph_query_challenge.go](./graph_query_challenge.go)
2. æ ¹æ® TODO æç¤ºå®Œæˆä»£ç å¡«ç©º
3. è¿è¡ŒéªŒè¯æ˜¯å¦æ­£ç¡®

æˆ‘çš„ç»“æœ
```bash
2026/01/28 01:47:39 å¼€å§‹é…ç½®ä»£ç†å¹¶è¿æ¥åˆ° The Graph API
2026/01/28 01:47:39 âœ… ä»£ç†é…ç½®æˆåŠŸ
ğŸš€ å¼€å§‹æŸ¥è¯¢ Uniswap Pools...
ğŸ’¡ ç›®æ ‡ï¼šè·å– 500 æ¡ Pool æ•°æ®

âœ… è·å–æˆåŠŸï¼Pool æ•°é‡: 500
   ç¬¬ä¸€æ¡: 0x000024feb293b6c6c3a80a95f1f830a8746400b9 (TRUMP/WETH) feeTier=10000
   æœ€åä¸€æ¡: 0x0276ca2407968be347e266aee4aac2e783905569 (Bella /WETH) feeTier=10000

ğŸ‰ æŒ‘æˆ˜å®Œæˆï¼

ğŸ“Š ç»“æœç»Ÿè®¡:
  - æˆåŠŸè·å–: 500 ä¸ª Pool
  - âœ… è¾¾åˆ°ç›®æ ‡æ•°é‡ (500 æ¡)ï¼

ğŸ’¡ å…³é”®çŸ¥è¯†ç‚¹ï¼š
  1. GraphQL æŸ¥è¯¢è¯­æ³•ï¼šä½¿ç”¨ first é™åˆ¶æ•°é‡ï¼ŒorderBy æ’åº
  2. The Graph æ˜¯å»ä¸­å¿ƒåŒ–ç´¢å¼•ç½‘ç»œï¼Œå¯èƒ½å‡ºç°ä¸´æ—¶é”™è¯¯
  3. é‡è¯•æœºåˆ¶å¯ä»¥å¤„ç†ç½‘ç»œæ³¢åŠ¨å’Œç´¢å¼•å™¨è¶…æ—¶

ğŸ” è¿›ä¸€æ­¥å­¦ä¹ ï¼š
  - æŸ¥çœ‹ graph_query.go äº†è§£ Cursor-based Paginationï¼ˆåˆ†é¡µæŸ¥è¯¢ï¼‰
  - è¿è¡Œ graph_query_comparison.go å¯¹æ¯” Skip vs Cursor çš„æ€§èƒ½å·®å¼‚
```

**å¸¸è§é—®é¢˜æ’æŸ¥ï¼š**

**Q: ä¸ºä»€ä¹ˆè¿”å› 0 æ¡æ•°æ®ï¼Ÿ**

å¯èƒ½çš„åŸå› ï¼š
1. **Subgraph æ•°æ®é—®é¢˜ï¼š** Subgraph å¯èƒ½æ²¡æœ‰æ•°æ®ï¼Œæˆ–è€…æ•°æ®è¢«è¿‡æ»¤æ‰äº†
2. **å®ä½“åç§°é”™è¯¯ï¼š** å¯èƒ½ä¸æ˜¯ `pools`ï¼Œè€Œæ˜¯ `pool`ã€`pair` æˆ–å…¶ä»–åç§°
3. **æŸ¥è¯¢è¯­æ³•é—®é¢˜ï¼š** æŸäº› Subgraph å¯èƒ½éœ€è¦ç‰¹å®šçš„æŸ¥è¯¢æ ¼å¼

**è§£å†³æ–¹æ³•ï¼š**
1. åœ¨ [Graph Explorer](https://thegraph.com/explorer/subgraphs/HUZDsRpEVP2AvzDCyzDHtdc64dyDxx8FQjzsmqSg4H3B?view=Query&chain=arbitrum-one) ä¸­æ‰‹åŠ¨æµ‹è¯•æŸ¥è¯¢
2. æŸ¥çœ‹ Schema æ–‡æ¡£ï¼Œç¡®è®¤æ­£ç¡®çš„å®ä½“åç§°å’Œå­—æ®µ
3. å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆ`DEBUG_MODE = true`ï¼‰æŸ¥çœ‹å®é™…æŸ¥è¯¢å’Œå“åº”
4. æ£€æŸ¥ GraphQL é”™è¯¯ä¿¡æ¯ï¼ˆä»£ç å·²è‡ªåŠ¨æ‰“å°ï¼‰

**Q: ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸ç¨³å®šçš„ GraphQL é”™è¯¯ï¼Ÿ**

**æ ¸å¿ƒåŸå› ï¼šThe Graph çš„å»ä¸­å¿ƒåŒ–æ¶æ„**

The Graph ä½¿ç”¨**å»ä¸­å¿ƒåŒ–ç´¢å¼•ç½‘ç»œ**ï¼Œä½ çš„æŸ¥è¯¢ä¼šè¢«è·¯ç”±åˆ°å¤šä¸ª**ç´¢å¼•å™¨ï¼ˆIndexersï¼‰**ï¼š

```
ä½ çš„æŸ¥è¯¢ â†’ The Graph Gateway â†’ å¤šä¸ªç´¢å¼•å™¨ï¼ˆIndexer 1, 2, 3...ï¼‰
                                    â†“
                            æ¯ä¸ªç´¢å¼•å™¨ç‹¬ç«‹è¿è¡Œæ•°æ®åº“
```

**ä¸ºä»€ä¹ˆä¼šå‡ºç°é”™è¯¯ï¼Ÿ**

1. **ç´¢å¼•å™¨æ€§èƒ½å·®å¼‚ï¼š** ä¸åŒçš„ç´¢å¼•å™¨å¯èƒ½æœ‰ä¸åŒçš„ç¡¬ä»¶é…ç½®å’Œè´Ÿè½½
2. **æŸ¥è¯¢å¤æ‚åº¦ï¼š** å½“æŸ¥è¯¢å¤§é‡æ•°æ®æ—¶ï¼ŒæŸäº›ç´¢å¼•å™¨å¯èƒ½è¶…æ—¶
3. **æ•°æ®åº“è´Ÿè½½ï¼š** ç´¢å¼•å™¨çš„æ•°æ®åº“å¯èƒ½æ­£åœ¨å¤„ç†å…¶ä»–æŸ¥è¯¢ï¼Œå¯¼è‡´å“åº”æ…¢
4. **ç½‘ç»œé—®é¢˜ï¼š** ç´¢å¼•å™¨ä¹‹é—´çš„ç½‘ç»œè¿æ¥å¯èƒ½ä¸ç¨³å®š

**é”™è¯¯ç¤ºä¾‹ï¼š**
```
bad indexers: {
  0x2f09...: Timeout,
  0x32bb...: BadResponse(400),
  0xedca...: statement timeout
}
```

è¿™è¡¨ç¤ºï¼š3 ä¸ªç´¢å¼•å™¨éƒ½å¤±è´¥äº†ï¼ˆè¶…æ—¶æˆ–é”™è¯¯ï¼‰ï¼Œä½†è¿™æ˜¯**æ­£å¸¸ç°è±¡**ï¼

**è§£å†³æ–¹æ¡ˆï¼š**

ä»£ç å·²è‡ªåŠ¨å®ç°**é‡è¯•æœºåˆ¶**ï¼š
- æ£€æµ‹åˆ°è¶…æ—¶æˆ–ç´¢å¼•å™¨é”™è¯¯æ—¶ï¼Œè‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
- æ¯æ¬¡é‡è¯•é—´éš” 2 ç§’ï¼Œç»™ç´¢å¼•å™¨æ¢å¤æ—¶é—´
- å¦‚æœæ‰€æœ‰é‡è¯•éƒ½å¤±è´¥ï¼Œæ‰ä¼šæŠ¥é”™é€€å‡º

**æœ€ä½³å®è·µï¼š**
- âœ… ä½¿ç”¨é‡è¯•æœºåˆ¶ï¼ˆä»£ç å·²å®ç°ï¼‰
- âœ… é™ä½å•æ¬¡æŸ¥è¯¢çš„æ•°æ®é‡ï¼ˆå¦‚ `first: 500` è€Œé `first: 1000`ï¼‰
- âœ… å¢åŠ è¯·æ±‚é—´éš”ï¼ˆä»£ç ä¸­å·²è®¾ç½® 100msï¼‰
- âŒ ä¸è¦å› ä¸ºå¶å°”çš„é”™è¯¯å°±è®¤ä¸ºä»£ç æœ‰é—®é¢˜

**Q: ä¸ºä»€ä¹ˆæ€§èƒ½å¯¹æ¯”ä¸æ˜æ˜¾ï¼Ÿ**

å¯èƒ½çš„åŸå› ï¼š
1. **æ•°æ®é‡å¤ªå°ï¼š** å¦‚æœåªæŸ¥è¯¢å°‘é‡æ•°æ®ï¼Œæ€§èƒ½å·®å¼‚ä¸æ˜æ˜¾
2. **ç½‘ç»œå»¶è¿Ÿå ä¸»å¯¼ï¼š** ä»£ç†å»¶è¿Ÿå¯èƒ½æ©ç›–äº†æ•°æ®åº“æŸ¥è¯¢çš„å·®å¼‚
3. **Subgraph ä¼˜åŒ–ï¼š** æŸäº› Subgraph å¯èƒ½å¯¹ Skip åšäº†ä¼˜åŒ–

**è§£å†³æ–¹æ³•ï¼š**
- å°è¯•æŸ¥è¯¢æ›´å¤šæ•°æ®ï¼ˆä¿®æ”¹ `MAX_POOLS_TO_FETCH`ï¼‰
- ä½¿ç”¨æœ¬åœ°èŠ‚ç‚¹æˆ–æ›´å¿«çš„ç½‘ç»œç¯å¢ƒ
- å…³æ³¨è¯·æ±‚æ¬¡æ•°å’Œå¹³å‡è€—æ—¶ï¼Œè€Œéæ€»è€—æ—¶


**æ”¶è·:**
1. **ä¸ºä»€ä¹ˆ Cursor-based æ¯” Skip-based æ›´å¿«ï¼Ÿ**
   - Skip æ–¹å¼ï¼šæ•°æ®åº“éœ€è¦æ‰«æå‰ N æ¡è®°å½•å†è·³è¿‡ï¼Œå¤æ‚åº¦ä¸º O(N)
   - Cursor æ–¹å¼ï¼šåˆ©ç”¨ä¸»é”®ç´¢å¼•ç›´æ¥å®šä½ï¼Œå¤æ‚åº¦ä¸º O(log N) æˆ– O(1)
   - **å®é™…åœºæ™¯ï¼š** å½“ skip=10000 æ—¶ï¼Œæ•°æ®åº“éœ€è¦æ‰«æå‰ 10000 æ¡è®°å½•ï¼›è€Œ cursor æ–¹å¼ç›´æ¥å®šä½åˆ°æ¸¸æ ‡ä½ç½®

2. **ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ Cursor-basedï¼Ÿ**
   - éœ€è¦è·å–å¤§é‡æ•°æ®æ—¶ï¼ˆ> 1000 æ¡ï¼‰
   - æ•°æ®ä¼šå®æ—¶æ›´æ–°ï¼Œéœ€è¦ç¨³å®šçš„åˆ†é¡µç­–ç•¥
   - å¯¹æ€§èƒ½æœ‰è¦æ±‚çš„åœºæ™¯

3. **Cursor-based çš„é™åˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ**
   - å¿…é¡»æœ‰ä¸€ä¸ªå¯æ’åºçš„å”¯ä¸€å­—æ®µï¼ˆé€šå¸¸æ˜¯ idï¼‰
   - æ•°æ®å¿…é¡»æŒ‰è¯¥å­—æ®µæ’åº
   - ä¸èƒ½éšæœºè·³è½¬åˆ°ä»»æ„ä½ç½®

#### Week 4 Part2-Etherscan

##### RPC é¢ä¸´çš„é—®é¢˜

åœ¨ Part I ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´é€šè¿‡ Geth åº“å’Œä»¥å¤ªåŠèŠ‚ç‚¹æ‰“äº¤é“ã€‚ä¸ç®¡æ˜¯ `FilterLogs`ã€`Subscribe`ï¼Œè¿˜æ˜¯ `CallContract`ï¼Œå®é™…è°ƒç”¨çš„éƒ½æ˜¯æœ€åŸå§‹çš„ RPC æ¥å£ã€‚è¿™äº›æ¥å£å¾ˆåº•å±‚ï¼Œä¹Ÿå¾ˆçœŸå®ï¼Œå®ƒä»¬ç›´æ¥åæ˜ äº†â€œé“¾ä¸Šçš„çŠ¶æ€æ˜¯ä»€ä¹ˆâ€ã€‚

ä½†å½“ä½ å¼€å§‹å°è¯•åšä¸€äº›**ååˆ†æ**ã€**åç»Ÿè®¡**çš„äº‹æƒ…æ—¶ï¼Œå¾ˆå¿«å°±ä¼šå‘ç°ï¼Œå…‰é  RPC å»å®ç°é“¾ä¸Šæ•°æ®ç»Ÿè®¡, ä¼šéå¸¸çš„å¤æ‚ã€‚ä¸¾ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼šã€ŒæŸ¥è¯¢å“ªäº›åœ°å€æ›¾ç»è°ƒç”¨è¿‡æŸä¸€ä¸ªåˆçº¦ã€. è¿™ä¸ªé—®é¢˜æœ¬èº«å¹¶ä¸å¤æ‚ï¼Œä½†å¦‚æœåªç”¨ RPCï¼Œä½ ä¼šå‘ç°æ²¡æœ‰ä»»ä½•ä¸€ä¸ªæ¥å£èƒ½ç›´æ¥åšè¿™ä»¶äº‹ã€‚ä½ åªèƒ½ä»æŸä¸ªåŒºå—é«˜åº¦å¼€å§‹ï¼ŒæŠŠæ‰€æœ‰åŒºå—ã€æ‰€æœ‰äº¤æ˜“ä¸€ç¬”ä¸€ç¬”æ‰«ä¸‹æ¥ï¼Œç„¶ååˆ¤æ–­ `tx.to` æ˜¯ä¸æ˜¯ä½ å…³å¿ƒçš„åˆçº¦ã€‚è¿™ä¸ä»…å†™èµ·æ¥å¾ˆéº»çƒ¦ï¼Œè€Œä¸”éå¸¸æ…¢ã€‚

å¦å¤–ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚æ˜¯ï¼šã€Œæœ‰å“ªäº›äº¤æ˜“å‘æŸä¸ªåœ°å€è½¬è¿‡ ETHã€ã€‚*å¾ˆå¤š ETH çš„è½¬ç§»å¹¶ä¸æ˜¯ç›´æ¥å‘ç”Ÿåœ¨äº¤æ˜“çš„ `value` å­—æ®µé‡Œï¼Œè€Œæ˜¯å‘ç”Ÿåœ¨åˆçº¦å†…éƒ¨çš„è°ƒç”¨è¿‡ç¨‹ä¸­ã€‚è¿™ç±»â€œå†…éƒ¨è½¬è´¦â€å¹¶ä¸å­˜åœ¨äºåŒºå—æˆ–äº¤æ˜“çš„åŸºæœ¬ç»“æ„ä¸­ï¼ŒRPC å±‚æ˜¯æŸ¥ä¸åˆ°ä¸€ä¸ªâ€œinternal transfers åˆ—è¡¨â€çš„*ã€‚

è¿™äº›é—®é¢˜çš„å…±åŒç‚¹åœ¨äºï¼š**åŒºå—é“¾æœ¬èº«å¹¶ä¸æ˜¯ä¸ºâ€œæŸ¥è¯¢â€è®¾è®¡çš„ï¼Œè€Œæ˜¯ä¸ºâ€œæ‰§è¡Œâ€å’Œâ€œå…±è¯†â€è®¾è®¡çš„ã€‚**RPC èƒ½æä¾›çš„æ˜¯æ‰§è¡Œå±‚æ¥å£, ç”¨äºæŸ¥è¯¢é“¾ä¸Šçš„â€œçŠ¶æ€â€ï¼›è€Œä½ ç°åœ¨æƒ³åšçš„ï¼Œæ˜¯æ•°æ®åˆ†æã€‚è¿™æ ·å°±è‡ªç„¶è¯ç”Ÿå‡ºäº† Etherscan

##### Etherscan

ä½ å¯ä»¥æŠŠ Etherscan ç®€å•ç†è§£æˆï¼šæœ‰äººå¸®ä½ æŠŠæ•´æ¡é“¾çš„æ•°æ®åŒæ­¥ä¸‹æ¥ï¼Œç„¶å**æå‰æ›¿ä½ åšäº†å¤§é‡æ•´ç†å’Œç´¢å¼•çš„å·¥ä½œ**ã€‚å®ƒåšçš„äº‹æƒ…å¤§è‡´æ˜¯è¿™æ ·çš„ï¼šä»åˆ›ä¸–åŒºå—å¼€å§‹ï¼ŒæŒç»­åŒæ­¥æ–°åŒºå—ï¼›è§£æäº¤æ˜“ã€æ”¶æ®å’Œæ‰§è¡Œè¿‡ç¨‹ï¼›åŸºäºè¿™äº›ç»“æœï¼Œæ„å»ºå„ç§å¯ä»¥ç›´æ¥æŸ¥è¯¢çš„æ•°æ®è¡¨ï¼Œæ¯”å¦‚â€œæŸåœ°å€ç›¸å…³çš„æ‰€æœ‰äº¤æ˜“â€â€œæŸåˆçº¦çš„æ‰€æœ‰è°ƒç”¨â€â€œæŸåœ°å€å‘ç”Ÿçš„ ETH å†…éƒ¨è½¬è´¦â€ç­‰ç­‰ã€‚

å½“ä½ è°ƒç”¨ Etherscan API çš„æ—¶å€™ï¼Œä½ å…¶å®ä¸æ˜¯å»æŸ¥è¯¢åŒºå—é“¾çŠ¶æ€ï¼Œè€Œæ˜¯åœ¨æŸ¥è¯¢ä¸€ä¸ªæ•´ç†å¥½çš„æ•°æ®åº“ã€‚ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼ŒEtherscan èƒ½éå¸¸è½»æ¾åœ°å›ç­” RPC å¾ˆéš¾å›ç­”çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆšæ‰æåˆ°çš„ä¸¤ä¸ªä¾‹å­ã€‚å¯ä»¥ç›´æ¥æŸ¥è¯¢ä¸åˆçº¦ç›¸å…³çš„æ‰€æœ‰äº¤æ˜“ï¼Œè€Œä¸éœ€è¦è‡ªå·±å»æ‰«åŒºå—ï¼›ä¹Ÿå¯ä»¥ç›´æ¥æŸ¥è¯¢æŸä¸ªåœ°å€ç›¸å…³çš„ internal transactionã€‚

å½“ç„¶ï¼Œè¿™ç§ä¾¿åˆ©ä¹Ÿæœ‰ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„å‰æï¼š**Etherscan æ˜¯ä¸€ä¸ªä¸­å¿ƒåŒ–ç³»ç»Ÿã€‚**è¿™äº›æ•°æ®ä¸æ˜¯å…±è¯†çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ Etherscan æ ¹æ®è‡ªå·±çš„è§£æé€»è¾‘ç®—å‡ºæ¥çš„ç»“æœã€‚è¿™ä¸€ç‚¹åœ¨åé¢çš„å°èŠ‚é‡Œæˆ‘ä»¬è¿˜ä¼šä¸“é—¨å†å›åˆ°ã€‚

##### Etherscan API

è¦ä½¿ç”¨ Etherscan APIï¼Œéœ€è¦åœ¨å…¶ç½‘ç«™æ³¨å†Œè´¦å·å¹¶ç”³è¯· APIï¼ŒAPI æœ‰å…è´¹çš„é¢åº¦ã€‚

æ³¨å†Œå¹¶ç™»é™†åˆ° [https://etherscan.io/](https://etherscan.io/)ï¼š

![æˆªå±2025-12-10 20.04.27.png](./week4/Part2-Etherscan/Etherscan/%E6%88%AA%E5%B1%8F2025-12-10_20.04.27.png)

åˆ›å»ºä¸€ä¸ª API Key

![æˆªå±2025-12-10 20.06.58.png](./week4/Part2-Etherscan/Etherscan/%E6%88%AA%E5%B1%8F2025-12-10_20.06.58.png)

Etherscan ä½¿ç”¨çš„æ˜¯ HTTP APIã€‚æ¯æ¬¡è¯·æ±‚æ—¶ï¼Œåªéœ€è¦åœ¨å‚æ•°ä¸­å¸¦ä¸Š `apikey` å­—æ®µå³å¯

##### `txlist`

å‡è®¾ä½ æƒ³æŸ¥è¯¢å“ªäº› EOA åœ°å€æ›¾ç»ä¸ Uniswap V2 çš„ä¸€ä¸ªæµåŠ¨æ€§æ± åˆçº¦äº’åŠ¨è¿‡ï¼ˆæ¯”å¦‚ USDC-ETH æ± çš„åœ°å€ï¼š0xb4e16d0168e52d35cacd2c6185b44281ec28c9dcï¼‰ã€‚è¿™äº›äº’åŠ¨åŒ…æ‹¬æä¾›æµåŠ¨æ€§æˆ–äº¤æ¢ä»£å¸ï¼Œä½ å¯ä»¥ç”¨ â€œtxlistâ€ æ¥å£ç›´æ¥æ‹‰å–æ‰€æœ‰ä»¥è¿™ä¸ªæ± ä½œä¸ºâ€œtoâ€çš„äº¤æ˜“åˆ—è¡¨ï¼Œç„¶åä»ä¸­æå–å”¯ä¸€çš„â€œfromâ€ åœ°å€ã€‚å¦‚æœä½¿ç”¨ RPC å®ç°ï¼Œä¼šéå¸¸éº»çƒ¦ï¼Œè€Œ Etherscan å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ `txlist` æ¥å£ã€‚

ç”±äº Etherscan æä¾›çš„æ˜¯ HTTP æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥æ— éœ€å†™ä»£ç ï¼Œç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…· `curl` ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š

```bash
curl "https://api.etherscan.io/v2/api?\
chainid=1&\
module=account&\
action=txlist&\
address=0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc&\
startblock=23974499&\
sort=asc&\
page=1&\
offset=100&\
apikey=YF2WA7IQCDKSCE11J2H94D6G7NEYZSU4ZX"
```

å…¶ä¸­ï¼š

- `chainid=1`ï¼šè¡¨ç¤ºæŸ¥è¯¢ä»¥å¤ªåŠä¸»ç½‘
- `module=account`ï¼šå½“å‰æŸ¥è¯¢çš„æ˜¯å’Œè´¦æˆ·ç›¸å…³çš„æ•°æ®
- `action=txlist`ï¼šæŸ¥è¯¢æ™®é€šäº¤æ˜“åˆ—è¡¨
- `address=...`ï¼šè¦æŸ¥è¯¢çš„åœ°å€
- `startblock` / `endblock`ï¼šæŸ¥è¯¢çš„åŒºå—èŒƒå›´
- `sort=asc`ï¼šæŒ‰åŒºå—é«˜åº¦ä»ä½åˆ°é«˜æ’åº
- `apikey`ï¼šä½ çš„ Etherscan API Key
- è¯¥æ¥å£çš„è¯¦ç»†å‚æ•°ï¼šé˜…è¯» [https://docs.etherscan.io/api-reference/endpoint/txlist](https://docs.etherscan.io/api-reference/endpoint/txlist)

PowerShellç‰ˆæœ¬
```powershell
$uri = @"
https://api.etherscan.io/v2/api?
chainid=1&
module=account&
action=txlist&
address=0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc&
startblock=23974499&
sort=asc&
page=1&
offset=100&
apikey=YF2WA7IQCDKSCE11J2H94D6G7NEYZSU4ZX
"@ -replace '\s+', ''

curl.exe $uri |
  ConvertFrom-Json |
  ConvertTo-Json -Depth 100 |
  Out-Host -Paging
```
- curl.exe æ‹‰åˆ°åŸå§‹ JSON
- ConvertFrom-Json è§£ææˆå¯¹è±¡
- ConvertTo-Json é‡æ–°æ ¼å¼åŒ–ï¼ˆç¼©è¿›/æ¢è¡Œï¼‰
- -Depth 100 æ˜¯ä¸ºäº†é˜²æ­¢å¯¹è±¡å±‚çº§æ·±æ—¶è¢«æˆªæ–­ï¼ˆPowerShell é»˜è®¤æ·±åº¦è¾ƒå°ï¼‰ã€‚
- Out-Host -Paging çš„ä½œç”¨æ˜¯ï¼šæŠŠè¾“å‡ºå˜æˆâ€œåˆ†é¡µæ˜¾ç¤ºâ€ï¼Œç±»ä¼¼ Linux çš„ lessã€‚

å¦‚æœè¯·æ±‚æˆåŠŸï¼Œä¼šå¾—åˆ°ä¸€æ®µ JSON è¿”å›ï¼Œå¤§è‡´æ˜¯è¿™æ ·çš„ç»“æ„ï¼š

```json
{
  "status": "1",
  "message": "OK",
  "result": [
      {
          "blockNumber": "23974499",
          "blockHash": "0xbaabc8efcc9fded2cffbf86adedde0bed6afe12ece63c9610e7c1a257b298427",
          "timeStamp": "1765274591",
          "hash": "0x7303729a35c16b76fdca36ca3fca9808f13e48dd84fcf74bc1fb2fd1610d9587",
          "nonce": "183",
          "transactionIndex": "172",
          "from": "0xa415e5ddf7f3411cd80d1199f2eb01d1f4978f6f",
          "to": "0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc",
          "value": "0",
          "gas": "26829",
          "gasPrice": "243484710",
          "input": "0x095ea7b30000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488dffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
          "methodId": "0x095ea7b3",
          "functionName": "approve(address _spender, uint256 _value)",
          "contractAddress": "",
          "cumulativeGasUsed": "17501803",
          "txreceipt_status": "1",
          "gasUsed": "26486",
          "confirmations": "15417",
          "isError": "0"
      },
      {
          "blockNumber": "23974551",
          "blockHash": "0x4ab1aca5b3572a06de6a49ec25eef1e23be9ec6ad00c6ac8f7ff5bd7d0dcd3f6",
          "timeStamp": "1765275215",
          "hash": "0x6683bee64d79b637507bcb6804fae714a272ffc650b0a96ba5b1fdf7e5a467cd",
          "nonce": "355",
          "transactionIndex": "58",
          "from": "0x059b254553bb97ca61a99c2bbdbefb594aa94365",
          "to": "0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc",
          "value": "0",
          "gas": "69666",
          "gasPrice": "1255362667",
          "input": "0x095ea7b30000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d00000000000000000000000000000000000000000000000000000003d41e1781",
          "methodId": "0x095ea7b3",
          "functionName": "approve(address _spender, uint256 _value)",
          "contractAddress": "",
          "cumulativeGasUsed": "5581061",
          "txreceipt_status": "1",
          "gasUsed": "46062",
          "confirmations": "15365",
          "isError": "0"
      },
      ...
   ]
}
```

è¿™é‡Œè¿”å›çš„ â€œresultâ€ æ˜¯ä¸€ä¸ªäº¤æ˜“æ•°ç»„ï¼Œæ¯ç¬”äº¤æ˜“éƒ½åŒ…å«äº†è¯¦ç»†çš„ä¿¡æ¯ï¼Œæ¯”å¦‚åŒºå—å·ã€æ—¶é—´æˆ³ã€äº¤æ˜“å“ˆå¸Œã€å‘é€æ–¹ã€æ¥æ”¶æ–¹ã€è½¬è´¦é‡‘é¢ï¼ˆä»¥ wei ä¸ºå•ä½ï¼‰ã€gas æ¶ˆè€—ç­‰ã€‚æ³¨æ„ï¼Œå¦‚æœæœ‰é”™è¯¯ï¼Œâ€œstatusâ€ä¼šå˜æˆâ€œ0â€ï¼Œå¹¶åœ¨â€œmessageâ€ä¸­è§£é‡ŠåŸå› ï¼Œæ¯”å¦‚â€œNOTOKâ€æˆ–å…·ä½“çš„é™é¢æç¤ºã€‚ä»ç»“æœä¸­ï¼Œä½ å¯ä»¥è¿‡æ»¤â€œtoâ€ç­‰äºæ± åœ°å€ä¸”â€œisError=0â€çš„è®°å½•ï¼Œæå–â€œfromâ€ä½œä¸ºäº’åŠ¨çš„ EOAã€‚è¿”å›çš„ result æ•°ç»„ï¼Œå’Œä½ åœ¨ç½‘ç«™ä¸­çœ‹åˆ°çš„æ•°æ®[https://etherscan.io/address/0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc](https://etherscan.io/address/0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc) ï¼Œåº”è¯¥æ˜¯ä¸€è‡´çš„ã€‚

![æˆªå±2025-12-11 22.41.33.png](./week4/Part2-Etherscan/Etherscan/%E6%88%AA%E5%B1%8F2025-12-11_22.41.33.png)

ä½†æ˜¯ä½ å‘ç°ï¼Œä½œä¸ºå¦‚æ­¤å¸¸ç”¨çš„ä¸€ä¸ªæµåŠ¨æ€§æ± ï¼Œäº¤æ˜“è®°å½•å´éå¸¸å°‘ã€‚è¿™ä¸æ˜¯å› ä¸ºè¿™ä¸ªæ± å­ä¸æ´»è·ƒï¼Œè€Œæ˜¯å› ä¸º Uniswap çš„æœºåˆ¶è®¾è®¡å’Œä½¿ç”¨æ–¹å¼ã€‚Uniswap V2 æ˜¯ä¸€ä¸ªå»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼ˆDEXï¼‰ï¼Œå…è®¸ç”¨æˆ·åœ¨æ²¡æœ‰ä¸­å¿ƒåŒ–è®¢å•ç°¿çš„æƒ…å†µä¸‹äº¤æ¢ ERC-20 ä»£å¸ã€‚ERC-20 æ˜¯ä»¥å¤ªåŠä¸Šæœ€å¸¸è§çš„ä»£å¸æ ‡å‡†ï¼Œå®šä¹‰äº†ä»£å¸åˆçº¦çš„åŸºæœ¬æ¥å£ï¼Œæ¯”å¦‚ transferï¼ˆè½¬è´¦ï¼‰ã€balanceOfï¼ˆæŸ¥è¯¢ä½™é¢ï¼‰å’Œ approveï¼ˆæˆæƒä»–äººä½¿ç”¨ä»£å¸ï¼‰ã€‚åœ¨ Uniswap ä¸­ï¼Œæ¯ä¸ªäº¤æ˜“å¯¹ï¼ˆä¾‹å¦‚ USDC-ETHï¼‰éƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„ Pair åˆçº¦ï¼Œè¿™ä¸ªåˆçº¦æœ¬èº«å°±æ˜¯ä¸€ä¸ªèµ„é‡‘æ± ï¼ŒæŒæœ‰ä¸¤ç§ä»£å¸çš„å‚¨å¤‡å¹¶è´Ÿè´£å¤„ç† swap å’Œ addLiquidity ç­‰æ“ä½œã€‚ç†è®ºä¸Šï¼Œç”¨æˆ·ä¸è¯¥åˆçº¦çš„æ¯ä¸€æ¬¡äº¤äº’éƒ½å±äºæ™®é€šå¤–éƒ¨äº¤æ˜“ï¼Œå› æ­¤åº”è¯¥å‡ºç°åœ¨æ± åœ°å€çš„ txlist ä¸­ã€‚ç„¶è€Œï¼ŒæŸ¥è¯¢ç»“æœä¹‹æ‰€ä»¥æœ‰æ—¶æ˜¾å¾—å¾ˆå°‘ï¼ŒåŸå› å¹¶ä¸æ˜¯æ± ä¸æ´»è·ƒï¼Œè€Œæ˜¯å› ä¸ºå®é™…äº¤äº’è·¯å¾„å¾€å¾€æ¯”æƒ³è±¡ä¸­é—´æ¥å¾—å¤šã€‚

åœ¨ Uniswap V2 çš„è®¾è®¡ä¸­ï¼Œå¤§å¤šæ•°ç”¨æˆ·å¹¶ä¸ä¼šç›´æ¥è°ƒç”¨ Pair åˆçº¦ã€‚ç›¸åï¼Œä»–ä»¬é€šå¸¸é€šè¿‡ Uniswap Router åˆçº¦å®Œæˆ swap æˆ–æ·»åŠ æµåŠ¨æ€§ã€‚ç”¨æˆ·æäº¤çš„äº¤æ˜“æ˜¯å‘å¾€ Router çš„ï¼ŒRouter å†åœ¨åˆçº¦å†…éƒ¨è°ƒç”¨ Pairã€‚å¯¹é“¾ä¸Šæ¥è¯´ï¼ŒRouter â†’ Pair å±äºå†…éƒ¨è°ƒç”¨ï¼ŒEtherscan çš„ txlist åªæ˜¾ç¤ºé¡¶å±‚å¤–éƒ¨äº¤æ˜“ï¼Œå› æ­¤è¿™äº›å†…éƒ¨è°ƒç”¨ä¸ä¼šå‡ºç°åœ¨ Pair çš„â€œTransactionsâ€åˆ—è¡¨ä¸­ã€‚ç»“æœå°±æ˜¯ï¼šå°½ç®¡æ± å­å‚ä¸äº†å¤§é‡ swapï¼Œä½† txlist å´åªæ˜¾ç¤ºæå°‘æ•°ç›´æ¥ä¸ Pair äº¤äº’çš„äº¤æ˜“ï¼Œä¾‹å¦‚å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨ Pair æˆ–è€å¼è„šæœ¬ç»•è¿‡ Router æ—¶çš„äº¤äº’ã€‚é™¤äº†å®˜æ–¹ Routerï¼Œé“¾ä¸Šè¿˜æœ‰å¤§é‡èšåˆå™¨ï¼ˆå¦‚ 1inchã€Matchaã€Paraswap ç­‰ï¼‰ï¼Œå®ƒä»¬çš„è°ƒç”¨è·¯å¾„æ›´å¤æ‚ï¼šç”¨æˆ·å…ˆè°ƒç”¨èšåˆå™¨æ™ºèƒ½åˆçº¦ï¼Œèšåˆå™¨å†è°ƒç”¨ Router æˆ–ç›´æ¥è°ƒç”¨å¤šä¸ª Pairã€‚æ‰€æœ‰è¿™äº›å±‚å±‚åµŒå¥—çš„å†…éƒ¨è°ƒç”¨ä¹ŸåŒæ ·ä¸ä¼šè®°å½•åœ¨ Pair çš„ txlist é‡Œï¼Œä½¿å¾—è¡¨é¢ä¸Šçœ‹æ± ä¼¼ä¹â€œä¸å¤ªæ´»è·ƒâ€ã€‚

æ­¤å¤–ï¼ŒETH åœ¨ Uniswap ä½“ç³»ä¸­é€šå¸¸ä»¥ WETH çš„å½¢å¼å‚ä¸äº¤æ˜“ï¼Œå› ä¸º Pair åˆçº¦åªèƒ½å¤„ç† ERC-20 ä»£å¸ã€‚è¿™æ„å‘³ç€å®é™…çš„ä»·å€¼æµåŠ¨å¤§å¤šä¸æ˜¯ native ETH è½¬è´¦ï¼Œè€Œæ˜¯ WETH æˆ–å…¶ä»– ERC-20 çš„ transferï¼Œè¿™äº›ä¼šå‡ºç°åœ¨ Etherscan çš„â€œERC20 Token Txnsâ€é¡µé¢ï¼Œè€Œä¸æ˜¯æ™®é€šäº¤æ˜“åˆ—è¡¨ã€‚ç»¼ä¸Šï¼Œå½“ä½ é¢„æœŸçœ‹åˆ°å¤§é‡æ± å­äº¤äº’å´åªåœ¨ txlist ä¸­çœ‹åˆ°å¯¥å¯¥æ•°ç¬”æ—¶ï¼Œè¿™å¾€å¾€ä¸æ˜¯æ•°æ®ç¼ºå¤±ï¼Œè€Œæ˜¯å› ä¸ºæŸ¥è¯¢å¯¹è±¡åªæ•æ‰äº†å¤–å±‚äº¤æ˜“ï¼Œè€Œ Uniswap çš„æ¶æ„ï¼ˆRouterã€èšåˆå™¨ã€ERC-20 åŒ…è£…æœºåˆ¶ï¼‰æ˜¾è‘—å‡å°‘äº†ç›´æ¥å†™åœ¨ Pair åˆçº¦ä¸Šçš„â€œé¡¶å±‚â€äº¤æ˜“è®°å½•ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨åˆ†æ DEX è¡Œä¸ºæ—¶ï¼Œå¾€å¾€éœ€è¦æ›´ç²¾ç»†çš„é“¾ä¸Šæ•°æ®å·¥å…·æ¥è¿½è¸ªå†…éƒ¨è°ƒç”¨ä¸äº‹ä»¶æ—¥å¿—ï¼Œæ¯”å¦‚ `txlistinternal` æ¥å£ã€‚

##### `txlistinternal`

ç°åœ¨ï¼Œæˆ‘ä»¬çœ‹çœ‹æ¥å£ï¼šâ€œtxlistinternalâ€ã€‚è¿™ä¹Ÿæ˜¯â€œmodule=accountâ€ä¸‹çš„ä¸€ä¸ª actionï¼Œä½†å®ƒä¸“é—¨æŸ¥è¯¢â€œå†…éƒ¨äº¤æ˜“â€ï¼Œä¹Ÿå°±æ˜¯åˆçº¦æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„ ETH è½¬ç§»ã€‚è¿™äº›è½¬ç§»ä¸ç›´æ¥å‡ºç°åœ¨äº¤æ˜“çš„é¡¶å±‚ç»“æ„ä¸­ï¼Œè€Œæ˜¯éšè—åœ¨æ‰§è¡Œç—•è¿¹ï¼ˆtraceï¼‰é‡Œã€‚Etherscan å¸®ä½ è§£æäº†è¿™äº›ï¼Œæ‰€ä»¥ä½ èƒ½ç›´æ¥æ‹¿åˆ°ã€‚

ä»€ä¹ˆæ˜¯ internal transactionï¼Ÿç®€å•è¯´ï¼Œå®ƒæ˜¯åˆçº¦æ‰§è¡Œä¸­æ¶‰åŠ native ETH è½¬ç§»çš„å­è°ƒç”¨ï¼Œæ¯”å¦‚é€šè¿‡ EVM çš„ CALL opcode å‘é€ ETHï¼ˆvalue > 0ï¼‰ï¼Œæˆ– CREATEï¼ˆåˆ›å»ºåˆçº¦ï¼‰ã€SELFDESTRUCTï¼ˆåˆçº¦è‡ªæ¯ï¼‰è¿™æ ·çš„æ“ä½œã€‚è¿™äº›æ˜¯ä»äº¤æ˜“çš„æ‰§è¡Œè·¯å¾„ä¸­è§£æå‡ºæ¥çš„ï¼Œåœ¨ Etherscan çš„å¦ä¸€ä¸ª tab ä¸‹ï¼ˆ**Internal Transactionsï¼‰**ã€‚

ä¸ºä»€ä¹ˆè¿™ä¸ªæ¥å£é‡è¦ï¼Ÿå›æƒ³æˆ‘ä»¬å¼€å¤´çš„ä¾‹å­ï¼šå¦‚æœä½ æƒ³çŸ¥é“â€œæœ‰å“ªäº›äº¤æ˜“å‘æŸä¸ªåœ°å€è½¬è¿‡ ETHâ€ï¼Œä½†è¿™äº›è½¬è´¦å¯èƒ½æ˜¯ä»åˆçº¦å†…éƒ¨å‘å‡ºçš„ï¼Œæ¯”å¦‚ä¸€ä¸ª DEX çš„è·¯ç”±åˆçº¦åœ¨ swap åæŠŠ ETH è½¬ç»™ä½ ï¼Œè¦æŸ¥è¯¢è¿™ä¸ªä½¿ç”¨ RPC æ˜¯éå¸¸å›°éš¾çš„ï¼Œè€Œ Etherscan å°±æä¾›äº†å¾ˆå¥½çš„æ¥å£ã€‚

è¦ç†è§£ internal transaction çš„å®é™…åº”ç”¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç»å…¸çš„å†å²äº‹ä»¶ï¼šThe DAO äº‹ä»¶ã€‚2016 å¹´ï¼ŒThe DAO æ˜¯ä¸€ä¸ªæ—©æœŸçš„å»ä¸­å¿ƒåŒ–è‡ªæ²»ç»„ç»‡ï¼ˆDAOï¼‰ï¼Œå®ƒé€šè¿‡æ™ºèƒ½åˆçº¦ç­¹é›†äº†å¤§é‡ ETHï¼ˆå½“æ—¶ä»·å€¼è¶…è¿‡ 1.5 äº¿ç¾å…ƒï¼‰ï¼Œå…è®¸å‚ä¸è€…æŠ•ç¥¨æŠ•èµ„é¡¹ç›®ã€‚ä½†ç”±äºåˆçº¦ä»£ç æ¼æ´ï¼Œé»‘å®¢åˆ©ç”¨é€’å½’è°ƒç”¨æ”»å‡»ï¼ˆreentrancy attackï¼‰çªƒå–äº†çº¦ 360 ä¸‡ ETHã€‚è¿™å¯¼è‡´ä»¥å¤ªåŠç¤¾åŒºåˆ†è£‚ï¼Œæœ€ç»ˆé€šè¿‡ç¡¬åˆ†å‰ï¼ˆhard forkï¼‰åˆ›å»ºäº† Ethereumï¼ˆETHï¼‰å’Œ Ethereum Classicï¼ˆETCï¼‰ã€‚ä¸ºäº†è®©å—å®³è€…å–å›èµ„é‡‘ï¼Œä»¥å¤ªåŠå›¢é˜Ÿéƒ¨ç½²äº†ä¸€ä¸ªé€€æ¬¾åˆçº¦ï¼šWithdrawDAOï¼ˆåœ°å€ï¼š0xbf4ed7b27f1d666546e30d74d50d173d20bca754ï¼‰ã€‚WithdrawDAO çš„é€€æ¬¾æœºåˆ¶å¾ˆç®€å•ï¼šå®ƒæŒæœ‰è¢«ç›—çš„ ETHï¼Œç”¨æˆ·ï¼ˆåŸ DAO æŒæœ‰è€…ï¼‰å¯ä»¥è°ƒç”¨ withdraw å‡½æ•°ï¼Œåˆçº¦é€šè¿‡å†…éƒ¨è°ƒç”¨å‘é€ ETH åˆ°è°ƒç”¨è€…çš„åœ°å€ã€‚è¿™ä¸ªå‘é€å°±æ˜¯å¸¦ value çš„ CALL æ“ä½œï¼Œå½¢æˆ internal transactionã€‚ç”¨æˆ·ä¸ç›´æ¥è½¬è´¦åˆ°åˆçº¦ï¼Œè€Œæ˜¯è§¦å‘åˆçº¦å†…éƒ¨åˆ†å‘ ETHã€‚å³ä½¿åˆ°ç°åœ¨ï¼Œè¿™ä¸ªåˆçº¦ä»æ´»è·ƒï¼Œç”¨æˆ·å¶å°”è¿˜ä¼šæå–å‰©ä½™èµ„é‡‘ã€‚

å‡è®¾æˆ‘ä»¬æƒ³æŸ¥è¯¢æœ€è¿‘é€€æ¬¾çš„åœ°å€â€”â€”ä¹Ÿå°±æ˜¯æ‰¾å‡ºå“ªäº› EOA æœ€è¿‘ä» WithdrawDAO æ”¶åˆ° internal ETH ï¼Œå³[https://etherscan.io/address/0xbf4ed7b27f1d666546e30d74d50d173d20bca754#internaltx](https://etherscan.io/address/0xbf4ed7b27f1d666546e30d74d50d173d20bca754#internaltx)ã€‚æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨ `txlistinternal` æ¥å£ã€‚

```bash
curl "https://api.etherscan.io/v2/api?\
chainid=1&\
module=account&\
action=txlistinternal&\
address=0xBf4eD7b27F1d666546E30D74d50d173d20bca754&\
startblock=23655563&\
sort=desc&\
apikey=YF2WA7IQCDKSCE11J2H94D6G7NEYZSU4ZX"
```

PowerShellç‰ˆæœ¬
```powershell
$uri = @"
https://api.etherscan.io/v2/api?
chainid=1&
module=account&
action=txlistinternal&
address=0xBf4eD7b27F1d666546E30D74d50d173d20bca754&
startblock=23655563&
sort=desc&
apikey=YF2WA7IQCDKSCE11J2H94D6G7NEYZSU4ZX
"@ -replace '\s+', ''

curl.exe $uri |
  ConvertFrom-Json |
  ConvertTo-Json -Depth 100 |
  Out-Host -Paging
```

å¯ä»¥å¾—åˆ°ç±»ä¼¼çš„ç»“æœï¼š

```json
{
    "status": "1",
    "message": "OK",
    "result": [
        {
            "blockNumber": "23977587",
            "timeStamp": "1765312067",
            "hash": "0x8a0276533e453db86b0d1845b29f0dd60b164c922e3a72ec91edb12b239b9865",
            "from": "0xbf4ed7b27f1d666546e30d74d50d173d20bca754",
            "to": "0x30213bca208f1d284156d820575c14d412fed780",
            "value": "91666666666666666",
            "contractAddress": "",
            "input": "",
            "type": "call",
            "gas": "2300",
            "gasUsed": "0",
            "traceId": "0_1",
            "isError": "0",
            "errCode": ""
        },
        {
            "blockNumber": "23839011",
            "timeStamp": "1763626655",
            "hash": "0xf4ab4582e39b9db0cef9d561692e37cad5dd9563b5ec0644640cb22bde0aee78",
            "from": "0xbf4ed7b27f1d666546e30d74d50d173d20bca754",
            "to": "0x009d960a7eb81292ad5459ce916c540acebdece0",
            "value": "40000000000000000000",
            "contractAddress": "",
            "input": "",
            "type": "call",
            "gas": "2300",
            "gasUsed": "0",
            "traceId": "0_1",
            "isError": "0",
            "errCode": ""
        }
    ]
}
```

å…¶ä¸­æ¯ä¸ªæ¡ç›®ä»£è¡¨ä¸€æ¬¡é€€æ¬¾ï¼Œâ€œfromâ€ æ˜¯ WithdrawDAOï¼Œâ€œtoâ€ æ˜¯æ¥æ”¶è€… EOAï¼Œâ€œvalueâ€ æ˜¯è½¬å‡ºçš„ ETH é‡ï¼ˆwei å•ä½ï¼Œè½¬æˆ ETH éœ€é™¤ä»¥ 10^18ï¼‰ï¼Œâ€œtype=callâ€ è¡¨ç¤ºè¿™æ˜¯ ETH å‘é€è°ƒç”¨ï¼Œâ€œisError=0â€ æ„å‘³ç€æˆåŠŸã€‚

##### Follow Up

å‚è€ƒ API æ–‡æ¡£ [https://docs.etherscan.io/api-reference/endpoint/tokentx](https://docs.etherscan.io/api-reference/endpoint/tokentx)ã€‚è·å–åˆçº¦ 0xb4e16d0168e52d35cacd2c6185b44281ec28c9dc

+ åœ¨ 12 æœˆ 1 æ—¥çš„æ‰€æœ‰ ERC20 äº¤æ˜“ï¼Œå¦‚æœå•æ¬¡è¯·æ±‚è¿”å›çš„æ•°æ®è¿‡å¤§ï¼Œè€ƒè™‘ä½¿ç”¨ page å’Œ offset å‚æ•°æ¥åˆ†é¡µå¤„ç†ã€‚
+ åœ¨ 7 æœˆ ï½ 11 æœˆï¼Œå››ä¸ªæœˆçš„æ‰€æœ‰ ECR20 äº¤æ˜“ï¼Œç»Ÿè®¡æ”¶åˆ° Token çš„æ‰€æœ‰åœ°å€ï¼Œå› ä¸ºæ•°æ®é‡ä¼šå¾ˆå¤§ï¼Œæ‰‹åŠ¨å†™ `curl` è¯·æ±‚å·²ç»ä¸ç°å®ã€‚è€ƒè™‘ä½¿ç”¨ç¼–ç¨‹è¯­è¨€è°ƒç”¨ HTTP æ¥å£ï¼Œæ¨èä½¿ç”¨ Go è¯­è¨€ï¼Œå’Œ Part I ä¿æŒä¸€è‡´ã€‚

### 2026.01.04

#### Week 6 Part-Onchain-data

##### å€ŸåŠ© Telegram Bot å®ç° Live Monitor å®æ—¶é€šçŸ¥

æœ¬å‘¨é“¾ä¸Šæ•°æ®å°ç»„çš„ä»»åŠ¡æ˜¯: ä½¿ç”¨ Week 4 ä¸­å­¦ä¹ çš„ Live Monitoring, ç›‘æ§è‡ªå·±æ„Ÿå…´è¶£çš„é“¾ä¸Šäº‹ä»¶, å€ŸåŠ© Telegram æœºå™¨äººå®ç°å®æ—¶é€šçŸ¥.

å‚è€ƒæ­¥éª¤:

1. é˜…è¯» telegram setup doc é…ç½®æœºå™¨äºº

2. é…ç½®å®Œæ¯•å, è¿è¡Œ [`telegram.go`](./week6/Part-Onchain-data/telegram.go) æ–‡ä»¶å°è¯•å‘é€æ¶ˆæ¯

3. å€ŸåŠ© `telegram.go` ä¸­çš„ä»£ç , å°† Live Monitor ç›‘æµ‹åˆ°çš„é“¾ä¸Šäº‹ä»¶, é€šè¿‡æ¶ˆæ¯å‘é€, æäº¤æ”¶åˆ°æ¶ˆæ¯çš„æˆªå›¾.

   (ä¹Ÿå°±æ˜¯å°†æ¶ˆæ¯é€šçŸ¥çš„ä»£ç é›†æˆåˆ°åŸæœ‰çš„ Live Monitor ä¸­, å®ç°ä¸€æ—¦ä¿¡å·å‡ºç°å°±è‡ªåŠ¨é€šçŸ¥çš„åŠŸèƒ½, è¿™ä¸ªåŠŸèƒ½æ˜¯éå¸¸å®ç”¨çš„)

æ³¨: Telegram æ˜¯ Web3 è¡Œä¸šå¿…å¤‡å·¥å…·

##### å¦‚ä½•ä»é›¶å¼€å§‹åˆ›å»º Telegram æœºå™¨äºº

æœ¬æŒ‡å—å°†å¸¦æ‚¨å®Œæˆä»é›¶å¼€å§‹åˆ›å»º Telegram æœºå™¨äººçš„å®Œæ•´è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æœºå™¨äººåˆ›å»ºã€é…ç½®ä»¥åŠä¸æ‚¨çš„åº”ç”¨ç¨‹åºé›†æˆã€‚

###### æ­¥éª¤ 1ï¼šä¸ BotFather å¼€å§‹èŠå¤©

1. æ‰“å¼€ Telegram å¹¶æœç´¢ `@BotFather`
2. ä¸ BotFather å¼€å§‹èŠå¤©
3. å‘é€ `/start` å¼€å§‹

###### æ­¥éª¤ 2ï¼šåˆ›å»ºæ–°æœºå™¨äºº

1. å‘é€ `/newbot` å‘½ä»¤
2. ä¸ºæ‚¨çš„æœºå™¨äººé€‰æ‹©ä¸€ä¸ªåç§°ï¼ˆæ˜¾ç¤ºåç§°ï¼‰
3. ä¸ºæ‚¨çš„æœºå™¨äººé€‰æ‹©ä¸€ä¸ªç”¨æˆ·åï¼ˆå¿…é¡»ä»¥ 'bot' ç»“å°¾ï¼Œä¾‹å¦‚ `my_trading_bot`ï¼‰
4. BotFather å°†ä¸ºæ‚¨æä¾›ä¸€ä¸ª**æœºå™¨äººä»¤ç‰Œ** - è¯·å®‰å…¨ä¿å­˜ï¼

###### æ­¥éª¤ 3ï¼šè·å–æ‚¨çš„æœºå™¨äººä»¤ç‰Œ

åˆ›å»ºæœºå™¨äººåï¼ŒBotFather å°†æä¾›ä¸€ä¸ªå¦‚ä¸‹æ ¼å¼çš„ä»¤ç‰Œï¼š
```
123456789:ABCdefGHIjklMNOpqrsTUVwxyz
```

**é‡è¦å®‰å…¨æ³¨æ„äº‹é¡¹ï¼š**
- æ°¸è¿œä¸è¦å…¬å¼€åˆ†äº«æ­¤ä»¤ç‰Œ
- å°†å…¶å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
- åœ¨æœ¬åœ°å¼€å‘ä¸­ä½¿ç”¨ `.env` æ–‡ä»¶æˆ– export å‘½ä»¤
- åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å®‰å…¨çš„å¯†é’¥ç®¡ç†

###### æ­¥éª¤ 4ï¼šè·å–æ‚¨çš„å¯¹è¯ ID

ç»™ä½ æ–°åˆ›å»ºçš„æœºå™¨äººåœ¨Telegramä¸Šå‘ä¸€æ¡ä»»æ„ä¿¡æ¯ã€‚

ç„¶åå°†ä»¥ä¸‹ç½‘å€ä¸­çš„{bot_token}ç”¨åˆ›å»ºæœºå™¨äººæ—¶æä¾›çš„ä»¤ç‰Œä»£æ›¿ï¼Œåœ¨ç½‘é¡µä¸­è¾“å…¥ä»¥ä¸‹ç½‘å€ï¼š
https://api.telegram.org/bot{bot_token}/getUpdates

ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ä»¤ç‰Œæ˜¯ `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`,åˆ™å°†ç½‘å€æ”¹ä¸ºï¼š
`https://api.telegram.org/bot123456789:ABCdefGHIjklMNOpqrsTUVwxyz/getUpdates`


æ‰“å¼€ç½‘ä¹‹åï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼äºä»¥ä¸‹çš„ä¿¡æ¯ï¼š
```
{"ok":true,"result":[{"update_id":880712345,
"message":{"message_id":1,"from":{"id":5586512345,"is_bot":false,"first_name":"yourQuantGuy","username":"yourquantguy","language_code":"en","is_premium":true},"chat":{"id":5586512345,"first_name":"yourQuantGuy","username":"yourquantguy","type":"private"},"date":1759103123,"text":"/start","entities":[{"offset":0,"length":6,"type":"bot_command"}]}}]}
```

æ‰¾åˆ° "chat":{"id": ... }ä¸­çš„ idï¼Œå³ç¤ºä¾‹ä¸­çš„ 5586512345ã€‚

æˆ‘çš„ä¿¡æ¯
```html
{"ok":true,"result":[{"update_id":457650939,
"message":{"message_id":4,"from":{"id":5717874069,"is_bot":false,"first_name":"LeBryant","username":"LeBryant357","language_code":"zh-hans"},"chat":{"id":5717874069,"first_name":"LeBryant","username":"LeBryant357","type":"private"},"date":1769542926,"text":"hell0p"}}]}
```

###### æ­¥éª¤ 5ï¼šä½¿ç”¨ token å’Œ chatID
ä¸€èˆ¬æ¥è¯´, æˆ‘ä»¬æŠŠ token å’Œ chatID å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡é‡Œ, è€Œä¸æ˜¯å†™åœ¨ä»£ç ä¸­.

æ‰§è¡Œ

```
export TELEGRAM_TOKEN="your_bot_token"
export TELEGRAM_CHAT_ID="your_chat_id" 
```

ç„¶åè¿è¡Œ [`telegram.go` ](./telegram.go) å³å¯æ”¶åˆ°æ¶ˆæ¯.

![alt text](md_assets/LuBryant/image-4.png)

### 2026.01.05

#### Week 6 Part-DeFi Uniswap V2 æºç ç ”ç©¶

æœ¬å‘¨ DeFi å°ç»„çš„ä»»åŠ¡æ˜¯ï¼šæ·±å…¥ç ”ç©¶ **Uniswap V2** çš„æºä»£ç å’Œæ–‡æ¡£ï¼Œç†è§£å…¶æ ¸å¿ƒæœºåˆ¶ï¼Œä¸ºä¸‹å‘¨çš„å¥—åˆ©ç­–ç•¥æ‰“ä¸‹åŸºç¡€ã€‚

##### ä»»åŠ¡ç›®æ ‡

 **æ ¸å¿ƒç›®æ ‡ï¼š** ç†è§£ Uniswap V2 çš„æ ¸å¿ƒåˆçº¦é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯ï¼š
- `Pair` åˆçº¦çš„ `swap` å‡½æ•°å·¥ä½œåŸç†
- `Router` åˆçº¦ä¸ `Pair` åˆçº¦çš„é…åˆæœºåˆ¶
- æµåŠ¨æ€§æ± çš„å®šä»·å…¬å¼ï¼ˆæ’å®šä¹˜ç§¯å…¬å¼ï¼‰

-  ç†è§£è¿™äº›æœºåˆ¶æ˜¯è¿›è¡Œå¥—åˆ©ã€MEV ç­‰ç­–ç•¥çš„åŸºç¡€ã€‚åªæœ‰æ·±å…¥ç†è§£ DEX çš„å·¥ä½œåŸç†ï¼Œæ‰èƒ½å‘ç°å¥—åˆ©æœºä¼šå¹¶è®¾è®¡æœ‰æ•ˆçš„ç­–ç•¥ã€‚

##### å­¦ä¹ èµ„æº

###### 1. å®˜æ–¹æ–‡æ¡£

- **Uniswap V2 æ–‡æ¡£ï¼š** https://docs.uniswap.org/contracts/v2/overview
- **Uniswap V2 ç™½çš®ä¹¦ï¼š** https://uniswap.org/whitepaper.pdf

###### 2. æºä»£ç 

- **Uniswap V2 Coreï¼ˆæ ¸å¿ƒåˆçº¦ï¼‰ï¼š** https://github.com/Uniswap/v2-core
  - é‡ç‚¹å…³æ³¨ï¼š`UniswapV2Pair.sol`ï¼ˆPair åˆçº¦ï¼‰
- **Uniswap V2 Peripheryï¼ˆå¤–å›´åˆçº¦ï¼‰ï¼š** https://github.com/Uniswap/v2-periphery
  - é‡ç‚¹å…³æ³¨ï¼š`UniswapV2Router02.sol`ï¼ˆRouter åˆçº¦ï¼‰

###### 3. æ¨èé˜…è¯»é¡ºåº

1. å…ˆé˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œäº†è§£æ•´ä½“æ¶æ„
2. é˜…è¯» `UniswapV2Pair.sol`ï¼Œç†è§£æµåŠ¨æ€§æ± çš„æ ¸å¿ƒé€»è¾‘
3. é˜…è¯» `UniswapV2Router02.sol`ï¼Œç†è§£ç”¨æˆ·å¦‚ä½•ä¸ Pair äº¤äº’
4. ç»“åˆä»£ç å’Œæ–‡æ¡£ï¼Œç†è§£å®Œæ•´çš„äº¤æ˜“æµç¨‹

##### æ ¸å¿ƒé—®é¢˜ä¸æ€è€ƒæ–¹å‘

åœ¨é˜…è¯»æºä»£ç æ—¶ï¼Œè¯·æ€è€ƒä»¥ä¸‹é—®é¢˜ï¼š

###### Pair åˆçº¦ç›¸å…³

1. **`swap` å‡½æ•°ï¼š**
   - `swap` å‡½æ•°å¦‚ä½•è®¡ç®—è¾“å‡ºé‡‘é¢ï¼Ÿ
   - ä¸ºä»€ä¹ˆä½¿ç”¨ `x * y = k` çš„æ’å®šä¹˜ç§¯å…¬å¼ï¼Ÿ
   - `swap` å‡½æ•°ä¸­çš„ `_update` å‡½æ•°åšäº†ä»€ä¹ˆï¼Ÿ
   - æ»‘ç‚¹ä¿æŠ¤æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ

2. **æµåŠ¨æ€§ç®¡ç†ï¼š**
   - `mint` å‡½æ•°å¦‚ä½•è®¡ç®— LP Token æ•°é‡ï¼Ÿ
   - `burn` å‡½æ•°å¦‚ä½•è®¡ç®—è¿”è¿˜çš„ä»£å¸æ•°é‡ï¼Ÿ
   - ä¸ºä»€ä¹ˆé¦–æ¬¡æ·»åŠ æµåŠ¨æ€§æ—¶ LP Token æ•°é‡ç­‰äº sqrt(x * y)ï¼Ÿ

3. **ä»·æ ¼é¢„è¨€æœºï¼š**
   - `_update` å‡½æ•°ä¸­çš„ `price0CumulativeLast` å’Œ `price1CumulativeLast` æ˜¯ä»€ä¹ˆï¼Ÿ
   - å¦‚ä½•åˆ©ç”¨è¿™äº›ç´¯ç§¯ä»·æ ¼è®¡ç®— TWAPï¼ˆæ—¶é—´åŠ æƒå¹³å‡ä»·æ ¼ï¼‰ï¼Ÿ

###### Router åˆçº¦ç›¸å…³

1. **äº¤æ˜“æµç¨‹ï¼š**
   - ç”¨æˆ·è°ƒç”¨ `swapExactTokensForTokens` æ—¶ï¼ŒRouter åšäº†ä»€ä¹ˆï¼Ÿ
   - Router å¦‚ä½•ç¡®å®šä½¿ç”¨å“ªä¸ª Pairï¼Ÿ
   - Router å¦‚ä½•ä¿è¯äº¤æ˜“åŸå­æ€§ï¼ˆè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼‰ï¼Ÿ

2. **è·¯å¾„é€‰æ‹©ï¼š**
   - ä»€ä¹ˆæ˜¯"è·¯å¾„"ï¼ˆpathï¼‰ï¼Ÿ
   - ä¸ºä»€ä¹ˆéœ€è¦å¤šè·³äº¤æ˜“ï¼ˆmulti-hopï¼‰ï¼Ÿ
   - Router å¦‚ä½•å¤„ç†ç›´æ¥äº¤æ˜“å¯¹å’Œé—´æ¥äº¤æ˜“å¯¹ï¼Ÿ

3. **æ»‘ç‚¹ä¿æŠ¤ï¼š**
   - `amountOutMin` å‚æ•°çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
   - å¦‚ä½•è®¡ç®—åˆç†çš„æ»‘ç‚¹å®¹å¿åº¦ï¼Ÿ


**æ³¨æ„ï¼š** æœ¬å‘¨ä¸éœ€è¦éƒ¨ç½²æ± å­æˆ–è¿›è¡Œå®é™…äº¤æ˜“ï¼Œé‡ç‚¹æ˜¯ç†è§£æºä»£ç å’Œæœºåˆ¶ã€‚ä¸‹å‘¨æˆ‘ä»¬å°†åŸºäºè¿™äº›ç†è§£è¿›è¡Œå¥—åˆ©å®è·µã€‚

### 2026.01.10

çœ‹è§†é¢‘å­¦ä¹ 
structured intro to how Bitcoin works and how to reason about claims; available via Princetonâ€™s course page and broadly via online versions. [Bitcoin and Cryptocurrency Technologies](https://online.princeton.edu/bitcoin-and-cryptocurrency-technologies?utm_source=chatgpt.com)

<!-- Content_END -->
